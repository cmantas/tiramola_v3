Apr30 16:45:33 [DEBUG]  [cassandra_node_08]: cluster = cassandra
Apr30 16:45:46 [DEBUG]  [cassandra_node_08]: cluster = cassandra
Apr30 16:49:19 [DEBUG]  [cassandra_node_08]: cluster = cassandra
Apr30 16:49:33 [DEBUG]  [cassandra_node_08]: cluster = cassandra
Apr30 16:51:20 [DEBUG]  [cassandra_node_08]: cluster = cassandra
Apr30 16:51:34 [DEBUG]  [cassandra_node_08]: cluster = cassandra
Apr30 16:52:06 [DEBUG]  [cassandra_node_08]: cluster = cassandra
Apr30 16:52:20 [DEBUG]  [cassandra_node_08]: cluster = cassandra
Apr30 16:52:48 [DEBUG]  [cassandra_node_08]: cluster = cassandra
Apr30 16:53:01 [DEBUG]  [cassandra_node_08]: cluster = cassandra
Apr30 16:54:05 [DEBUG]  [cassandra_node_08]: cluster = cassandra
Apr30 16:54:19 [DEBUG]  [cassandra_node_08]: cluster = cassandra
Apr30 16:56:12 [DEBUG]  [cassandra_node_08]: cluster = cassandra
Apr30 16:56:25 [DEBUG]  [cassandra_node_08]: cluster = cassandra
Apr30 17:18:32 [DEBUG]  [cassandra_node_08]: cluster = cassandra
Apr30 17:18:45 [DEBUG]  [cassandra_node_08]: cluster = cassandra
Apr30 17:33:44 [DEBUG]  [cassandra_node_08]: cluster = cassandra
Apr30 17:33:58 [DEBUG]  [cassandra_node_08]: cluster = cassandra
Apr30 17:34:55 [DEBUG]  [cassandra_node_08]: cluster = cassandra
Apr30 17:35:08 [DEBUG]  [cassandra_node_08]: cluster = cassandra
Apr30 17:50:26 [DEBUG]  [cassandra_node_08]: cluster = cassandra
Apr30 17:50:39 [DEBUG]  [cassandra_node_08]: cluster = cassandra
Apr30 17:52:33 [DEBUG]  [cassandra_node_08]: cluster = cassandra
Apr30 17:52:46 [DEBUG]  [cassandra_node_08]: cluster = cassandra
Apr30 18:01:05 [DEBUG]  [cassandra_node_08]: cluster = cassandra
Apr30 18:01:18 [DEBUG]  [cassandra_node_08]: cluster = cassandra
Apr30 18:08:37 [DEBUG]  [cassandra_node_08]: cluster = cassandra
Apr30 18:08:46 [ INFO]  [cassandra_node_08]: running kill script
Apr30 18:08:46 [DEBUG]  [cassandra_node_08]: running SSH command:

     #!/bin/sh
     CAS_PID=$(jps | grep CassandraDaemon | awk  '{print $1}')
     echo "CTOOL: Killing CassandraDaemon ($CAS_PID)"
     kill -9 $CAS_PID &>/dev/null
     ## maybe problematic
     killall java
     
     
     
     ################ debug #################3
     echo "Removing cassandra files and logs" &>>ctool.log
     #cleaning cassandra files
     rm -rf /var/lib/cassandra/* &>>ctool.log
     rm /var/log/cassandra/system.log &>>ctool.log
     #cleaning ctool rrds
     echo "Removing ganglia rrds" &>>ctool.log
     rm -rf /var/lib/ganglia/rrds/* &>>ctool.log
     
     
     
     
     
     echo '
     
     ############  KILLED  ##############' >> ycsb_run.log
     
     #report not alive
     gmetric -n alive -v 0 -t int32 -u nodes -d 10000
     


Apr30 18:08:46 [DEBUG]  [cassandra_node_08]: Connecting to SSH
Apr30 18:08:47 [DEBUG]  [cassandra_node_08]: connected in 0 sec. Running SSH command
Apr30 18:08:47 [DEBUG]  [cassandra_node_08]: SSH command took 0 sec
Apr30 18:08:47 [DEBUG]  [cassandra_node_08]: command returned:

 	$:  CTOOL: Killing CassandraDaemon ()
	$:  java: no process found
	$:  


Apr30 18:09:13 [DEBUG]  [cassandra_node_08]: cluster = cassandra
Apr30 18:09:13 [DEBUG]  [cassandra_node_08]: cluster = cassandra
Apr30 18:16:41 [DEBUG]  [cassandra_node_08]: cluster = cassandra
Apr30 18:16:54 [DEBUG]  [cassandra_node_08]: cluster = cassandra
Apr30 18:53:19 [DEBUG]  [cassandra_node_08]: cluster = cassandra
Apr30 18:53:32 [DEBUG]  [cassandra_node_08]: cluster = cassandra
Apr30 18:59:03 [ INFO]  [cassandra_node_08]: Waiting for SSH daemon (83.212.118.12)
Apr30 18:59:03 [DEBUG]  [cassandra_node_08]: end time:2014-04-30 19:09:03.206954
Apr30 18:59:03 [DEBUG]  [cassandra_node_08]: ssh attempt:1
Apr30 18:59:03 [DEBUG]  [cassandra_node_08]: Connecting to SSH
Apr30 18:59:03 [DEBUG]  [cassandra_node_08]: connected in 0 sec. Running SSH command
Apr30 18:59:03 [DEBUG]  [cassandra_node_08]: SSH command took 0 sec
Apr30 18:59:03 [ INFO]  [cassandra_node_08]: now ready (took 0 sec)
Apr30 18:59:03 [DEBUG]  [cassandra_node_08]: running SSH command:

     sed -i "/.*cassandra.*/g" /etc/hosts; sed -i "/^$/d" /etc/hosts


Apr30 18:59:03 [DEBUG]  [cassandra_node_08]: Connecting to SSH
Apr30 18:59:03 [DEBUG]  [cassandra_node_08]: connected in 0 sec. Running SSH command
Apr30 18:59:03 [DEBUG]  [cassandra_node_08]: SSH command took 0 sec
Apr30 18:59:03 [DEBUG]  [cassandra_node_08]: command returned:

 	$:  


Apr30 18:59:03 [DEBUG]  [cassandra_node_08]: running SSH command:

     echo '
     10.0.0.35 cassandra_seednode
     10.0.0.18 cassandra_node_11
     10.0.0.30 cassandra_node_10
     10.0.0.35 cassandra_seed_0
     10.0.0.17 cassandra_node_09
     10.0.0.13 cassandra_node_08
     10.0.0.31 cassandra_node_01
     10.0.0.11 cassandra_node_03
     10.0.0.38 cassandra_node_02
     10.0.0.16 cassandra_node_05
     10.0.0.45 cassandra_node_04
     10.0.0.37 cassandra_node_07
     10.0.0.44 cassandra_node_06' >> /etc/hosts; echo cassandra_node_08 >/etc/hostname


Apr30 18:59:03 [DEBUG]  [cassandra_node_08]: Connecting to SSH
Apr30 18:59:03 [DEBUG]  [cassandra_node_08]: connected in 0 sec. Running SSH command
Apr30 18:59:03 [DEBUG]  [cassandra_node_08]: SSH command took 0 sec
Apr30 18:59:03 [DEBUG]  [cassandra_node_08]: command returned:

 	$:  


Apr30 18:59:03 [ INFO]  [cassandra_node_08]: running bootstrap script
Apr30 18:59:03 [DEBUG]  [cassandra_node_08]: running SSH command:

     #!/bin/bash
     
     MAX_WAIT=300  #5 min
     
     echo "started bootstrap" > bootsrap.log
     
     # check the seednode
     if ! ping -q -c 1 cassandra_seednode &>/dev/null   ;
     then
     echo CTOOL: ERROR - cassandra_seednode not pingable, exiting
     exit -1
     fi
     
     # kill the cassandra process
     CAS_PID=$(jps | grep CassandraDaemon | awk  '{print $1}')
     echo "CTOOL: Killing CassandraDaemon ($CAS_PID)"
     kill -9 $CAS_PID
     
     # clean previous files and logs
     echo "Removing cassandra files and logs"
     #cleaning cassandra files
     rm -rf /var/lib/cassandra/*
     rm /var/log/cassandra/system.log
     #cleaning ctool rrds
     echo "Removing ganglia rrds"
     rm -rf /var/lib/ganglia/rrds/*
     rm /var/log/cassandra/system.log
     
     # find my IP
     my_priv_addr=""
     #look for an IPv4 interface in range 10.0 and use that for the cassandra communication
     let if_count=($(ifconfig | grep eth | wc -l ))-1
     for i in $(seq 0 $if_count)
     do	#look for IPv4 address
     line=$(ifconfig eth$i | grep "inet addr:")
     line=$(echo $line | awk '{print $2}')
     address=$(echo $line | sed 's/addr://g')
     if [[ "$address" == 10.0.* ]] ;
     then
     my_priv_addr=$address
     break
     fi
     done
     
     # configure cassandra
     echo "configuring cassandra.yaml for my address:$my_priv_addr" >> ctool.log
     #change the listen address of this node
     sed "s/listen_address: .*/listen_address: $my_priv_addr/g"  /etc/cassandra/cassandra.yaml> tmp && mv tmp /etc/cassandra/cassandra.yaml
     #change the rpc_address of this node to 0.0.0.0
     sed "s/rpc_address: .*/rpc_address: 0.0.0.0/g"  /etc/cassandra/cassandra.yaml> tmp && mv tmp /etc/cassandra/cassandra.yaml
     #change the seeds to "cassandra_seednode"
     sed "s/seeds: .*/seeds: \"cassandra_seednode\"/g"  /etc/cassandra/cassandra.yaml> tmp && mv tmp /etc/cassandra/cassandra.yaml
     #add the jmx server whatever to cassandra-env.sh
     sed -i.bak "s/.*-Djava.rmi.server.hostname=.*/JVM_OPTS=\"\$JVM_OPTS -Djava.rmi.server.hostname=$my_priv_addr\"/g"  /etc/cassandra/cassandra-env.sh
     sed -i.bak "s/*JVM_OPTS=\"\$JVM_OPTS -Djava.rmi.server.hostname=*\"/JVM_OPTS=\"\$JVM_OPTS -Djava.rmi.server.hostname=$my_priv_addr\"/g"  /etc/cassandra/cassandra-env.sh
     #make sure no requests are dropped by using a big timeout
     sed -i.bak "s/read_request_timeout_in_ms:.*/read_request_timeout_in_ms: 50000/g" /etc/cassandra/cassandra.yaml
     sed -i.bak "s/write_request_timeout_in_ms:.*/write_request_timeout_in_ms: 50000/g" /etc/cassandra/cassandra.yaml
     echo "CTOOL: Done configuring"
     
     
     # start cassandra
     chmod -R o+rw /var/lib/cassandra
     echo Starting casandra service, ganglia-monitor
     service cassandra start
     service ganglia-monitor restart
     
     #wait until ready and try to create keyspace
     echo "Attempting to create ycsb keyspace"
     echo "create keyspace ycsb  WITH REPLICATION = {'class' : 'SimpleStrategy', 'replication_factor': 1 }; use ycsb;  create table usertable (y_id varchar primary key, field0 varchar, field1 varchar, field2 varchar, field3 varchar, field4 varchar, field5 varchar, field6 varchar, field7 varchar, field8 varchar, field9 varchar);" > ycsb_cql.temp
     while ! cqlsh < ycsb_cql.temp 2>/dev/null;do sleep 2; done
     rm ycsb_cql.temp
     
     echo "ended bootstrap" >> bootsrap.log
     
     #report alive in gmetric
     gmetric -n alive -v 1 -t int32 -u nodes -d 10000
     
     
     


Apr30 18:59:03 [DEBUG]  [cassandra_node_08]: Connecting to SSH
Apr30 18:59:04 [DEBUG]  [cassandra_node_08]: connected in 0 sec. Running SSH command
May01 15:33:24 [DEBUG]  [cassandra_node_08]: cluster = cassandra
May01 15:36:18 [DEBUG]  [cassandra_node_08]: cluster = cassandra
May01 15:37:01 [DEBUG]  [cassandra_node_08]: cluster = cassandra
May01 15:37:16 [ INFO]  [cassandra_node_08]: running kill script
May01 15:37:16 [DEBUG]  [cassandra_node_08]: running SSH command:

     #!/bin/sh
     CAS_PID=$(jps | grep CassandraDaemon | awk  '{print $1}')
     echo "CTOOL: Killing CassandraDaemon ($CAS_PID)"
     kill -9 $CAS_PID &>/dev/null
     ## maybe problematic
     killall java
     
     
     
     ################ debug #################3
     echo "Removing cassandra files and logs" &>>ctool.log
     #cleaning cassandra files
     rm -rf /var/lib/cassandra/* &>>ctool.log
     rm /var/log/cassandra/system.log &>>ctool.log
     #cleaning ctool rrds
     echo "Removing ganglia rrds" &>>ctool.log
     rm -rf /var/lib/ganglia/rrds/* &>>ctool.log
     
     
     
     
     
     echo '
     
     ############  KILLED  ##############' >> ycsb_run.log
     
     #report not alive
     gmetric -n alive -v 0 -t int32 -u nodes -d 10000
     


May01 15:37:16 [DEBUG]  [cassandra_node_08]: Connecting to SSH
May01 15:37:16 [DEBUG]  [cassandra_node_08]: connected in 0 sec. Running SSH command
May01 15:37:17 [DEBUG]  [cassandra_node_08]: SSH command took 0 sec
May01 15:37:17 [DEBUG]  [cassandra_node_08]: command returned:

 	$:  CTOOL: Killing CassandraDaemon (3306)
	$:  


May01 15:37:40 [DEBUG]  [cassandra_node_08]: cluster = cassandra
May01 15:37:40 [DEBUG]  [cassandra_node_08]: cluster = cassandra
May01 15:45:28 [DEBUG]  [cassandra_node_08]: cluster = cassandra
May01 15:45:41 [DEBUG]  [cassandra_node_08]: cluster = cassandra
May01 16:57:56 [DEBUG]  [cassandra_node_08]: cluster = cassandra
May01 16:58:10 [DEBUG]  [cassandra_node_08]: cluster = cassandra
May01 17:03:41 [ INFO]  [cassandra_node_08]: Waiting for SSH daemon (83.212.118.12)
May01 17:03:41 [DEBUG]  [cassandra_node_08]: end time:2014-05-01 17:13:41.694819
May01 17:03:41 [DEBUG]  [cassandra_node_08]: ssh attempt:1
May01 17:03:41 [DEBUG]  [cassandra_node_08]: Connecting to SSH
May01 17:03:41 [DEBUG]  [cassandra_node_08]: connected in 0 sec. Running SSH command
May01 17:03:41 [DEBUG]  [cassandra_node_08]: SSH command took 0 sec
May01 17:03:41 [ INFO]  [cassandra_node_08]: now ready (took 0 sec)
May01 17:03:41 [DEBUG]  [cassandra_node_08]: running SSH command:

     sed -i "/.*cassandra.*/g" /etc/hosts; sed -i "/^$/d" /etc/hosts


May01 17:03:41 [DEBUG]  [cassandra_node_08]: Connecting to SSH
May01 17:03:42 [DEBUG]  [cassandra_node_08]: connected in 0 sec. Running SSH command
May01 17:03:42 [DEBUG]  [cassandra_node_08]: SSH command took 0 sec
May01 17:03:42 [DEBUG]  [cassandra_node_08]: command returned:

 	$:  


May01 17:03:42 [DEBUG]  [cassandra_node_08]: running SSH command:

     echo '
     10.0.0.35 cassandra_seednode
     10.0.0.18 cassandra_node_11
     10.0.0.30 cassandra_node_10
     10.0.0.35 cassandra_seed_0
     10.0.0.17 cassandra_node_09
     10.0.0.13 cassandra_node_08
     10.0.0.31 cassandra_node_01
     10.0.0.11 cassandra_node_03
     10.0.0.38 cassandra_node_02
     10.0.0.16 cassandra_node_05
     10.0.0.45 cassandra_node_04
     10.0.0.37 cassandra_node_07
     10.0.0.44 cassandra_node_06' >> /etc/hosts; echo cassandra_node_08 >/etc/hostname


May01 17:03:42 [DEBUG]  [cassandra_node_08]: Connecting to SSH
May01 17:03:42 [DEBUG]  [cassandra_node_08]: connected in 0 sec. Running SSH command
May01 17:03:42 [DEBUG]  [cassandra_node_08]: SSH command took 0 sec
May01 17:03:42 [DEBUG]  [cassandra_node_08]: command returned:

 	$:  


May01 17:03:42 [ INFO]  [cassandra_node_08]: running bootstrap script
May01 17:03:42 [DEBUG]  [cassandra_node_08]: running SSH command:

     #!/bin/bash
     
     MAX_WAIT=300  #5 min
     
     echo "started bootstrap" > bootsrap.log
     
     # check the seednode
     if ! ping -q -c 1 cassandra_seednode &>/dev/null   ;
     then
     echo CTOOL: ERROR - cassandra_seednode not pingable, exiting
     exit -1
     fi
     
     # kill the cassandra process
     CAS_PID=$(jps | grep CassandraDaemon | awk  '{print $1}')
     echo "CTOOL: Killing CassandraDaemon ($CAS_PID)"
     kill -9 $CAS_PID
     
     # clean previous files and logs
     echo "Removing cassandra files and logs"
     #cleaning cassandra files
     rm -rf /var/lib/cassandra/*
     rm /var/log/cassandra/system.log
     #cleaning ctool rrds
     echo "Removing ganglia rrds"
     rm -rf /var/lib/ganglia/rrds/*
     rm /var/log/cassandra/system.log
     
     # find my IP
     my_priv_addr=""
     #look for an IPv4 interface in range 10.0 and use that for the cassandra communication
     let if_count=($(ifconfig | grep eth | wc -l ))-1
     for i in $(seq 0 $if_count)
     do	#look for IPv4 address
     line=$(ifconfig eth$i | grep "inet addr:")
     line=$(echo $line | awk '{print $2}')
     address=$(echo $line | sed 's/addr://g')
     if [[ "$address" == 10.0.* ]] ;
     then
     my_priv_addr=$address
     break
     fi
     done
     
     # configure cassandra
     echo "configuring cassandra.yaml for my address:$my_priv_addr" >> ctool.log
     #change the listen address of this node
     sed "s/listen_address: .*/listen_address: $my_priv_addr/g"  /etc/cassandra/cassandra.yaml> tmp && mv tmp /etc/cassandra/cassandra.yaml
     #change the rpc_address of this node to 0.0.0.0
     sed "s/rpc_address: .*/rpc_address: 0.0.0.0/g"  /etc/cassandra/cassandra.yaml> tmp && mv tmp /etc/cassandra/cassandra.yaml
     #change the seeds to "cassandra_seednode"
     sed "s/seeds: .*/seeds: \"cassandra_seednode\"/g"  /etc/cassandra/cassandra.yaml> tmp && mv tmp /etc/cassandra/cassandra.yaml
     #add the jmx server whatever to cassandra-env.sh
     sed -i.bak "s/.*-Djava.rmi.server.hostname=.*/JVM_OPTS=\"\$JVM_OPTS -Djava.rmi.server.hostname=$my_priv_addr\"/g"  /etc/cassandra/cassandra-env.sh
     sed -i.bak "s/*JVM_OPTS=\"\$JVM_OPTS -Djava.rmi.server.hostname=*\"/JVM_OPTS=\"\$JVM_OPTS -Djava.rmi.server.hostname=$my_priv_addr\"/g"  /etc/cassandra/cassandra-env.sh
     #make sure no requests are dropped by using a big timeout
     sed -i.bak "s/read_request_timeout_in_ms:.*/read_request_timeout_in_ms: 50000/g" /etc/cassandra/cassandra.yaml
     sed -i.bak "s/write_request_timeout_in_ms:.*/write_request_timeout_in_ms: 50000/g" /etc/cassandra/cassandra.yaml
     echo "CTOOL: Done configuring"
     
     
     # start cassandra
     chmod -R o+rw /var/lib/cassandra
     echo Starting casandra service, ganglia-monitor
     service cassandra start
     service ganglia-monitor restart
     
     #wait until ready and try to create keyspace
     echo "Attempting to create ycsb keyspace"
     echo "create keyspace ycsb  WITH REPLICATION = {'class' : 'SimpleStrategy', 'replication_factor': 1 }; use ycsb;  create table usertable (y_id varchar primary key, field0 varchar, field1 varchar, field2 varchar, field3 varchar, field4 varchar, field5 varchar, field6 varchar, field7 varchar, field8 varchar, field9 varchar);" > ycsb_cql.temp
     while ! cqlsh < ycsb_cql.temp 2>/dev/null;do sleep 2; done
     rm ycsb_cql.temp
     
     echo "ended bootstrap" >> bootsrap.log
     
     #report alive in gmetric
     gmetric -n alive -v 1 -t int32 -u nodes -d 10000
     
     
     


May01 17:03:42 [DEBUG]  [cassandra_node_08]: Connecting to SSH
May01 17:03:42 [DEBUG]  [cassandra_node_08]: connected in 0 sec. Running SSH command
May01 17:05:59 [DEBUG]  [cassandra_node_08]: cluster = cassandra
May01 17:06:13 [DEBUG]  [cassandra_node_08]: cluster = cassandra
May01 17:11:45 [ INFO]  [cassandra_node_08]: Waiting for SSH daemon (83.212.118.12)
May01 17:11:45 [DEBUG]  [cassandra_node_08]: end time:2014-05-01 17:21:45.223637
May01 17:11:45 [DEBUG]  [cassandra_node_08]: ssh attempt:1
May01 17:11:45 [DEBUG]  [cassandra_node_08]: Connecting to SSH
May01 17:11:45 [DEBUG]  [cassandra_node_08]: connected in 0 sec. Running SSH command
May01 17:11:46 [DEBUG]  [cassandra_node_08]: SSH command took 0 sec
May01 17:11:46 [ INFO]  [cassandra_node_08]: now ready (took 1 sec)
May01 17:11:46 [DEBUG]  [cassandra_node_08]: running SSH command:

     sed -i "/.*cassandra.*/g" /etc/hosts; sed -i "/^$/d" /etc/hosts


May01 17:11:46 [DEBUG]  [cassandra_node_08]: Connecting to SSH
May01 17:11:46 [DEBUG]  [cassandra_node_08]: connected in 0 sec. Running SSH command
May01 17:11:46 [DEBUG]  [cassandra_node_08]: SSH command took 0 sec
May01 17:11:46 [DEBUG]  [cassandra_node_08]: command returned:

 	$:  


May01 17:11:46 [DEBUG]  [cassandra_node_08]: running SSH command:

     echo '
     10.0.0.35 cassandra_seednode
     10.0.0.18 cassandra_node_11
     10.0.0.30 cassandra_node_10
     10.0.0.35 cassandra_seed_0
     10.0.0.17 cassandra_node_09
     10.0.0.13 cassandra_node_08
     10.0.0.31 cassandra_node_01
     10.0.0.11 cassandra_node_03
     10.0.0.38 cassandra_node_02
     10.0.0.16 cassandra_node_05
     10.0.0.45 cassandra_node_04
     10.0.0.37 cassandra_node_07
     10.0.0.44 cassandra_node_06' >> /etc/hosts; echo cassandra_node_08 >/etc/hostname


May01 17:11:46 [DEBUG]  [cassandra_node_08]: Connecting to SSH
May01 17:11:47 [DEBUG]  [cassandra_node_08]: connected in 0 sec. Running SSH command
May01 17:11:47 [DEBUG]  [cassandra_node_08]: SSH command took 0 sec
May01 17:11:47 [DEBUG]  [cassandra_node_08]: command returned:

 	$:  


May01 17:11:47 [ INFO]  [cassandra_node_08]: running bootstrap script
May01 17:11:47 [DEBUG]  [cassandra_node_08]: running SSH command:

     #!/bin/bash
     
     MAX_WAIT=300  #5 min
     
     echo "started bootstrap" > bootsrap.log
     
     # check the seednode
     if ! ping -q -c 1 cassandra_seednode &>/dev/null   ;
     then
     echo CTOOL: ERROR - cassandra_seednode not pingable, exiting
     exit -1
     fi
     
     # kill the cassandra process
     CAS_PID=$(jps | grep CassandraDaemon | awk  '{print $1}')
     echo "CTOOL: Killing CassandraDaemon ($CAS_PID)"
     kill -9 $CAS_PID
     
     # clean previous files and logs
     echo "Removing cassandra files and logs"
     #cleaning cassandra files
     rm -rf /var/lib/cassandra/*
     rm /var/log/cassandra/system.log
     #cleaning ctool rrds
     echo "Removing ganglia rrds"
     rm -rf /var/lib/ganglia/rrds/*
     rm /var/log/cassandra/system.log
     
     # find my IP
     my_priv_addr=""
     #look for an IPv4 interface in range 10.0 and use that for the cassandra communication
     let if_count=($(ifconfig | grep eth | wc -l ))-1
     for i in $(seq 0 $if_count)
     do	#look for IPv4 address
     line=$(ifconfig eth$i | grep "inet addr:")
     line=$(echo $line | awk '{print $2}')
     address=$(echo $line | sed 's/addr://g')
     if [[ "$address" == 10.0.* ]] ;
     then
     my_priv_addr=$address
     break
     fi
     done
     
     # configure cassandra
     echo "configuring cassandra.yaml for my address:$my_priv_addr" >> ctool.log
     #change the listen address of this node
     sed "s/listen_address: .*/listen_address: $my_priv_addr/g"  /etc/cassandra/cassandra.yaml> tmp && mv tmp /etc/cassandra/cassandra.yaml
     #change the rpc_address of this node to 0.0.0.0
     sed "s/rpc_address: .*/rpc_address: 0.0.0.0/g"  /etc/cassandra/cassandra.yaml> tmp && mv tmp /etc/cassandra/cassandra.yaml
     #change the seeds to "cassandra_seednode"
     sed "s/seeds: .*/seeds: \"cassandra_seednode\"/g"  /etc/cassandra/cassandra.yaml> tmp && mv tmp /etc/cassandra/cassandra.yaml
     #add the jmx server whatever to cassandra-env.sh
     sed -i.bak "s/.*-Djava.rmi.server.hostname=.*/JVM_OPTS=\"\$JVM_OPTS -Djava.rmi.server.hostname=$my_priv_addr\"/g"  /etc/cassandra/cassandra-env.sh
     sed -i.bak "s/*JVM_OPTS=\"\$JVM_OPTS -Djava.rmi.server.hostname=*\"/JVM_OPTS=\"\$JVM_OPTS -Djava.rmi.server.hostname=$my_priv_addr\"/g"  /etc/cassandra/cassandra-env.sh
     #make sure no requests are dropped by using a big timeout
     sed -i.bak "s/read_request_timeout_in_ms:.*/read_request_timeout_in_ms: 50000/g" /etc/cassandra/cassandra.yaml
     sed -i.bak "s/write_request_timeout_in_ms:.*/write_request_timeout_in_ms: 50000/g" /etc/cassandra/cassandra.yaml
     echo "CTOOL: Done configuring"
     
     
     # start cassandra
     chmod -R o+rw /var/lib/cassandra
     echo Starting casandra service, ganglia-monitor
     service cassandra start
     service ganglia-monitor restart
     
     #wait until ready and try to create keyspace
     echo "Attempting to create ycsb keyspace"
     echo "create keyspace ycsb  WITH REPLICATION = {'class' : 'SimpleStrategy', 'replication_factor': 1 }; use ycsb;  create table usertable (y_id varchar primary key, field0 varchar, field1 varchar, field2 varchar, field3 varchar, field4 varchar, field5 varchar, field6 varchar, field7 varchar, field8 varchar, field9 varchar);" > ycsb_cql.temp
     while ! cqlsh < ycsb_cql.temp 2>/dev/null;do sleep 2; done
     rm ycsb_cql.temp
     
     echo "ended bootstrap" >> bootsrap.log
     
     #report alive in gmetric
     gmetric -n alive -v 1 -t int32 -u nodes -d 10000
     
     
     


May01 17:11:47 [DEBUG]  [cassandra_node_08]: Connecting to SSH
May01 17:11:47 [DEBUG]  [cassandra_node_08]: connected in 0 sec. Running SSH command
May01 17:17:09 [DEBUG]  [cassandra_node_08]: cluster = cassandra
May01 17:18:07 [DEBUG]  [cassandra_node_08]: cluster = cassandra
May01 17:18:21 [DEBUG]  [cassandra_node_08]: cluster = cassandra
May01 17:20:17 [DEBUG]  [cassandra_node_08]: cluster = cassandra
May01 17:20:31 [DEBUG]  [cassandra_node_08]: cluster = cassandra
May01 17:21:06 [DEBUG]  [cassandra_node_08]: cluster = cassandra
May01 17:21:20 [DEBUG]  [cassandra_node_08]: cluster = cassandra
May01 17:43:22 [ INFO]  [cassandra_node_08]: Waiting for SSH daemon (83.212.118.12)
May01 17:43:22 [DEBUG]  [cassandra_node_08]: end time:2014-05-01 17:53:22.462703
May01 17:43:22 [DEBUG]  [cassandra_node_08]: ssh attempt:1
May01 17:43:22 [DEBUG]  [cassandra_node_08]: Connecting to SSH
May01 17:43:22 [DEBUG]  [cassandra_node_08]: connected in 0 sec. Running SSH command
May01 17:43:22 [DEBUG]  [cassandra_node_08]: SSH command took 0 sec
May01 17:43:22 [ INFO]  [cassandra_node_08]: now ready (took 0 sec)
May01 17:43:22 [DEBUG]  [cassandra_node_08]: running SSH command:

     sed -i "/.*cassandra.*/g" /etc/hosts; sed -i "/^$/d" /etc/hosts


May01 17:43:22 [DEBUG]  [cassandra_node_08]: Connecting to SSH
May01 17:43:22 [DEBUG]  [cassandra_node_08]: connected in 0 sec. Running SSH command
May01 17:43:22 [DEBUG]  [cassandra_node_08]: SSH command took 0 sec
May01 17:43:22 [DEBUG]  [cassandra_node_08]: command returned:

 	$:  


May01 17:43:22 [DEBUG]  [cassandra_node_08]: running SSH command:

     echo '
     10.0.0.35 cassandra_seednode
     10.0.0.30 cassandra_node_10
     10.0.0.35 cassandra_seed_0
     10.0.0.17 cassandra_node_09
     10.0.0.13 cassandra_node_08
     10.0.0.31 cassandra_node_01
     10.0.0.11 cassandra_node_03
     10.0.0.38 cassandra_node_02
     10.0.0.16 cassandra_node_05
     10.0.0.45 cassandra_node_04
     10.0.0.37 cassandra_node_07
     10.0.0.44 cassandra_node_06' >> /etc/hosts; echo cassandra_node_08 >/etc/hostname


May01 17:43:22 [DEBUG]  [cassandra_node_08]: Connecting to SSH
May01 17:43:22 [DEBUG]  [cassandra_node_08]: connected in 0 sec. Running SSH command
May01 17:43:23 [DEBUG]  [cassandra_node_08]: SSH command took 0 sec
May01 17:43:23 [DEBUG]  [cassandra_node_08]: command returned:

 	$:  


May01 17:43:23 [ INFO]  [cassandra_node_08]: running bootstrap script
May01 17:43:23 [DEBUG]  [cassandra_node_08]: running SSH command:

     #!/bin/bash
     
     MAX_WAIT=300  #5 min
     
     echo "started bootstrap" > bootsrap.log
     
     # check the seednode
     if ! ping -q -c 1 cassandra_seednode &>/dev/null   ;
     then
     echo CTOOL: ERROR - cassandra_seednode not pingable, exiting
     exit -1
     fi
     
     # kill the cassandra process
     CAS_PID=$(jps | grep CassandraDaemon | awk  '{print $1}')
     echo "CTOOL: Killing CassandraDaemon ($CAS_PID)"
     kill -9 $CAS_PID
     
     # clean previous files and logs
     echo "Removing cassandra files and logs"
     #cleaning cassandra files
     rm -rf /var/lib/cassandra/*
     rm /var/log/cassandra/system.log
     #cleaning ctool rrds
     echo "Removing ganglia rrds"
     rm -rf /var/lib/ganglia/rrds/*
     rm /var/log/cassandra/system.log
     
     # find my IP
     my_priv_addr=""
     #look for an IPv4 interface in range 10.0 and use that for the cassandra communication
     let if_count=($(ifconfig | grep eth | wc -l ))-1
     for i in $(seq 0 $if_count)
     do	#look for IPv4 address
     line=$(ifconfig eth$i | grep "inet addr:")
     line=$(echo $line | awk '{print $2}')
     address=$(echo $line | sed 's/addr://g')
     if [[ "$address" == 10.0.* ]] ;
     then
     my_priv_addr=$address
     break
     fi
     done
     
     # configure cassandra
     echo "configuring cassandra.yaml for my address:$my_priv_addr" >> ctool.log
     #change the listen address of this node
     sed "s/listen_address: .*/listen_address: $my_priv_addr/g"  /etc/cassandra/cassandra.yaml> tmp && mv tmp /etc/cassandra/cassandra.yaml
     #change the rpc_address of this node to 0.0.0.0
     sed "s/rpc_address: .*/rpc_address: 0.0.0.0/g"  /etc/cassandra/cassandra.yaml> tmp && mv tmp /etc/cassandra/cassandra.yaml
     #change the seeds to "cassandra_seednode"
     sed "s/seeds: .*/seeds: \"cassandra_seednode\"/g"  /etc/cassandra/cassandra.yaml> tmp && mv tmp /etc/cassandra/cassandra.yaml
     #add the jmx server whatever to cassandra-env.sh
     sed -i.bak "s/.*-Djava.rmi.server.hostname=.*/JVM_OPTS=\"\$JVM_OPTS -Djava.rmi.server.hostname=$my_priv_addr\"/g"  /etc/cassandra/cassandra-env.sh
     sed -i.bak "s/*JVM_OPTS=\"\$JVM_OPTS -Djava.rmi.server.hostname=*\"/JVM_OPTS=\"\$JVM_OPTS -Djava.rmi.server.hostname=$my_priv_addr\"/g"  /etc/cassandra/cassandra-env.sh
     #make sure no requests are dropped by using a big timeout
     sed -i.bak "s/read_request_timeout_in_ms:.*/read_request_timeout_in_ms: 50000/g" /etc/cassandra/cassandra.yaml
     sed -i.bak "s/write_request_timeout_in_ms:.*/write_request_timeout_in_ms: 50000/g" /etc/cassandra/cassandra.yaml
     echo "CTOOL: Done configuring"
     
     
     # start cassandra
     chmod -R o+rw /var/lib/cassandra
     echo Starting casandra service, ganglia-monitor
     service cassandra start
     service ganglia-monitor restart
     
     #wait until ready and try to create keyspace
     echo "Attempting to create ycsb keyspace"
     echo "create keyspace ycsb  WITH REPLICATION = {'class' : 'SimpleStrategy', 'replication_factor': 1 }; use ycsb;  create table usertable (y_id varchar primary key, field0 varchar, field1 varchar, field2 varchar, field3 varchar, field4 varchar, field5 varchar, field6 varchar, field7 varchar, field8 varchar, field9 varchar);" > ycsb_cql.temp
     while ! cqlsh < ycsb_cql.temp 2>/dev/null;do sleep 2; done
     rm ycsb_cql.temp
     
     echo "ended bootstrap" >> bootsrap.log
     
     #report alive in gmetric
     gmetric -n alive -v 1 -t int32 -u nodes -d 10000
     
     
     


May01 17:43:23 [DEBUG]  [cassandra_node_08]: Connecting to SSH
May01 17:43:23 [DEBUG]  [cassandra_node_08]: connected in 0 sec. Running SSH command
May01 21:01:44 [DEBUG]  [cassandra_node_08]: cluster = cassandra
May01 21:02:24 [DEBUG]  [cassandra_node_08]: cluster = cassandra
May01 21:02:37 [DEBUG]  [cassandra_node_08]: cluster = cassandra
May01 21:24:41 [ INFO]  [cassandra_node_08]: Waiting for SSH daemon (83.212.118.12)
May01 21:24:41 [DEBUG]  [cassandra_node_08]: end time:2014-05-01 21:34:41.395649
May01 21:24:41 [DEBUG]  [cassandra_node_08]: ssh attempt:1
May01 21:24:41 [DEBUG]  [cassandra_node_08]: Connecting to SSH
May01 21:24:41 [DEBUG]  [cassandra_node_08]: connected in 0 sec. Running SSH command
May01 21:24:41 [DEBUG]  [cassandra_node_08]: SSH command took 0 sec
May01 21:24:41 [ INFO]  [cassandra_node_08]: now ready (took 0 sec)
May01 21:24:41 [DEBUG]  [cassandra_node_08]: running SSH command:

     sed -i "/.*cassandra.*/g" /etc/hosts; sed -i "/^$/d" /etc/hosts


May01 21:24:41 [DEBUG]  [cassandra_node_08]: Connecting to SSH
May01 21:24:41 [DEBUG]  [cassandra_node_08]: connected in 0 sec. Running SSH command
May01 21:24:41 [DEBUG]  [cassandra_node_08]: SSH command took 0 sec
May01 21:24:41 [DEBUG]  [cassandra_node_08]: command returned:

 	$:  


May01 21:24:41 [DEBUG]  [cassandra_node_08]: running SSH command:

     echo '
     10.0.0.35 cassandra_seednode
     10.0.0.35 cassandra_seed_0
     10.0.0.17 cassandra_node_09
     10.0.0.13 cassandra_node_08
     10.0.0.31 cassandra_node_01
     10.0.0.11 cassandra_node_03
     10.0.0.38 cassandra_node_02
     10.0.0.16 cassandra_node_05
     10.0.0.45 cassandra_node_04
     10.0.0.37 cassandra_node_07
     10.0.0.44 cassandra_node_06' >> /etc/hosts; echo cassandra_node_08 >/etc/hostname


May01 21:24:41 [DEBUG]  [cassandra_node_08]: Connecting to SSH
May01 21:24:41 [DEBUG]  [cassandra_node_08]: connected in 0 sec. Running SSH command
May01 21:24:41 [DEBUG]  [cassandra_node_08]: SSH command took 0 sec
May01 21:24:41 [DEBUG]  [cassandra_node_08]: command returned:

 	$:  


May01 21:24:41 [ INFO]  [cassandra_node_08]: running bootstrap script
May01 21:24:41 [DEBUG]  [cassandra_node_08]: running SSH command:

     #!/bin/bash
     
     MAX_WAIT=300  #5 min
     
     echo "started bootstrap" > bootsrap.log
     
     # check the seednode
     if ! ping -q -c 1 cassandra_seednode &>/dev/null   ;
     then
     echo CTOOL: ERROR - cassandra_seednode not pingable, exiting
     exit -1
     fi
     
     # kill the cassandra process
     CAS_PID=$(jps | grep CassandraDaemon | awk  '{print $1}')
     echo "CTOOL: Killing CassandraDaemon ($CAS_PID)"
     kill -9 $CAS_PID
     
     # clean previous files and logs
     echo "Removing cassandra files and logs"
     #cleaning cassandra files
     rm -rf /var/lib/cassandra/*
     rm /var/log/cassandra/system.log
     #cleaning ctool rrds
     echo "Removing ganglia rrds"
     rm -rf /var/lib/ganglia/rrds/*
     rm /var/log/cassandra/system.log
     
     # find my IP
     my_priv_addr=""
     #look for an IPv4 interface in range 10.0 and use that for the cassandra communication
     let if_count=($(ifconfig | grep eth | wc -l ))-1
     for i in $(seq 0 $if_count)
     do	#look for IPv4 address
     line=$(ifconfig eth$i | grep "inet addr:")
     line=$(echo $line | awk '{print $2}')
     address=$(echo $line | sed 's/addr://g')
     if [[ "$address" == 10.0.* ]] ;
     then
     my_priv_addr=$address
     break
     fi
     done
     
     # configure cassandra
     echo "configuring cassandra.yaml for my address:$my_priv_addr" >> ctool.log
     #change the listen address of this node
     sed "s/listen_address: .*/listen_address: $my_priv_addr/g"  /etc/cassandra/cassandra.yaml> tmp && mv tmp /etc/cassandra/cassandra.yaml
     #change the rpc_address of this node to 0.0.0.0
     sed "s/rpc_address: .*/rpc_address: 0.0.0.0/g"  /etc/cassandra/cassandra.yaml> tmp && mv tmp /etc/cassandra/cassandra.yaml
     #change the seeds to "cassandra_seednode"
     sed "s/seeds: .*/seeds: \"cassandra_seednode\"/g"  /etc/cassandra/cassandra.yaml> tmp && mv tmp /etc/cassandra/cassandra.yaml
     #add the jmx server whatever to cassandra-env.sh
     sed -i.bak "s/.*-Djava.rmi.server.hostname=.*/JVM_OPTS=\"\$JVM_OPTS -Djava.rmi.server.hostname=$my_priv_addr\"/g"  /etc/cassandra/cassandra-env.sh
     sed -i.bak "s/*JVM_OPTS=\"\$JVM_OPTS -Djava.rmi.server.hostname=*\"/JVM_OPTS=\"\$JVM_OPTS -Djava.rmi.server.hostname=$my_priv_addr\"/g"  /etc/cassandra/cassandra-env.sh
     #make sure no requests are dropped by using a big timeout
     sed -i.bak "s/read_request_timeout_in_ms:.*/read_request_timeout_in_ms: 50000/g" /etc/cassandra/cassandra.yaml
     sed -i.bak "s/write_request_timeout_in_ms:.*/write_request_timeout_in_ms: 50000/g" /etc/cassandra/cassandra.yaml
     echo "CTOOL: Done configuring"
     
     
     # start cassandra
     chmod -R o+rw /var/lib/cassandra
     echo Starting casandra service, ganglia-monitor
     service cassandra start
     service ganglia-monitor restart
     
     #wait until ready and try to create keyspace
     echo "Attempting to create ycsb keyspace"
     echo "create keyspace ycsb  WITH REPLICATION = {'class' : 'SimpleStrategy', 'replication_factor': 1 }; use ycsb;  create table usertable (y_id varchar primary key, field0 varchar, field1 varchar, field2 varchar, field3 varchar, field4 varchar, field5 varchar, field6 varchar, field7 varchar, field8 varchar, field9 varchar);" > ycsb_cql.temp
     while ! cqlsh < ycsb_cql.temp 2>/dev/null;do sleep 2; done
     rm ycsb_cql.temp
     
     echo "ended bootstrap" >> bootsrap.log
     
     #report alive in gmetric
     gmetric -n alive -v 1 -t int32 -u nodes -d 10000
     
     
     


May01 21:24:41 [DEBUG]  [cassandra_node_08]: Connecting to SSH
May01 21:24:42 [DEBUG]  [cassandra_node_08]: connected in 0 sec. Running SSH command
May02 12:03:26 [DEBUG]  [cassandra_node_08]: cluster = cassandra
May02 12:03:39 [DEBUG]  [cassandra_node_08]: cluster = cassandra
May02 12:09:20 [ INFO]  [cassandra_node_08]: Waiting for SSH daemon (83.212.118.12)
May02 12:09:20 [DEBUG]  [cassandra_node_08]: end time:2014-05-02 12:19:20.367768
May02 12:09:20 [DEBUG]  [cassandra_node_08]: ssh attempt:1
May02 12:09:20 [DEBUG]  [cassandra_node_08]: Connecting to SSH
May02 12:09:20 [DEBUG]  [cassandra_node_08]: connected in 0 sec. Running SSH command
May02 12:09:20 [DEBUG]  [cassandra_node_08]: SSH command took 0 sec
May02 12:09:20 [ INFO]  [cassandra_node_08]: now ready (took 0 sec)
May02 12:09:20 [DEBUG]  [cassandra_node_08]: running SSH command:

     sed -i "/.*cassandra.*/g" /etc/hosts; sed -i "/^$/d" /etc/hosts


May02 12:09:20 [DEBUG]  [cassandra_node_08]: Connecting to SSH
May02 12:09:20 [DEBUG]  [cassandra_node_08]: connected in 0 sec. Running SSH command
May02 12:09:20 [DEBUG]  [cassandra_node_08]: SSH command took 0 sec
May02 12:09:20 [DEBUG]  [cassandra_node_08]: command returned:

 	$:  


May02 12:09:20 [DEBUG]  [cassandra_node_08]: running SSH command:

     echo '
     10.0.0.35 cassandra_seednode
     10.0.0.30 cassandra_node_10
     10.0.0.35 cassandra_seed_0
     10.0.0.17 cassandra_node_09
     10.0.0.13 cassandra_node_08
     10.0.0.31 cassandra_node_01
     10.0.0.11 cassandra_node_03
     10.0.0.38 cassandra_node_02
     10.0.0.16 cassandra_node_05
     10.0.0.45 cassandra_node_04
     10.0.0.37 cassandra_node_07
     10.0.0.44 cassandra_node_06' >> /etc/hosts; echo cassandra_node_08 >/etc/hostname


May02 12:09:20 [DEBUG]  [cassandra_node_08]: Connecting to SSH
May02 12:09:20 [DEBUG]  [cassandra_node_08]: connected in 0 sec. Running SSH command
May02 12:09:20 [DEBUG]  [cassandra_node_08]: SSH command took 0 sec
May02 12:09:20 [DEBUG]  [cassandra_node_08]: command returned:

 	$:  


May02 12:09:20 [ INFO]  [cassandra_node_08]: running bootstrap script
May02 12:09:20 [DEBUG]  [cassandra_node_08]: running SSH command:

     #!/bin/bash
     
     MAX_WAIT=300  #5 min
     
     echo "started bootstrap" > bootsrap.log
     
     # check the seednode
     if ! ping -q -c 1 cassandra_seednode &>/dev/null   ;
     then
     echo CTOOL: ERROR - cassandra_seednode not pingable, exiting
     exit -1
     fi
     
     # kill the cassandra process
     CAS_PID=$(jps | grep CassandraDaemon | awk  '{print $1}')
     echo "CTOOL: Killing CassandraDaemon ($CAS_PID)"
     kill -9 $CAS_PID
     
     # clean previous files and logs
     echo "Removing cassandra files and logs"
     #cleaning cassandra files
     rm -rf /var/lib/cassandra/*
     rm /var/log/cassandra/system.log
     #cleaning ctool rrds
     echo "Removing ganglia rrds"
     rm -rf /var/lib/ganglia/rrds/*
     rm /var/log/cassandra/system.log
     
     # find my IP
     my_priv_addr=""
     #look for an IPv4 interface in range 10.0 and use that for the cassandra communication
     let if_count=($(ifconfig | grep eth | wc -l ))-1
     for i in $(seq 0 $if_count)
     do	#look for IPv4 address
     line=$(ifconfig eth$i | grep "inet addr:")
     line=$(echo $line | awk '{print $2}')
     address=$(echo $line | sed 's/addr://g')
     if [[ "$address" == 10.0.* ]] ;
     then
     my_priv_addr=$address
     break
     fi
     done
     
     # configure cassandra
     echo "configuring cassandra.yaml for my address:$my_priv_addr" >> ctool.log
     #change the listen address of this node
     sed "s/listen_address: .*/listen_address: $my_priv_addr/g"  /etc/cassandra/cassandra.yaml> tmp && mv tmp /etc/cassandra/cassandra.yaml
     #change the rpc_address of this node to 0.0.0.0
     sed "s/rpc_address: .*/rpc_address: 0.0.0.0/g"  /etc/cassandra/cassandra.yaml> tmp && mv tmp /etc/cassandra/cassandra.yaml
     #change the seeds to "cassandra_seednode"
     sed "s/seeds: .*/seeds: \"cassandra_seednode\"/g"  /etc/cassandra/cassandra.yaml> tmp && mv tmp /etc/cassandra/cassandra.yaml
     #add the jmx server whatever to cassandra-env.sh
     sed -i.bak "s/.*-Djava.rmi.server.hostname=.*/JVM_OPTS=\"\$JVM_OPTS -Djava.rmi.server.hostname=$my_priv_addr\"/g"  /etc/cassandra/cassandra-env.sh
     sed -i.bak "s/*JVM_OPTS=\"\$JVM_OPTS -Djava.rmi.server.hostname=*\"/JVM_OPTS=\"\$JVM_OPTS -Djava.rmi.server.hostname=$my_priv_addr\"/g"  /etc/cassandra/cassandra-env.sh
     #make sure no requests are dropped by using a big timeout
     sed -i.bak "s/read_request_timeout_in_ms:.*/read_request_timeout_in_ms: 50000/g" /etc/cassandra/cassandra.yaml
     sed -i.bak "s/write_request_timeout_in_ms:.*/write_request_timeout_in_ms: 50000/g" /etc/cassandra/cassandra.yaml
     echo "CTOOL: Done configuring"
     
     
     # start cassandra
     chmod -R o+rw /var/lib/cassandra
     echo Starting casandra service, ganglia-monitor
     service cassandra start
     service ganglia-monitor restart
     
     #wait until ready and try to create keyspace
     echo "Attempting to create ycsb keyspace"
     echo "create keyspace ycsb  WITH REPLICATION = {'class' : 'SimpleStrategy', 'replication_factor': 1 }; use ycsb;  create table usertable (y_id varchar primary key, field0 varchar, field1 varchar, field2 varchar, field3 varchar, field4 varchar, field5 varchar, field6 varchar, field7 varchar, field8 varchar, field9 varchar);" > ycsb_cql.temp
     while ! cqlsh < ycsb_cql.temp 2>/dev/null;do sleep 2; done
     rm ycsb_cql.temp
     
     echo "ended bootstrap" >> bootsrap.log
     
     #report alive in gmetric
     gmetric -n alive -v 1 -t int32 -u nodes -d 10000
     
     
     


May02 12:09:20 [DEBUG]  [cassandra_node_08]: Connecting to SSH
May02 12:09:21 [DEBUG]  [cassandra_node_08]: connected in 0 sec. Running SSH command
May02 12:34:04 [DEBUG]  [cassandra_node_08]: cluster = cassandra
May02 12:34:18 [DEBUG]  [cassandra_node_08]: cluster = cassandra
May02 12:34:18 [DEBUG]  [cassandra_node_08]: cluster = cassandra
May02 12:36:07 [DEBUG]  [cassandra_node_08]: cluster = cassandra
May02 12:36:50 [DEBUG]  [cassandra_node_08]: cluster = cassandra
May02 12:36:50 [ INFO]  [cassandra_node_08]: running kill script
May02 12:36:50 [DEBUG]  [cassandra_node_08]: running SSH command:

     #!/bin/sh
     CAS_PID=$(jps | grep CassandraDaemon | awk  '{print $1}')
     echo "CTOOL: Killing CassandraDaemon ($CAS_PID)"
     kill -9 $CAS_PID &>/dev/null
     ## maybe problematic
     killall java
     
     
     
     ################ debug #################3
     echo "Removing cassandra files and logs" &>>ctool.log
     #cleaning cassandra files
     rm -rf /var/lib/cassandra/* &>>ctool.log
     rm /var/log/cassandra/system.log &>>ctool.log
     #cleaning ctool rrds
     echo "Removing ganglia rrds" &>>ctool.log
     rm -rf /var/lib/ganglia/rrds/* &>>ctool.log
     
     
     
     
     
     echo '
     
     ############  KILLED  ##############' >> ycsb_run.log
     
     #report not alive
     gmetric -n alive -v 0 -t int32 -u nodes -d 10000
     


May02 12:36:50 [DEBUG]  [cassandra_node_08]: Connecting to SSH
May02 12:36:50 [DEBUG]  [cassandra_node_08]: connected in 0 sec. Running SSH command
May02 12:36:51 [DEBUG]  [cassandra_node_08]: SSH command took 0 sec
May02 12:36:51 [DEBUG]  [cassandra_node_08]: command returned:

 	$:  CTOOL: Killing CassandraDaemon ()
	$:  java: no process found
	$:  


May02 12:37:05 [DEBUG]  [cassandra_node_08]: cluster = cassandra
May02 12:37:06 [DEBUG]  [cassandra_node_08]: cluster = cassandra
May02 12:44:31 [DEBUG]  [cassandra_node_08]: cluster = cassandra
May02 12:44:44 [DEBUG]  [cassandra_node_08]: cluster = cassandra
May02 13:32:17 [DEBUG]  [cassandra_node_08]: cluster = cassandra
May02 13:32:31 [DEBUG]  [cassandra_node_08]: cluster = cassandra
May02 13:49:03 [ INFO]  [cassandra_node_08]: Waiting for SSH daemon (83.212.118.12)
May02 13:49:03 [DEBUG]  [cassandra_node_08]: end time:2014-05-02 13:59:03.983508
May02 13:49:03 [DEBUG]  [cassandra_node_08]: ssh attempt:1
May02 13:49:03 [DEBUG]  [cassandra_node_08]: Connecting to SSH
May02 13:49:04 [DEBUG]  [cassandra_node_08]: connected in 0 sec. Running SSH command
May02 13:49:04 [DEBUG]  [cassandra_node_08]: SSH command took 0 sec
May02 13:49:04 [ INFO]  [cassandra_node_08]: now ready (took 0 sec)
May02 13:49:04 [DEBUG]  [cassandra_node_08]: running SSH command:

     sed -i "/.*cassandra.*/g" /etc/hosts; sed -i "/^$/d" /etc/hosts


May02 13:49:04 [DEBUG]  [cassandra_node_08]: Connecting to SSH
May02 13:49:04 [DEBUG]  [cassandra_node_08]: connected in 0 sec. Running SSH command
May02 13:49:04 [DEBUG]  [cassandra_node_08]: SSH command took 0 sec
May02 13:49:04 [DEBUG]  [cassandra_node_08]: command returned:

 	$:  


May02 13:49:04 [DEBUG]  [cassandra_node_08]: running SSH command:

     echo '
     10.0.0.35 cassandra_seednode
     10.0.0.35 cassandra_seed_0
     10.0.0.13 cassandra_node_08
     10.0.0.31 cassandra_node_01
     10.0.0.11 cassandra_node_03
     10.0.0.38 cassandra_node_02
     10.0.0.16 cassandra_node_05
     10.0.0.45 cassandra_node_04
     10.0.0.37 cassandra_node_07
     10.0.0.44 cassandra_node_06' >> /etc/hosts; echo cassandra_node_08 >/etc/hostname


May02 13:49:04 [DEBUG]  [cassandra_node_08]: Connecting to SSH
May02 13:49:04 [DEBUG]  [cassandra_node_08]: connected in 0 sec. Running SSH command
May02 13:49:04 [DEBUG]  [cassandra_node_08]: SSH command took 0 sec
May02 13:49:04 [DEBUG]  [cassandra_node_08]: command returned:

 	$:  


May02 13:49:04 [ INFO]  [cassandra_node_08]: running bootstrap script
May02 13:49:04 [DEBUG]  [cassandra_node_08]: running SSH command:

     #!/bin/bash
     
     MAX_WAIT=300  #5 min
     
     echo "started bootstrap" > bootsrap.log
     
     # check the seednode
     if ! ping -q -c 1 cassandra_seednode &>/dev/null   ;
     then
     echo CTOOL: ERROR - cassandra_seednode not pingable, exiting
     exit -1
     fi
     
     # kill the cassandra process
     CAS_PID=$(jps | grep CassandraDaemon | awk  '{print $1}')
     echo "CTOOL: Killing CassandraDaemon ($CAS_PID)"
     kill -9 $CAS_PID
     
     # clean previous files and logs
     echo "Removing cassandra files and logs"
     #cleaning cassandra files
     rm -rf /var/lib/cassandra/*
     rm /var/log/cassandra/system.log
     #cleaning ctool rrds
     echo "Removing ganglia rrds"
     rm -rf /var/lib/ganglia/rrds/*
     rm /var/log/cassandra/system.log
     
     # find my IP
     my_priv_addr=""
     #look for an IPv4 interface in range 10.0 and use that for the cassandra communication
     let if_count=($(ifconfig | grep eth | wc -l ))-1
     for i in $(seq 0 $if_count)
     do	#look for IPv4 address
     line=$(ifconfig eth$i | grep "inet addr:")
     line=$(echo $line | awk '{print $2}')
     address=$(echo $line | sed 's/addr://g')
     if [[ "$address" == 10.0.* ]] ;
     then
     my_priv_addr=$address
     break
     fi
     done
     
     # configure cassandra
     echo "configuring cassandra.yaml for my address:$my_priv_addr" >> ctool.log
     #change the listen address of this node
     sed "s/listen_address: .*/listen_address: $my_priv_addr/g"  /etc/cassandra/cassandra.yaml> tmp && mv tmp /etc/cassandra/cassandra.yaml
     #change the rpc_address of this node to 0.0.0.0
     sed "s/rpc_address: .*/rpc_address: 0.0.0.0/g"  /etc/cassandra/cassandra.yaml> tmp && mv tmp /etc/cassandra/cassandra.yaml
     #change the seeds to "cassandra_seednode"
     sed "s/seeds: .*/seeds: \"cassandra_seednode\"/g"  /etc/cassandra/cassandra.yaml> tmp && mv tmp /etc/cassandra/cassandra.yaml
     #add the jmx server whatever to cassandra-env.sh
     sed -i.bak "s/.*-Djava.rmi.server.hostname=.*/JVM_OPTS=\"\$JVM_OPTS -Djava.rmi.server.hostname=$my_priv_addr\"/g"  /etc/cassandra/cassandra-env.sh
     sed -i.bak "s/*JVM_OPTS=\"\$JVM_OPTS -Djava.rmi.server.hostname=*\"/JVM_OPTS=\"\$JVM_OPTS -Djava.rmi.server.hostname=$my_priv_addr\"/g"  /etc/cassandra/cassandra-env.sh
     #make sure no requests are dropped by using a big timeout
     sed -i.bak "s/read_request_timeout_in_ms:.*/read_request_timeout_in_ms: 50000/g" /etc/cassandra/cassandra.yaml
     sed -i.bak "s/write_request_timeout_in_ms:.*/write_request_timeout_in_ms: 50000/g" /etc/cassandra/cassandra.yaml
     echo "CTOOL: Done configuring"
     
     
     # start cassandra
     chmod -R o+rw /var/lib/cassandra
     echo Starting casandra service, ganglia-monitor
     service cassandra start
     service ganglia-monitor restart
     
     #wait until ready and try to create keyspace
     echo "Attempting to create ycsb keyspace"
     echo "create keyspace ycsb  WITH REPLICATION = {'class' : 'SimpleStrategy', 'replication_factor': 1 }; use ycsb;  create table usertable (y_id varchar primary key, field0 varchar, field1 varchar, field2 varchar, field3 varchar, field4 varchar, field5 varchar, field6 varchar, field7 varchar, field8 varchar, field9 varchar);" > ycsb_cql.temp
     while ! cqlsh < ycsb_cql.temp 2>/dev/null;do sleep 2; done
     rm ycsb_cql.temp
     
     echo "ended bootstrap" >> bootsrap.log
     
     #report alive in gmetric
     gmetric -n alive -v 1 -t int32 -u nodes -d 10000
     
     
     


May02 13:49:04 [DEBUG]  [cassandra_node_08]: Connecting to SSH
May02 13:49:04 [DEBUG]  [cassandra_node_08]: connected in 0 sec. Running SSH command
May02 13:51:49 [DEBUG]  [cassandra_node_08]: SSH command took 164 sec
May02 13:51:49 [DEBUG]  [cassandra_node_08]: command returned:

 	$:  CTOOL: Killing CassandraDaemon ()
	$:  Removing cassandra files and logs
	$:  Removing ganglia rrds
	$:  CTOOL: Done configuring
	$:  Starting casandra service, ganglia-monitor
	$:  Stopping Ganglia Monitor Daemon: gmond.
	$:  Starting Ganglia Monitor Daemon: gmond.
	$:  Attempting to create ycsb keyspace
	$:  kill: usage: kill [-s sigspec | -n signum | -sigspec] pid | jobspec ... or kill -l [sigspec]
	$:  rm: cannot remove `/var/log/cassandra/system.log': No such file or directory
	$:  rm: cannot remove `/var/log/cassandra/system.log': No such file or directory
	$:  rm: cannot remove `ycsb_cql.temp': No such file or directory
	$:  


May02 13:51:49 [DEBUG]  [cassandra_node_08]: command returned:
	$:  CTOOL: Killing CassandraDaemon ()
	$:  Removing cassandra files and logs
	$:  Removing ganglia rrds
	$:  CTOOL: Done configuring
	$:  Starting casandra service, ganglia-monitor
	$:  Stopping Ganglia Monitor Daemon: gmond.
	$:  Starting Ganglia Monitor Daemon: gmond.
	$:  Attempting to create ycsb keyspace
	$:  kill: usage: kill [-s sigspec | -n signum | -sigspec] pid | jobspec ... or kill -l [sigspec]
	$:  rm: cannot remove `/var/log/cassandra/system.log': No such file or directory
	$:  rm: cannot remove `/var/log/cassandra/system.log': No such file or directory
	$:  rm: cannot remove `ycsb_cql.temp': No such file or directory
	$:  
May02 13:51:49 [ INFO]  [cassandra_node_08]: is now bootstrapped (took 164 sec)
May02 13:52:00 [DEBUG]  [cassandra_node_08]: running SSH command:

     sed -i "/.*cassandra.*/g" /etc/hosts; sed -i "/^$/d" /etc/hosts


May02 13:52:00 [DEBUG]  [cassandra_node_08]: Connecting to SSH
May02 13:52:00 [DEBUG]  [cassandra_node_08]: connected in 0 sec. Running SSH command
May02 13:52:01 [DEBUG]  [cassandra_node_08]: SSH command took 0 sec
May02 13:52:01 [DEBUG]  [cassandra_node_08]: command returned:

 	$:  


May02 13:52:01 [DEBUG]  [cassandra_node_08]: running SSH command:

     echo '
     10.0.0.35 cassandra_seednode
     10.0.0.35 cassandra_seed_0
     10.0.0.13 cassandra_node_08
     10.0.0.31 cassandra_node_01
     10.0.0.11 cassandra_node_03
     10.0.0.38 cassandra_node_02
     10.0.0.16 cassandra_node_05
     10.0.0.45 cassandra_node_04
     10.0.0.37 cassandra_node_07
     10.0.0.44 cassandra_node_06' >> /etc/hosts; echo cassandra_node_08 >/etc/hostname


May02 13:52:01 [DEBUG]  [cassandra_node_08]: Connecting to SSH
May02 13:52:01 [DEBUG]  [cassandra_node_08]: connected in 0 sec. Running SSH command
May02 13:52:01 [DEBUG]  [cassandra_node_08]: SSH command took 0 sec
May02 13:52:01 [DEBUG]  [cassandra_node_08]: command returned:

 	$:  


May02 13:59:41 [DEBUG]  [cassandra_node_08]: running SSH command:

     sed -i "/.*cassandra.*/g" /etc/hosts; sed -i "/^$/d" /etc/hosts


May02 13:59:41 [DEBUG]  [cassandra_node_08]: Connecting to SSH
May02 13:59:42 [DEBUG]  [cassandra_node_08]: connected in 0 sec. Running SSH command
May02 13:59:42 [DEBUG]  [cassandra_node_08]: SSH command took 0 sec
May02 13:59:42 [DEBUG]  [cassandra_node_08]: command returned:

 	$:  


May02 13:59:42 [DEBUG]  [cassandra_node_08]: running SSH command:

     echo '
     10.0.0.35 cassandra_seednode
     10.0.0.30 cassandra_node_10
     10.0.0.35 cassandra_seed_0
     10.0.0.17 cassandra_node_09
     10.0.0.13 cassandra_node_08
     10.0.0.31 cassandra_node_01
     10.0.0.11 cassandra_node_03
     10.0.0.38 cassandra_node_02
     10.0.0.16 cassandra_node_05
     10.0.0.45 cassandra_node_04
     10.0.0.37 cassandra_node_07
     10.0.0.44 cassandra_node_06' >> /etc/hosts; echo cassandra_node_08 >/etc/hostname


May02 13:59:42 [DEBUG]  [cassandra_node_08]: Connecting to SSH
May02 13:59:42 [DEBUG]  [cassandra_node_08]: connected in 0 sec. Running SSH command
May02 13:59:42 [DEBUG]  [cassandra_node_08]: SSH command took 0 sec
May02 13:59:42 [DEBUG]  [cassandra_node_08]: command returned:

 	$:  


May02 14:07:46 [DEBUG]  [cassandra_node_08]: running SSH command:

     sed -i "/.*cassandra.*/g" /etc/hosts; sed -i "/^$/d" /etc/hosts


May02 14:07:46 [DEBUG]  [cassandra_node_08]: Connecting to SSH
May02 14:07:46 [DEBUG]  [cassandra_node_08]: connected in 0 sec. Running SSH command
May02 14:07:47 [DEBUG]  [cassandra_node_08]: SSH command took 0 sec
May02 14:07:47 [DEBUG]  [cassandra_node_08]: command returned:

 	$:  


May02 14:07:47 [DEBUG]  [cassandra_node_08]: running SSH command:

     echo '
     10.0.0.35 cassandra_seednode
     10.0.0.18 cassandra_node_11
     10.0.0.30 cassandra_node_10
     10.0.0.35 cassandra_seed_0
     10.0.0.17 cassandra_node_09
     10.0.0.13 cassandra_node_08
     10.0.0.42 cassandra_node_12
     10.0.0.33 cassandra_node_14
     10.0.0.31 cassandra_node_01
     10.0.0.41 cassandra_node_13
     10.0.0.11 cassandra_node_03
     10.0.0.38 cassandra_node_02
     10.0.0.16 cassandra_node_05
     10.0.0.45 cassandra_node_04
     10.0.0.37 cassandra_node_07
     10.0.0.44 cassandra_node_06' >> /etc/hosts; echo cassandra_node_08 >/etc/hostname


May02 14:07:47 [DEBUG]  [cassandra_node_08]: Connecting to SSH
May02 14:07:47 [DEBUG]  [cassandra_node_08]: connected in 0 sec. Running SSH command
May02 14:07:47 [DEBUG]  [cassandra_node_08]: SSH command took 0 sec
May02 14:07:47 [DEBUG]  [cassandra_node_08]: command returned:

 	$:  


May02 14:15:31 [DEBUG]  [cassandra_node_08]: running SSH command:

     sed -i "/.*cassandra.*/g" /etc/hosts; sed -i "/^$/d" /etc/hosts


May02 14:15:31 [DEBUG]  [cassandra_node_08]: Connecting to SSH
May02 14:15:32 [DEBUG]  [cassandra_node_08]: connected in 0 sec. Running SSH command
May02 14:15:32 [DEBUG]  [cassandra_node_08]: SSH command took 0 sec
May02 14:15:32 [DEBUG]  [cassandra_node_08]: command returned:

 	$:  


May02 14:15:32 [DEBUG]  [cassandra_node_08]: running SSH command:

     echo '
     10.0.0.35 cassandra_seednode
     10.0.0.18 cassandra_node_11
     10.0.0.30 cassandra_node_10
     10.0.0.32 cassandra_node_15
     10.0.0.39 cassandra_node_16
     10.0.0.43 cassandra_node_17
     10.0.0.35 cassandra_seed_0
     10.0.0.17 cassandra_node_09
     10.0.0.13 cassandra_node_08
     10.0.0.42 cassandra_node_12
     10.0.0.33 cassandra_node_14
     10.0.0.31 cassandra_node_01
     10.0.0.41 cassandra_node_13
     10.0.0.11 cassandra_node_03
     10.0.0.38 cassandra_node_02
     10.0.0.16 cassandra_node_05
     10.0.0.45 cassandra_node_04
     10.0.0.37 cassandra_node_07
     10.0.0.44 cassandra_node_06' >> /etc/hosts; echo cassandra_node_08 >/etc/hostname


May02 14:15:32 [DEBUG]  [cassandra_node_08]: Connecting to SSH
May02 14:15:32 [DEBUG]  [cassandra_node_08]: connected in 0 sec. Running SSH command
May02 14:15:33 [DEBUG]  [cassandra_node_08]: SSH command took 0 sec
May02 14:15:33 [DEBUG]  [cassandra_node_08]: command returned:

 	$:  


May02 14:56:28 [DEBUG]  [cassandra_node_08]: running SSH command:

     sed -i "/.*cassandra.*/g" /etc/hosts; sed -i "/^$/d" /etc/hosts


May02 14:56:28 [DEBUG]  [cassandra_node_08]: Connecting to SSH
May02 14:56:28 [DEBUG]  [cassandra_node_08]: connected in 0 sec. Running SSH command
May02 14:56:29 [DEBUG]  [cassandra_node_08]: SSH command took 0 sec
May02 14:56:29 [DEBUG]  [cassandra_node_08]: command returned:

 	$:  


May02 14:56:29 [DEBUG]  [cassandra_node_08]: running SSH command:

     echo '
     10.0.0.35 cassandra_seednode
     10.0.0.18 cassandra_node_11
     10.0.0.30 cassandra_node_10
     10.0.0.32 cassandra_node_15
     10.0.0.39 cassandra_node_16
     10.0.0.43 cassandra_node_17
     10.0.0.35 cassandra_seed_0
     10.0.0.17 cassandra_node_09
     10.0.0.13 cassandra_node_08
     10.0.0.40 cassandra_node_18
     10.0.0.20 cassandra_node_19
     10.0.0.42 cassandra_node_12
     10.0.0.33 cassandra_node_14
     10.0.0.31 cassandra_node_01
     10.0.0.41 cassandra_node_13
     10.0.0.11 cassandra_node_03
     10.0.0.38 cassandra_node_02
     10.0.0.16 cassandra_node_05
     10.0.0.45 cassandra_node_04
     10.0.0.37 cassandra_node_07
     10.0.0.44 cassandra_node_06' >> /etc/hosts; echo cassandra_node_08 >/etc/hostname


May02 14:56:29 [DEBUG]  [cassandra_node_08]: Connecting to SSH
May02 14:56:29 [DEBUG]  [cassandra_node_08]: connected in 0 sec. Running SSH command
May02 14:56:30 [DEBUG]  [cassandra_node_08]: SSH command took 0 sec
May02 14:56:30 [DEBUG]  [cassandra_node_08]: command returned:

 	$:  


May02 15:16:37 [DEBUG]  [cassandra_node_08]: cluster = cassandra
May02 15:16:37 [ INFO]  [cassandra_node_08]: running kill script
May02 15:16:37 [DEBUG]  [cassandra_node_08]: running SSH command:

     #!/bin/sh
     CAS_PID=$(jps | grep CassandraDaemon | awk  '{print $1}')
     echo "CTOOL: Killing CassandraDaemon ($CAS_PID)"
     kill -9 $CAS_PID &>/dev/null
     ## maybe problematic
     killall java
     
     
     
     ################ debug #################3
     echo "Removing cassandra files and logs" &>>ctool.log
     #cleaning cassandra files
     rm -rf /var/lib/cassandra/* &>>ctool.log
     rm /var/log/cassandra/system.log &>>ctool.log
     #cleaning ctool rrds
     echo "Removing ganglia rrds" &>>ctool.log
     rm -rf /var/lib/ganglia/rrds/* &>>ctool.log
     
     
     
     
     
     echo '
     
     ############  KILLED  ##############' >> ycsb_run.log
     
     #report not alive
     gmetric -n alive -v 0 -t int32 -u nodes -d 10000
     


May02 15:16:37 [DEBUG]  [cassandra_node_08]: Connecting to SSH
May02 15:16:38 [DEBUG]  [cassandra_node_08]: connected in 0 sec. Running SSH command
May02 15:16:39 [DEBUG]  [cassandra_node_08]: SSH command took 1 sec
May02 15:16:39 [DEBUG]  [cassandra_node_08]: command returned:

 	$:  CTOOL: Killing CassandraDaemon (17925)
	$:  


May02 15:16:53 [DEBUG]  [cassandra_node_08]: cluster = cassandra
May02 15:17:14 [DEBUG]  [cassandra_node_08]: cluster = cassandra
May02 15:18:35 [DEBUG]  [cassandra_node_08]: cluster = cassandra
May02 15:18:35 [ INFO]  [cassandra_node_08]: running kill script
May02 15:18:35 [DEBUG]  [cassandra_node_08]: running SSH command:

     #!/bin/sh
     CAS_PID=$(jps | grep CassandraDaemon | awk  '{print $1}')
     echo "CTOOL: Killing CassandraDaemon ($CAS_PID)"
     kill -9 $CAS_PID &>/dev/null
     ## maybe problematic
     killall java
     
     
     
     ################ debug #################3
     echo "Removing cassandra files and logs" &>>ctool.log
     #cleaning cassandra files
     rm -rf /var/lib/cassandra/* &>>ctool.log
     rm /var/log/cassandra/system.log &>>ctool.log
     #cleaning ctool rrds
     echo "Removing ganglia rrds" &>>ctool.log
     rm -rf /var/lib/ganglia/rrds/* &>>ctool.log
     
     
     
     
     
     echo '
     
     ############  KILLED  ##############' >> ycsb_run.log
     
     #report not alive
     gmetric -n alive -v 0 -t int32 -u nodes -d 10000
     


May02 15:18:35 [DEBUG]  [cassandra_node_08]: Connecting to SSH
May02 15:18:35 [DEBUG]  [cassandra_node_08]: connected in 0 sec. Running SSH command
May02 15:18:36 [DEBUG]  [cassandra_node_08]: SSH command took 0 sec
May02 15:18:36 [DEBUG]  [cassandra_node_08]: command returned:

 	$:  CTOOL: Killing CassandraDaemon ()
	$:  java: no process found
	$:  


May02 15:18:50 [DEBUG]  [cassandra_node_08]: cluster = cassandra
May02 15:19:06 [DEBUG]  [cassandra_node_08]: cluster = cassandra
May02 15:26:26 [DEBUG]  [cassandra_node_08]: cluster = cassandra
May02 15:26:41 [DEBUG]  [cassandra_node_08]: cluster = cassandra
May02 15:27:07 [DEBUG]  [cassandra_node_08]: cluster = cassandra
May02 15:27:24 [DEBUG]  [cassandra_node_08]: cluster = cassandra
May02 15:38:27 [ INFO]  [cassandra_node_08]: Waiting for SSH daemon (83.212.118.12)
May02 15:38:27 [DEBUG]  [cassandra_node_08]: end time:2014-05-02 15:48:27.734054
May02 15:38:27 [DEBUG]  [cassandra_node_08]: ssh attempt:1
May02 15:38:27 [DEBUG]  [cassandra_node_08]: Connecting to SSH
May02 15:38:27 [DEBUG]  [cassandra_node_08]: connected in 0 sec. Running SSH command
May02 15:38:27 [DEBUG]  [cassandra_node_08]: SSH command took 0 sec
May02 15:38:27 [ INFO]  [cassandra_node_08]: now ready (took 0 sec)
May02 15:38:27 [DEBUG]  [cassandra_node_08]: running SSH command:

     sed -i "/.*cassandra.*/g" /etc/hosts; sed -i "/^$/d" /etc/hosts


May02 15:38:27 [DEBUG]  [cassandra_node_08]: Connecting to SSH
May02 15:38:28 [DEBUG]  [cassandra_node_08]: connected in 0 sec. Running SSH command
May02 15:38:28 [DEBUG]  [cassandra_node_08]: SSH command took 0 sec
May02 15:38:28 [DEBUG]  [cassandra_node_08]: command returned:

 	$:  


May02 15:38:28 [DEBUG]  [cassandra_node_08]: running SSH command:

     echo '
     10.0.0.35 cassandra_seednode
     10.0.0.30 cassandra_node_10
     10.0.0.35 cassandra_seed_0
     10.0.0.17 cassandra_node_09
     10.0.0.13 cassandra_node_08
     10.0.0.31 cassandra_node_01
     10.0.0.11 cassandra_node_03
     10.0.0.38 cassandra_node_02
     10.0.0.16 cassandra_node_05
     10.0.0.45 cassandra_node_04
     10.0.0.37 cassandra_node_07
     10.0.0.44 cassandra_node_06' >> /etc/hosts; echo cassandra_node_08 >/etc/hostname


May02 15:38:28 [DEBUG]  [cassandra_node_08]: Connecting to SSH
May02 15:38:28 [DEBUG]  [cassandra_node_08]: connected in 0 sec. Running SSH command
May02 15:38:28 [DEBUG]  [cassandra_node_08]: SSH command took 0 sec
May02 15:38:28 [DEBUG]  [cassandra_node_08]: command returned:

 	$:  


May02 15:38:28 [ INFO]  [cassandra_node_08]: running bootstrap script
May02 15:38:28 [DEBUG]  [cassandra_node_08]: running SSH command:

     #!/bin/bash
     
     MAX_WAIT=300  #5 min
     
     echo "started bootstrap" > bootsrap.log
     
     # check the seednode
     if ! ping -q -c 1 cassandra_seednode &>/dev/null   ;
     then
     echo CTOOL: ERROR - cassandra_seednode not pingable, exiting
     exit -1
     fi
     
     # kill the cassandra process
     CAS_PID=$(jps | grep CassandraDaemon | awk  '{print $1}')
     echo "CTOOL: Killing CassandraDaemon ($CAS_PID)"
     kill -9 $CAS_PID
     
     # clean previous files and logs
     echo "Removing cassandra files and logs"
     #cleaning cassandra files
     rm -rf /var/lib/cassandra/*
     rm /var/log/cassandra/system.log
     #cleaning ctool rrds
     echo "Removing ganglia rrds"
     rm -rf /var/lib/ganglia/rrds/*
     rm /var/log/cassandra/system.log
     
     # find my IP
     my_priv_addr=""
     #look for an IPv4 interface in range 10.0 and use that for the cassandra communication
     let if_count=($(ifconfig | grep eth | wc -l ))-1
     for i in $(seq 0 $if_count)
     do	#look for IPv4 address
     line=$(ifconfig eth$i | grep "inet addr:")
     line=$(echo $line | awk '{print $2}')
     address=$(echo $line | sed 's/addr://g')
     if [[ "$address" == 10.0.* ]] ;
     then
     my_priv_addr=$address
     break
     fi
     done
     
     # configure cassandra
     echo "configuring cassandra.yaml for my address:$my_priv_addr" >> ctool.log
     #change the listen address of this node
     sed "s/listen_address: .*/listen_address: $my_priv_addr/g"  /etc/cassandra/cassandra.yaml> tmp && mv tmp /etc/cassandra/cassandra.yaml
     #change the rpc_address of this node to 0.0.0.0
     sed "s/rpc_address: .*/rpc_address: 0.0.0.0/g"  /etc/cassandra/cassandra.yaml> tmp && mv tmp /etc/cassandra/cassandra.yaml
     #change the seeds to "cassandra_seednode"
     sed "s/seeds: .*/seeds: \"cassandra_seednode\"/g"  /etc/cassandra/cassandra.yaml> tmp && mv tmp /etc/cassandra/cassandra.yaml
     #add the jmx server whatever to cassandra-env.sh
     sed -i.bak "s/.*-Djava.rmi.server.hostname=.*/JVM_OPTS=\"\$JVM_OPTS -Djava.rmi.server.hostname=$my_priv_addr\"/g"  /etc/cassandra/cassandra-env.sh
     sed -i.bak "s/*JVM_OPTS=\"\$JVM_OPTS -Djava.rmi.server.hostname=*\"/JVM_OPTS=\"\$JVM_OPTS -Djava.rmi.server.hostname=$my_priv_addr\"/g"  /etc/cassandra/cassandra-env.sh
     #make sure no requests are dropped by using a big timeout
     sed -i.bak "s/read_request_timeout_in_ms:.*/read_request_timeout_in_ms: 50000/g" /etc/cassandra/cassandra.yaml
     sed -i.bak "s/write_request_timeout_in_ms:.*/write_request_timeout_in_ms: 50000/g" /etc/cassandra/cassandra.yaml
     echo "CTOOL: Done configuring"
     
     
     # start cassandra
     chmod -R o+rw /var/lib/cassandra
     echo Starting casandra service, ganglia-monitor
     service cassandra start
     service ganglia-monitor restart
     
     #wait until ready and try to create keyspace
     echo "Attempting to create ycsb keyspace"
     echo "create keyspace ycsb  WITH REPLICATION = {'class' : 'SimpleStrategy', 'replication_factor': 1 }; use ycsb;  create table usertable (y_id varchar primary key, field0 varchar, field1 varchar, field2 varchar, field3 varchar, field4 varchar, field5 varchar, field6 varchar, field7 varchar, field8 varchar, field9 varchar);" > ycsb_cql.temp
     while ! cqlsh < ycsb_cql.temp 2>/dev/null;do sleep 2; done
     rm ycsb_cql.temp
     
     echo "ended bootstrap" >> bootsrap.log
     
     #report alive in gmetric
     gmetric -n alive -v 1 -t int32 -u nodes -d 10000
     
     
     


May02 15:38:28 [DEBUG]  [cassandra_node_08]: Connecting to SSH
May02 15:38:28 [DEBUG]  [cassandra_node_08]: connected in 0 sec. Running SSH command
May02 15:39:33 [DEBUG]  [cassandra_node_08]: SSH command took 65 sec
May02 15:39:33 [DEBUG]  [cassandra_node_08]: command returned:

 	$:  CTOOL: Killing CassandraDaemon ()
	$:  Removing cassandra files and logs
	$:  Removing ganglia rrds
	$:  CTOOL: Done configuring
	$:  Starting casandra service, ganglia-monitor
	$:  Stopping Ganglia Monitor Daemon: gmond.
	$:  Starting Ganglia Monitor Daemon: gmond.
	$:  Attempting to create ycsb keyspace
	$:  kill: usage: kill [-s sigspec | -n signum | -sigspec] pid | jobspec ... or kill -l [sigspec]
	$:  rm: cannot remove `/var/log/cassandra/system.log': No such file or directory
	$:  rm: cannot remove `/var/log/cassandra/system.log': No such file or directory
	$:  


May02 15:39:33 [DEBUG]  [cassandra_node_08]: command returned:
	$:  CTOOL: Killing CassandraDaemon ()
	$:  Removing cassandra files and logs
	$:  Removing ganglia rrds
	$:  CTOOL: Done configuring
	$:  Starting casandra service, ganglia-monitor
	$:  Stopping Ganglia Monitor Daemon: gmond.
	$:  Starting Ganglia Monitor Daemon: gmond.
	$:  Attempting to create ycsb keyspace
	$:  kill: usage: kill [-s sigspec | -n signum | -sigspec] pid | jobspec ... or kill -l [sigspec]
	$:  rm: cannot remove `/var/log/cassandra/system.log': No such file or directory
	$:  rm: cannot remove `/var/log/cassandra/system.log': No such file or directory
	$:  
May02 15:39:33 [ INFO]  [cassandra_node_08]: is now bootstrapped (took 65 sec)
May02 15:39:42 [DEBUG]  [cassandra_node_08]: running SSH command:

     sed -i "/.*cassandra.*/g" /etc/hosts; sed -i "/^$/d" /etc/hosts


May02 15:39:42 [DEBUG]  [cassandra_node_08]: Connecting to SSH
May02 15:39:42 [DEBUG]  [cassandra_node_08]: connected in 0 sec. Running SSH command
May02 15:39:42 [DEBUG]  [cassandra_node_08]: SSH command took 0 sec
May02 15:39:42 [DEBUG]  [cassandra_node_08]: command returned:

 	$:  


May02 15:39:42 [DEBUG]  [cassandra_node_08]: running SSH command:

     echo '
     10.0.0.35 cassandra_seednode
     10.0.0.30 cassandra_node_10
     10.0.0.35 cassandra_seed_0
     10.0.0.17 cassandra_node_09
     10.0.0.13 cassandra_node_08
     10.0.0.31 cassandra_node_01
     10.0.0.11 cassandra_node_03
     10.0.0.38 cassandra_node_02
     10.0.0.16 cassandra_node_05
     10.0.0.45 cassandra_node_04
     10.0.0.37 cassandra_node_07
     10.0.0.44 cassandra_node_06' >> /etc/hosts; echo cassandra_node_08 >/etc/hostname


May02 15:39:42 [DEBUG]  [cassandra_node_08]: Connecting to SSH
May02 15:39:42 [DEBUG]  [cassandra_node_08]: connected in 0 sec. Running SSH command
May02 15:39:42 [DEBUG]  [cassandra_node_08]: SSH command took 0 sec
May02 15:39:42 [DEBUG]  [cassandra_node_08]: command returned:

 	$:  


May02 15:46:17 [DEBUG]  [cassandra_node_08]: running SSH command:

     sed -i "/.*cassandra.*/g" /etc/hosts; sed -i "/^$/d" /etc/hosts


May02 15:46:17 [DEBUG]  [cassandra_node_08]: Connecting to SSH
May02 15:46:17 [DEBUG]  [cassandra_node_08]: connected in 0 sec. Running SSH command
May02 15:46:17 [DEBUG]  [cassandra_node_08]: SSH command took 0 sec
May02 15:46:17 [DEBUG]  [cassandra_node_08]: command returned:

 	$:  


May02 15:46:17 [DEBUG]  [cassandra_node_08]: running SSH command:

     echo '
     10.0.0.35 cassandra_seednode
     10.0.0.18 cassandra_node_11
     10.0.0.30 cassandra_node_10
     10.0.0.35 cassandra_seed_0
     10.0.0.17 cassandra_node_09
     10.0.0.13 cassandra_node_08
     10.0.0.42 cassandra_node_12
     10.0.0.33 cassandra_node_14
     10.0.0.31 cassandra_node_01
     10.0.0.41 cassandra_node_13
     10.0.0.11 cassandra_node_03
     10.0.0.38 cassandra_node_02
     10.0.0.16 cassandra_node_05
     10.0.0.45 cassandra_node_04
     10.0.0.37 cassandra_node_07
     10.0.0.44 cassandra_node_06' >> /etc/hosts; echo cassandra_node_08 >/etc/hostname


May02 15:46:17 [DEBUG]  [cassandra_node_08]: Connecting to SSH
May02 15:46:18 [DEBUG]  [cassandra_node_08]: connected in 0 sec. Running SSH command
May02 15:46:18 [DEBUG]  [cassandra_node_08]: SSH command took 0 sec
May02 15:46:18 [DEBUG]  [cassandra_node_08]: command returned:

 	$:  


May02 16:20:19 [DEBUG]  [cassandra_node_08]: cluster = cassandra
May02 16:20:19 [ INFO]  [cassandra_node_08]: running kill script
May02 16:20:19 [DEBUG]  [cassandra_node_08]: running SSH command:

     #!/bin/sh
     CAS_PID=$(jps | grep CassandraDaemon | awk  '{print $1}')
     echo "CTOOL: Killing CassandraDaemon ($CAS_PID)"
     kill -9 $CAS_PID &>/dev/null
     ## maybe problematic
     killall java
     
     
     
     ################ debug #################3
     echo "Removing cassandra files and logs" &>>ctool.log
     #cleaning cassandra files
     rm -rf /var/lib/cassandra/* &>>ctool.log
     rm /var/log/cassandra/system.log &>>ctool.log
     #cleaning ctool rrds
     echo "Removing ganglia rrds" &>>ctool.log
     rm -rf /var/lib/ganglia/rrds/* &>>ctool.log
     
     
     
     
     
     echo '
     
     ############  KILLED  ##############' >> ycsb_run.log
     
     #report not alive
     gmetric -n alive -v 0 -t int32 -u nodes -d 10000
     


May02 16:20:19 [DEBUG]  [cassandra_node_08]: Connecting to SSH
May02 16:20:19 [DEBUG]  [cassandra_node_08]: connected in 0 sec. Running SSH command
May02 16:20:21 [DEBUG]  [cassandra_node_08]: SSH command took 1 sec
May02 16:20:21 [DEBUG]  [cassandra_node_08]: command returned:

 	$:  CTOOL: Killing CassandraDaemon (20518)
	$:  


May02 16:20:36 [DEBUG]  [cassandra_node_08]: cluster = cassandra
May02 16:21:00 [DEBUG]  [cassandra_node_08]: cluster = cassandra
May02 16:28:24 [DEBUG]  [cassandra_node_08]: cluster = cassandra
May02 16:28:39 [DEBUG]  [cassandra_node_08]: cluster = cassandra
May02 16:29:05 [DEBUG]  [cassandra_node_08]: cluster = cassandra
May02 16:29:19 [DEBUG]  [cassandra_node_08]: cluster = cassandra
May02 16:52:21 [DEBUG]  [cassandra_node_08]: cluster = cassandra
May02 16:52:40 [DEBUG]  [cassandra_node_08]: cluster = cassandra
May02 16:52:54 [DEBUG]  [cassandra_node_08]: cluster = cassandra
May02 17:14:26 [DEBUG]  [cassandra_node_08]: cluster = cassandra
May02 17:14:45 [DEBUG]  [cassandra_node_08]: cluster = cassandra
May02 17:14:59 [DEBUG]  [cassandra_node_08]: cluster = cassandra
May02 18:46:30 [DEBUG]  [cassandra_node_08]: cluster = cassandra
May02 18:46:44 [DEBUG]  [cassandra_node_08]: cluster = cassandra
May02 18:47:17 [DEBUG]  [cassandra_node_08]: cluster = cassandra
May02 18:47:39 [DEBUG]  [cassandra_node_08]: cluster = cassandra
May02 18:47:52 [DEBUG]  [cassandra_node_08]: cluster = cassandra
May02 18:54:15 [DEBUG]  [cassandra_node_08]: cluster = cassandra
May02 18:54:30 [DEBUG]  [cassandra_node_08]: cluster = cassandra
May02 18:54:43 [DEBUG]  [cassandra_node_08]: cluster = cassandra
May02 18:55:53 [ INFO]  [cassandra_node_08]: Waiting for SSH daemon (83.212.118.12)
May02 18:55:53 [DEBUG]  [cassandra_node_08]: end time:2014-05-02 19:05:53.584749
May02 18:55:53 [DEBUG]  [cassandra_node_08]: ssh attempt:1
May02 18:55:53 [DEBUG]  [cassandra_node_08]: Connecting to SSH
May02 18:55:53 [DEBUG]  [cassandra_node_08]: connected in 0 sec. Running SSH command
May02 18:55:53 [DEBUG]  [cassandra_node_08]: SSH command took 0 sec
May02 18:55:53 [ INFO]  [cassandra_node_08]: now ready (took 0 sec)
May02 18:55:53 [DEBUG]  [cassandra_node_08]: running SSH command:

     sed -i "/.*cassandra.*/g" /etc/hosts; sed -i "/^$/d" /etc/hosts


May02 18:55:53 [DEBUG]  [cassandra_node_08]: Connecting to SSH
May02 18:55:53 [DEBUG]  [cassandra_node_08]: connected in 0 sec. Running SSH command
May02 18:55:53 [DEBUG]  [cassandra_node_08]: SSH command took 0 sec
May02 18:55:53 [DEBUG]  [cassandra_node_08]: command returned:

 	$:  


May02 18:55:53 [DEBUG]  [cassandra_node_08]: running SSH command:

     echo '
     10.0.0.35 cassandra_seednode
     10.0.0.35 cassandra_seed_0
     10.0.0.13 cassandra_node_08
     10.0.0.31 cassandra_node_01
     10.0.0.11 cassandra_node_03
     10.0.0.38 cassandra_node_02
     10.0.0.16 cassandra_node_05
     10.0.0.45 cassandra_node_04
     10.0.0.37 cassandra_node_07
     10.0.0.44 cassandra_node_06' >> /etc/hosts; echo cassandra_node_08 >/etc/hostname


May02 18:55:53 [DEBUG]  [cassandra_node_08]: Connecting to SSH
May02 18:55:54 [DEBUG]  [cassandra_node_08]: connected in 0 sec. Running SSH command
May02 18:55:54 [DEBUG]  [cassandra_node_08]: SSH command took 0 sec
May02 18:55:54 [DEBUG]  [cassandra_node_08]: command returned:

 	$:  


May02 18:55:54 [ INFO]  [cassandra_node_08]: running bootstrap script
May02 18:55:54 [DEBUG]  [cassandra_node_08]: running SSH command:

     #!/bin/bash
     
     MAX_WAIT=300  #5 min
     
     echo "started bootstrap" > bootsrap.log
     
     # check the seednode
     if ! ping -q -c 1 cassandra_seednode &>/dev/null   ;
     then
     echo CTOOL: ERROR - cassandra_seednode not pingable, exiting
     exit -1
     fi
     
     # kill the cassandra process
     CAS_PID=$(jps | grep CassandraDaemon | awk  '{print $1}')
     echo "CTOOL: Killing CassandraDaemon ($CAS_PID)"
     kill -9 $CAS_PID
     
     # clean previous files and logs
     echo "Removing cassandra files and logs"
     #cleaning cassandra files
     rm -rf /var/lib/cassandra/*
     rm /var/log/cassandra/system.log
     #cleaning ctool rrds
     echo "Removing ganglia rrds"
     rm -rf /var/lib/ganglia/rrds/*
     rm /var/log/cassandra/system.log
     
     # find my IP
     my_priv_addr=""
     #look for an IPv4 interface in range 10.0 and use that for the cassandra communication
     let if_count=($(ifconfig | grep eth | wc -l ))-1
     for i in $(seq 0 $if_count)
     do	#look for IPv4 address
     line=$(ifconfig eth$i | grep "inet addr:")
     line=$(echo $line | awk '{print $2}')
     address=$(echo $line | sed 's/addr://g')
     if [[ "$address" == 10.0.* ]] ;
     then
     my_priv_addr=$address
     break
     fi
     done
     
     # configure cassandra
     echo "configuring cassandra.yaml for my address:$my_priv_addr" >> ctool.log
     #change the listen address of this node
     sed "s/listen_address: .*/listen_address: $my_priv_addr/g"  /etc/cassandra/cassandra.yaml> tmp && mv tmp /etc/cassandra/cassandra.yaml
     #change the rpc_address of this node to 0.0.0.0
     sed "s/rpc_address: .*/rpc_address: 0.0.0.0/g"  /etc/cassandra/cassandra.yaml> tmp && mv tmp /etc/cassandra/cassandra.yaml
     #change the seeds to "cassandra_seednode"
     sed "s/seeds: .*/seeds: \"cassandra_seednode\"/g"  /etc/cassandra/cassandra.yaml> tmp && mv tmp /etc/cassandra/cassandra.yaml
     #add the jmx server whatever to cassandra-env.sh
     sed -i.bak "s/.*-Djava.rmi.server.hostname=.*/JVM_OPTS=\"\$JVM_OPTS -Djava.rmi.server.hostname=$my_priv_addr\"/g"  /etc/cassandra/cassandra-env.sh
     sed -i.bak "s/*JVM_OPTS=\"\$JVM_OPTS -Djava.rmi.server.hostname=*\"/JVM_OPTS=\"\$JVM_OPTS -Djava.rmi.server.hostname=$my_priv_addr\"/g"  /etc/cassandra/cassandra-env.sh
     #make sure no requests are dropped by using a big timeout
     sed -i.bak "s/read_request_timeout_in_ms:.*/read_request_timeout_in_ms: 50000/g" /etc/cassandra/cassandra.yaml
     sed -i.bak "s/write_request_timeout_in_ms:.*/write_request_timeout_in_ms: 50000/g" /etc/cassandra/cassandra.yaml
     echo "CTOOL: Done configuring"
     
     
     # start cassandra
     chmod -R o+rw /var/lib/cassandra
     echo Starting casandra service, ganglia-monitor
     service cassandra start
     service ganglia-monitor restart
     
     #wait until ready and try to create keyspace
     echo "Attempting to create ycsb keyspace"
     echo "create keyspace ycsb  WITH REPLICATION = {'class' : 'SimpleStrategy', 'replication_factor': 1 }; use ycsb;  create table usertable (y_id varchar primary key, field0 varchar, field1 varchar, field2 varchar, field3 varchar, field4 varchar, field5 varchar, field6 varchar, field7 varchar, field8 varchar, field9 varchar);" > ycsb_cql.temp
     while ! cqlsh < ycsb_cql.temp 2>/dev/null;do sleep 2; done
     rm ycsb_cql.temp
     
     echo "ended bootstrap" >> bootsrap.log
     
     #report alive in gmetric
     gmetric -n alive -v 1 -t int32 -u nodes -d 10000
     
     
     


May02 18:55:54 [DEBUG]  [cassandra_node_08]: Connecting to SSH
May02 18:55:54 [DEBUG]  [cassandra_node_08]: connected in 0 sec. Running SSH command
May02 18:56:57 [DEBUG]  [cassandra_node_08]: SSH command took 63 sec
May02 18:56:57 [DEBUG]  [cassandra_node_08]: command returned:

 	$:  CTOOL: Killing CassandraDaemon ()
	$:  Removing cassandra files and logs
	$:  Removing ganglia rrds
	$:  CTOOL: Done configuring
	$:  Starting casandra service, ganglia-monitor
	$:  Stopping Ganglia Monitor Daemon: gmond.
	$:  Starting Ganglia Monitor Daemon: gmond.
	$:  Attempting to create ycsb keyspace
	$:  kill: usage: kill [-s sigspec | -n signum | -sigspec] pid | jobspec ... or kill -l [sigspec]
	$:  rm: cannot remove `/var/log/cassandra/system.log': No such file or directory
	$:  rm: cannot remove `/var/log/cassandra/system.log': No such file or directory
	$:  


May02 18:56:57 [DEBUG]  [cassandra_node_08]: command returned:
	$:  CTOOL: Killing CassandraDaemon ()
	$:  Removing cassandra files and logs
	$:  Removing ganglia rrds
	$:  CTOOL: Done configuring
	$:  Starting casandra service, ganglia-monitor
	$:  Stopping Ganglia Monitor Daemon: gmond.
	$:  Starting Ganglia Monitor Daemon: gmond.
	$:  Attempting to create ycsb keyspace
	$:  kill: usage: kill [-s sigspec | -n signum | -sigspec] pid | jobspec ... or kill -l [sigspec]
	$:  rm: cannot remove `/var/log/cassandra/system.log': No such file or directory
	$:  rm: cannot remove `/var/log/cassandra/system.log': No such file or directory
	$:  
May02 18:56:57 [ INFO]  [cassandra_node_08]: is now bootstrapped (took 63 sec)
May02 18:57:03 [DEBUG]  [cassandra_node_08]: running SSH command:

     sed -i "/.*cassandra.*/g" /etc/hosts; sed -i "/^$/d" /etc/hosts


May02 18:57:03 [DEBUG]  [cassandra_node_08]: Connecting to SSH
May02 18:57:03 [DEBUG]  [cassandra_node_08]: connected in 0 sec. Running SSH command
May02 18:57:03 [DEBUG]  [cassandra_node_08]: SSH command took 0 sec
May02 18:57:03 [DEBUG]  [cassandra_node_08]: command returned:

 	$:  


May02 18:57:03 [DEBUG]  [cassandra_node_08]: running SSH command:

     echo '
     10.0.0.35 cassandra_seednode
     10.0.0.35 cassandra_seed_0
     10.0.0.13 cassandra_node_08
     10.0.0.31 cassandra_node_01
     10.0.0.11 cassandra_node_03
     10.0.0.38 cassandra_node_02
     10.0.0.16 cassandra_node_05
     10.0.0.45 cassandra_node_04
     10.0.0.37 cassandra_node_07
     10.0.0.44 cassandra_node_06' >> /etc/hosts; echo cassandra_node_08 >/etc/hostname


May02 18:57:03 [DEBUG]  [cassandra_node_08]: Connecting to SSH
May02 18:57:03 [DEBUG]  [cassandra_node_08]: connected in 0 sec. Running SSH command
May02 18:57:03 [DEBUG]  [cassandra_node_08]: SSH command took 0 sec
May02 18:57:03 [DEBUG]  [cassandra_node_08]: command returned:

 	$:  


May02 19:00:09 [DEBUG]  [cassandra_node_08]: cluster = cassandra
May02 19:00:25 [DEBUG]  [cassandra_node_08]: cluster = cassandra
May02 19:00:38 [DEBUG]  [cassandra_node_08]: cluster = cassandra
May02 19:02:52 [DEBUG]  [cassandra_node_08]: running SSH command:

     sed -i "/.*cassandra.*/g" /etc/hosts; sed -i "/^$/d" /etc/hosts


May02 19:02:52 [DEBUG]  [cassandra_node_08]: Connecting to SSH
May02 19:02:52 [DEBUG]  [cassandra_node_08]: connected in 0 sec. Running SSH command
May02 19:02:52 [DEBUG]  [cassandra_node_08]: SSH command took 0 sec
May02 19:02:52 [DEBUG]  [cassandra_node_08]: command returned:

 	$:  


May02 19:02:52 [DEBUG]  [cassandra_node_08]: running SSH command:

     echo '
     10.0.0.35 cassandra_seednode
     10.0.0.35 cassandra_seed_0
     10.0.0.17 cassandra_node_09
     10.0.0.13 cassandra_node_08
     10.0.0.31 cassandra_node_01
     10.0.0.11 cassandra_node_03
     10.0.0.38 cassandra_node_02
     10.0.0.16 cassandra_node_05
     10.0.0.45 cassandra_node_04
     10.0.0.37 cassandra_node_07
     10.0.0.44 cassandra_node_06' >> /etc/hosts; echo cassandra_node_08 >/etc/hostname


May02 19:02:52 [DEBUG]  [cassandra_node_08]: Connecting to SSH
May02 19:02:52 [DEBUG]  [cassandra_node_08]: connected in 0 sec. Running SSH command
May02 19:02:52 [DEBUG]  [cassandra_node_08]: SSH command took 0 sec
May02 19:02:52 [DEBUG]  [cassandra_node_08]: command returned:

 	$:  


May02 19:06:54 [DEBUG]  [cassandra_node_08]: cluster = cassandra
May02 19:07:14 [DEBUG]  [cassandra_node_08]: cluster = cassandra
May02 19:07:28 [DEBUG]  [cassandra_node_08]: cluster = cassandra
May02 19:12:31 [DEBUG]  [cassandra_node_08]: cluster = cassandra
May02 19:12:47 [DEBUG]  [cassandra_node_08]: cluster = cassandra
May02 19:13:00 [DEBUG]  [cassandra_node_08]: cluster = cassandra
May02 19:13:33 [DEBUG]  [cassandra_node_08]: cluster = cassandra
May02 19:13:49 [DEBUG]  [cassandra_node_08]: cluster = cassandra
May02 19:14:02 [DEBUG]  [cassandra_node_08]: cluster = cassandra
May02 19:15:51 [DEBUG]  [cassandra_node_08]: cluster = cassandra
May02 19:16:09 [DEBUG]  [cassandra_node_08]: cluster = cassandra
May02 19:16:23 [DEBUG]  [cassandra_node_08]: cluster = cassandra
May02 19:18:33 [DEBUG]  [cassandra_node_08]: running SSH command:

     sed -i "/.*cassandra.*/g" /etc/hosts; sed -i "/^$/d" /etc/hosts


May02 19:18:33 [DEBUG]  [cassandra_node_08]: Connecting to SSH
May02 19:18:33 [DEBUG]  [cassandra_node_08]: connected in 0 sec. Running SSH command
May02 19:18:33 [DEBUG]  [cassandra_node_08]: SSH command took 0 sec
May02 19:18:33 [DEBUG]  [cassandra_node_08]: command returned:

 	$:  


May02 19:18:33 [DEBUG]  [cassandra_node_08]: running SSH command:

     echo '
     10.0.0.35 cassandra_seednode
     10.0.0.30 cassandra_node_10
     10.0.0.35 cassandra_seed_0
     10.0.0.17 cassandra_node_09
     10.0.0.13 cassandra_node_08
     10.0.0.31 cassandra_node_01
     10.0.0.11 cassandra_node_03
     10.0.0.38 cassandra_node_02
     10.0.0.16 cassandra_node_05
     10.0.0.45 cassandra_node_04
     10.0.0.37 cassandra_node_07
     10.0.0.44 cassandra_node_06' >> /etc/hosts; echo cassandra_node_08 >/etc/hostname


May02 19:18:33 [DEBUG]  [cassandra_node_08]: Connecting to SSH
May02 19:18:33 [DEBUG]  [cassandra_node_08]: connected in 0 sec. Running SSH command
May02 19:18:33 [DEBUG]  [cassandra_node_08]: SSH command took 0 sec
May02 19:18:33 [DEBUG]  [cassandra_node_08]: command returned:

 	$:  


May02 19:22:09 [DEBUG]  [cassandra_node_08]: cluster = cassandra
May02 19:22:09 [ INFO]  [cassandra_node_08]: running kill script
May02 19:22:09 [DEBUG]  [cassandra_node_08]: running SSH command:

     #!/bin/sh
     CAS_PID=$(jps | grep CassandraDaemon | awk  '{print $1}')
     echo "CTOOL: Killing CassandraDaemon ($CAS_PID)"
     kill -9 $CAS_PID &>/dev/null
     ## maybe problematic
     killall java
     
     
     
     ################ debug #################3
     echo "Removing cassandra files and logs" &>>ctool.log
     #cleaning cassandra files
     rm -rf /var/lib/cassandra/* &>>ctool.log
     rm /var/log/cassandra/system.log &>>ctool.log
     #cleaning ctool rrds
     echo "Removing ganglia rrds" &>>ctool.log
     rm -rf /var/lib/ganglia/rrds/* &>>ctool.log
     
     
     
     
     
     echo '
     
     ############  KILLED  ##############' >> ycsb_run.log
     
     #report not alive
     gmetric -n alive -v 0 -t int32 -u nodes -d 10000
     


May02 19:22:09 [DEBUG]  [cassandra_node_08]: Connecting to SSH
May02 19:22:10 [DEBUG]  [cassandra_node_08]: connected in 0 sec. Running SSH command
May02 19:22:10 [DEBUG]  [cassandra_node_08]: SSH command took 0 sec
May02 19:22:10 [DEBUG]  [cassandra_node_08]: command returned:

 	$:  CTOOL: Killing CassandraDaemon (21643)
	$:  


May02 19:22:26 [DEBUG]  [cassandra_node_08]: cluster = cassandra
May02 19:22:44 [DEBUG]  [cassandra_node_08]: cluster = cassandra
May02 19:29:55 [DEBUG]  [cassandra_node_08]: cluster = cassandra
May02 19:30:08 [DEBUG]  [cassandra_node_08]: cluster = cassandra
May02 20:40:06 [DEBUG]  [cassandra_node_08]: cluster = cassandra
May02 20:40:19 [DEBUG]  [cassandra_node_08]: cluster = cassandra
May02 20:40:33 [DEBUG]  [cassandra_node_08]: cluster = cassandra
May02 20:40:33 [ INFO]  [cassandra_node_08]: running kill script
May02 20:40:33 [DEBUG]  [cassandra_node_08]: running SSH command:

     #!/bin/sh
     CAS_PID=$(jps | grep CassandraDaemon | awk  '{print $1}')
     echo "CTOOL: Killing CassandraDaemon ($CAS_PID)"
     kill -9 $CAS_PID &>/dev/null
     ## maybe problematic
     killall java
     
     
     
     ################ debug #################3
     echo "Removing cassandra files and logs" &>>ctool.log
     #cleaning cassandra files
     rm -rf /var/lib/cassandra/* &>>ctool.log
     rm /var/log/cassandra/system.log &>>ctool.log
     #cleaning ctool rrds
     echo "Removing ganglia rrds" &>>ctool.log
     rm -rf /var/lib/ganglia/rrds/* &>>ctool.log
     
     
     
     
     
     echo '
     
     ############  KILLED  ##############' >> ycsb_run.log
     
     #report not alive
     gmetric -n alive -v 0 -t int32 -u nodes -d 10000
     


May02 20:40:33 [DEBUG]  [cassandra_node_08]: Connecting to SSH
May02 20:40:33 [DEBUG]  [cassandra_node_08]: connected in 0 sec. Running SSH command
May02 20:40:34 [DEBUG]  [cassandra_node_08]: SSH command took 0 sec
May02 20:40:34 [DEBUG]  [cassandra_node_08]: command returned:

 	$:  CTOOL: Killing CassandraDaemon ()
	$:  java: no process found
	$:  


May02 20:40:51 [DEBUG]  [cassandra_node_08]: cluster = cassandra
May02 20:41:07 [DEBUG]  [cassandra_node_08]: cluster = cassandra
May02 20:48:33 [DEBUG]  [cassandra_node_08]: cluster = cassandra
May02 20:48:47 [DEBUG]  [cassandra_node_08]: cluster = cassandra
May02 21:25:46 [DEBUG]  [cassandra_node_08]: cluster = cassandra
May02 21:26:00 [DEBUG]  [cassandra_node_08]: cluster = cassandra
May03 12:02:30 [DEBUG]  [cassandra_node_08]: cluster = cassandra
May03 12:02:47 [DEBUG]  [cassandra_node_08]: cluster = cassandra
May03 12:03:01 [DEBUG]  [cassandra_node_08]: cluster = cassandra
May03 12:05:11 [DEBUG]  [cassandra_node_08]: cluster = cassandra
May03 12:05:24 [DEBUG]  [cassandra_node_08]: cluster = cassandra
May03 12:06:25 [ INFO]  [cassandra_node_08]: Waiting for SSH daemon (83.212.118.12)
May03 12:06:25 [DEBUG]  [cassandra_node_08]: end time:2014-05-03 12:16:25.414868
May03 12:06:25 [DEBUG]  [cassandra_node_08]: ssh attempt:1
May03 12:06:25 [DEBUG]  [cassandra_node_08]: Connecting to SSH
May03 12:06:25 [DEBUG]  [cassandra_node_08]: connected in 0 sec. Running SSH command
May03 12:06:25 [DEBUG]  [cassandra_node_08]: SSH command took 0 sec
May03 12:06:25 [ INFO]  [cassandra_node_08]: now ready (took 0 sec)
May03 12:06:25 [DEBUG]  [cassandra_node_08]: running SSH command:

     sed -i "/.*cassandra.*/g" /etc/hosts; sed -i "/^$/d" /etc/hosts


May03 12:06:25 [DEBUG]  [cassandra_node_08]: Connecting to SSH
May03 12:06:25 [DEBUG]  [cassandra_node_08]: connected in 0 sec. Running SSH command
May03 12:06:25 [DEBUG]  [cassandra_node_08]: SSH command took 0 sec
May03 12:06:25 [DEBUG]  [cassandra_node_08]: command returned:

 	$:  


May03 12:06:25 [DEBUG]  [cassandra_node_08]: running SSH command:

     echo '
     10.0.0.35 cassandra_seednode
     10.0.0.35 cassandra_seed_0
     10.0.0.13 cassandra_node_08
     10.0.0.31 cassandra_node_01
     10.0.0.11 cassandra_node_03
     10.0.0.38 cassandra_node_02
     10.0.0.16 cassandra_node_05
     10.0.0.45 cassandra_node_04
     10.0.0.37 cassandra_node_07
     10.0.0.44 cassandra_node_06' >> /etc/hosts; echo cassandra_node_08 >/etc/hostname


May03 12:06:25 [DEBUG]  [cassandra_node_08]: Connecting to SSH
May03 12:06:25 [DEBUG]  [cassandra_node_08]: connected in 0 sec. Running SSH command
May03 12:06:25 [DEBUG]  [cassandra_node_08]: SSH command took 0 sec
May03 12:06:25 [DEBUG]  [cassandra_node_08]: command returned:

 	$:  


May03 12:06:25 [ INFO]  [cassandra_node_08]: running bootstrap script
May03 12:06:25 [DEBUG]  [cassandra_node_08]: running SSH command:

     #!/bin/bash
     
     MAX_WAIT=300  #5 min
     
     echo "started bootstrap" > bootsrap.log
     
     # check the seednode
     if ! ping -q -c 1 cassandra_seednode &>/dev/null   ;
     then
     echo CTOOL: ERROR - cassandra_seednode not pingable, exiting
     exit -1
     fi
     
     # kill the cassandra process
     CAS_PID=$(jps | grep CassandraDaemon | awk  '{print $1}')
     echo "CTOOL: Killing CassandraDaemon ($CAS_PID)"
     kill -9 $CAS_PID
     
     # clean previous files and logs
     echo "Removing cassandra files and logs"
     #cleaning cassandra files
     rm -rf /var/lib/cassandra/*
     rm /var/log/cassandra/system.log
     #cleaning ctool rrds
     echo "Removing ganglia rrds"
     rm -rf /var/lib/ganglia/rrds/*
     rm /var/log/cassandra/system.log
     
     # find my IP
     my_priv_addr=""
     #look for an IPv4 interface in range 10.0 and use that for the cassandra communication
     let if_count=($(ifconfig | grep eth | wc -l ))-1
     for i in $(seq 0 $if_count)
     do	#look for IPv4 address
     line=$(ifconfig eth$i | grep "inet addr:")
     line=$(echo $line | awk '{print $2}')
     address=$(echo $line | sed 's/addr://g')
     if [[ "$address" == 10.0.* ]] ;
     then
     my_priv_addr=$address
     break
     fi
     done
     
     # configure cassandra
     echo "configuring cassandra.yaml for my address:$my_priv_addr" >> ctool.log
     #change the listen address of this node
     sed "s/listen_address: .*/listen_address: $my_priv_addr/g"  /etc/cassandra/cassandra.yaml> tmp && mv tmp /etc/cassandra/cassandra.yaml
     #change the rpc_address of this node to 0.0.0.0
     sed "s/rpc_address: .*/rpc_address: 0.0.0.0/g"  /etc/cassandra/cassandra.yaml> tmp && mv tmp /etc/cassandra/cassandra.yaml
     #change the seeds to "cassandra_seednode"
     sed "s/seeds: .*/seeds: \"cassandra_seednode\"/g"  /etc/cassandra/cassandra.yaml> tmp && mv tmp /etc/cassandra/cassandra.yaml
     #add the jmx server whatever to cassandra-env.sh
     sed -i.bak "s/.*-Djava.rmi.server.hostname=.*/JVM_OPTS=\"\$JVM_OPTS -Djava.rmi.server.hostname=$my_priv_addr\"/g"  /etc/cassandra/cassandra-env.sh
     sed -i.bak "s/*JVM_OPTS=\"\$JVM_OPTS -Djava.rmi.server.hostname=*\"/JVM_OPTS=\"\$JVM_OPTS -Djava.rmi.server.hostname=$my_priv_addr\"/g"  /etc/cassandra/cassandra-env.sh
     #make sure no requests are dropped by using a big timeout
     sed -i.bak "s/read_request_timeout_in_ms:.*/read_request_timeout_in_ms: 50000/g" /etc/cassandra/cassandra.yaml
     sed -i.bak "s/write_request_timeout_in_ms:.*/write_request_timeout_in_ms: 50000/g" /etc/cassandra/cassandra.yaml
     echo "CTOOL: Done configuring"
     
     
     # start cassandra
     chmod -R o+rw /var/lib/cassandra
     echo Starting casandra service, ganglia-monitor
     service cassandra start
     service ganglia-monitor restart
     
     #wait until ready and try to create keyspace
     echo "Attempting to create ycsb keyspace"
     echo "create keyspace ycsb  WITH REPLICATION = {'class' : 'SimpleStrategy', 'replication_factor': 1 }; use ycsb;  create table usertable (y_id varchar primary key, field0 varchar, field1 varchar, field2 varchar, field3 varchar, field4 varchar, field5 varchar, field6 varchar, field7 varchar, field8 varchar, field9 varchar);" > ycsb_cql.temp
     while ! cqlsh < ycsb_cql.temp 2>/dev/null;do sleep 2; done
     rm ycsb_cql.temp
     
     echo "ended bootstrap" >> bootsrap.log
     
     #report alive in gmetric
     gmetric -n alive -v 1 -t int32 -u nodes -d 10000
     
     
     


May03 12:06:25 [DEBUG]  [cassandra_node_08]: Connecting to SSH
May03 12:06:26 [DEBUG]  [cassandra_node_08]: connected in 0 sec. Running SSH command
May03 12:08:43 [DEBUG]  [cassandra_node_08]: SSH command took 137 sec
May03 12:08:43 [DEBUG]  [cassandra_node_08]: command returned:

 	$:  CTOOL: Killing CassandraDaemon ()
	$:  Removing cassandra files and logs
	$:  Removing ganglia rrds
	$:  CTOOL: Done configuring
	$:  Starting casandra service, ganglia-monitor
	$:  Stopping Ganglia Monitor Daemon: gmond.
	$:  Starting Ganglia Monitor Daemon: gmond.
	$:  Attempting to create ycsb keyspace
	$:  kill: usage: kill [-s sigspec | -n signum | -sigspec] pid | jobspec ... or kill -l [sigspec]
	$:  rm: cannot remove `/var/log/cassandra/system.log': No such file or directory
	$:  rm: cannot remove `/var/log/cassandra/system.log': No such file or directory
	$:  


May03 12:08:43 [DEBUG]  [cassandra_node_08]: command returned:
	$:  CTOOL: Killing CassandraDaemon ()
	$:  Removing cassandra files and logs
	$:  Removing ganglia rrds
	$:  CTOOL: Done configuring
	$:  Starting casandra service, ganglia-monitor
	$:  Stopping Ganglia Monitor Daemon: gmond.
	$:  Starting Ganglia Monitor Daemon: gmond.
	$:  Attempting to create ycsb keyspace
	$:  kill: usage: kill [-s sigspec | -n signum | -sigspec] pid | jobspec ... or kill -l [sigspec]
	$:  rm: cannot remove `/var/log/cassandra/system.log': No such file or directory
	$:  rm: cannot remove `/var/log/cassandra/system.log': No such file or directory
	$:  
May03 12:08:43 [ INFO]  [cassandra_node_08]: is now bootstrapped (took 137 sec)
May03 12:08:54 [DEBUG]  [cassandra_node_08]: running SSH command:

     sed -i "/.*cassandra.*/g" /etc/hosts; sed -i "/^$/d" /etc/hosts


May03 12:08:54 [DEBUG]  [cassandra_node_08]: Connecting to SSH
May03 12:08:55 [DEBUG]  [cassandra_node_08]: connected in 1 sec. Running SSH command
May03 12:08:56 [DEBUG]  [cassandra_node_08]: SSH command took 1 sec
May03 12:08:56 [DEBUG]  [cassandra_node_08]: command returned:

 	$:  


May03 12:08:56 [DEBUG]  [cassandra_node_08]: running SSH command:

     echo '
     10.0.0.35 cassandra_seednode
     10.0.0.35 cassandra_seed_0
     10.0.0.13 cassandra_node_08
     10.0.0.31 cassandra_node_01
     10.0.0.11 cassandra_node_03
     10.0.0.38 cassandra_node_02
     10.0.0.16 cassandra_node_05
     10.0.0.45 cassandra_node_04
     10.0.0.37 cassandra_node_07
     10.0.0.44 cassandra_node_06' >> /etc/hosts; echo cassandra_node_08 >/etc/hostname


May03 12:08:56 [DEBUG]  [cassandra_node_08]: Connecting to SSH
May03 12:08:57 [DEBUG]  [cassandra_node_08]: connected in 0 sec. Running SSH command
May03 12:08:58 [DEBUG]  [cassandra_node_08]: SSH command took 0 sec
May03 12:08:58 [DEBUG]  [cassandra_node_08]: command returned:

 	$:  


May03 12:11:00 [DEBUG]  [cassandra_node_08]: cluster = cassandra
May03 12:11:00 [ INFO]  [cassandra_node_08]: running decommission script
May03 12:11:00 [DEBUG]  [cassandra_node_08]: running SSH command:

     #!/bin/sh
     nodetool repair -h 127.0.0.1 ycsb
     nodetool decommission
     #kill cassandra
     CAS_PID=$(jps | grep CassandraDaemon | awk  '{print $1}')
     echo "CTOOL: Killing CassandraDaemon ($CAS_PID)" >> ctool.log
     kill $CAS_PID &>/dev/null
     
     
     #report not alive
     gmetric -n alive -v 0 -t int32 -u nodes -d 10000
     


May03 12:11:00 [DEBUG]  [cassandra_node_08]: Connecting to SSH
May03 12:11:00 [DEBUG]  [cassandra_node_08]: connected in 0 sec. Running SSH command
May03 12:13:29 [DEBUG]  [cassandra_node_08]: SSH command took 148 sec
May03 12:13:29 [DEBUG]  [cassandra_node_08]: command returned:

 	$:  [2014-05-03 12:11:07,282] Starting repair command #1, repairing 256 ranges for keyspace ycsb
	$:  [2014-05-03 12:11:10,441] Repair command #1 finished
	$:  


May03 12:13:29 [ INFO]  [cassandra_node_08]: now decommissioned (took 149 sec)
May03 12:30:44 [DEBUG]  [cassandra_node_08]: cluster = cassandra
May03 12:31:12 [DEBUG]  [cassandra_node_08]: cluster = cassandra
May03 12:31:26 [DEBUG]  [cassandra_node_08]: cluster = cassandra
May03 12:35:18 [DEBUG]  [cassandra_node_08]: cluster = cassandra
May03 12:38:18 [DEBUG]  [cassandra_node_08]: cluster = cassandra
May03 12:38:31 [DEBUG]  [cassandra_node_08]: cluster = cassandra
May03 13:38:36 [ INFO]  [cassandra_node_08]: Waiting for SSH daemon (83.212.118.12)
May03 13:38:36 [DEBUG]  [cassandra_node_08]: end time:2014-05-03 13:48:36.953277
May03 13:38:36 [DEBUG]  [cassandra_node_08]: ssh attempt:1
May03 13:38:36 [DEBUG]  [cassandra_node_08]: Connecting to SSH
May03 13:38:37 [DEBUG]  [cassandra_node_08]: connected in 0 sec. Running SSH command
May03 13:38:37 [DEBUG]  [cassandra_node_08]: SSH command took 0 sec
May03 13:38:37 [ INFO]  [cassandra_node_08]: now ready (took 0 sec)
May03 13:38:37 [DEBUG]  [cassandra_node_08]: running SSH command:

     sed -i "/.*cassandra.*/g" /etc/hosts; sed -i "/^$/d" /etc/hosts


May03 13:38:37 [DEBUG]  [cassandra_node_08]: Connecting to SSH
May03 13:38:37 [DEBUG]  [cassandra_node_08]: connected in 0 sec. Running SSH command
May03 13:38:37 [DEBUG]  [cassandra_node_08]: SSH command took 0 sec
May03 13:38:37 [DEBUG]  [cassandra_node_08]: command returned:

 	$:  


May03 13:38:37 [DEBUG]  [cassandra_node_08]: running SSH command:

     echo '
     10.0.0.35 cassandra_seednode
     10.0.0.35 cassandra_seed_0
     10.0.0.13 cassandra_node_08
     10.0.0.31 cassandra_node_01
     10.0.0.11 cassandra_node_03
     10.0.0.38 cassandra_node_02
     10.0.0.16 cassandra_node_05
     10.0.0.45 cassandra_node_04
     10.0.0.37 cassandra_node_07
     10.0.0.44 cassandra_node_06' >> /etc/hosts; echo cassandra_node_08 >/etc/hostname


May03 13:38:37 [DEBUG]  [cassandra_node_08]: Connecting to SSH
May03 13:38:37 [DEBUG]  [cassandra_node_08]: connected in 0 sec. Running SSH command
May03 13:38:37 [DEBUG]  [cassandra_node_08]: SSH command took 0 sec
May03 13:38:37 [DEBUG]  [cassandra_node_08]: command returned:

 	$:  


May03 13:38:37 [ INFO]  [cassandra_node_08]: running bootstrap script
May03 13:38:37 [DEBUG]  [cassandra_node_08]: running SSH command:

     #!/bin/bash
     
     MAX_WAIT=300  #5 min
     
     echo "started bootstrap" > bootsrap.log
     
     # check the seednode
     if ! ping -q -c 1 cassandra_seednode &>/dev/null   ;
     then
     echo CTOOL: ERROR - cassandra_seednode not pingable, exiting
     exit -1
     fi
     
     # kill the cassandra process
     CAS_PID=$(jps | grep CassandraDaemon | awk  '{print $1}')
     echo "CTOOL: Killing CassandraDaemon ($CAS_PID)"
     kill -9 $CAS_PID
     
     # clean previous files and logs
     echo "Removing cassandra files and logs"
     #cleaning cassandra files
     rm -rf /var/lib/cassandra/*
     rm /var/log/cassandra/system.log
     #cleaning ctool rrds
     echo "Removing ganglia rrds"
     rm -rf /var/lib/ganglia/rrds/*
     rm /var/log/cassandra/system.log
     
     # find my IP
     my_priv_addr=""
     #look for an IPv4 interface in range 10.0 and use that for the cassandra communication
     let if_count=($(ifconfig | grep eth | wc -l ))-1
     for i in $(seq 0 $if_count)
     do	#look for IPv4 address
     line=$(ifconfig eth$i | grep "inet addr:")
     line=$(echo $line | awk '{print $2}')
     address=$(echo $line | sed 's/addr://g')
     if [[ "$address" == 10.0.* ]] ;
     then
     my_priv_addr=$address
     break
     fi
     done
     
     # configure cassandra
     echo "configuring cassandra.yaml for my address:$my_priv_addr" >> ctool.log
     #change the listen address of this node
     sed "s/listen_address: .*/listen_address: $my_priv_addr/g"  /etc/cassandra/cassandra.yaml> tmp && mv tmp /etc/cassandra/cassandra.yaml
     #change the rpc_address of this node to 0.0.0.0
     sed "s/rpc_address: .*/rpc_address: 0.0.0.0/g"  /etc/cassandra/cassandra.yaml> tmp && mv tmp /etc/cassandra/cassandra.yaml
     #change the seeds to "cassandra_seednode"
     sed "s/seeds: .*/seeds: \"cassandra_seednode\"/g"  /etc/cassandra/cassandra.yaml> tmp && mv tmp /etc/cassandra/cassandra.yaml
     #add the jmx server whatever to cassandra-env.sh
     sed -i.bak "s/.*-Djava.rmi.server.hostname=.*/JVM_OPTS=\"\$JVM_OPTS -Djava.rmi.server.hostname=$my_priv_addr\"/g"  /etc/cassandra/cassandra-env.sh
     sed -i.bak "s/*JVM_OPTS=\"\$JVM_OPTS -Djava.rmi.server.hostname=*\"/JVM_OPTS=\"\$JVM_OPTS -Djava.rmi.server.hostname=$my_priv_addr\"/g"  /etc/cassandra/cassandra-env.sh
     #make sure no requests are dropped by using a big timeout
     sed -i.bak "s/read_request_timeout_in_ms:.*/read_request_timeout_in_ms: 50000/g" /etc/cassandra/cassandra.yaml
     sed -i.bak "s/write_request_timeout_in_ms:.*/write_request_timeout_in_ms: 50000/g" /etc/cassandra/cassandra.yaml
     echo "CTOOL: Done configuring"
     
     
     # start cassandra
     chmod -R o+rw /var/lib/cassandra
     echo Starting casandra service, ganglia-monitor
     service cassandra start
     service ganglia-monitor restart
     
     #wait until ready and try to create keyspace
     echo "Attempting to create ycsb keyspace"
     echo "create keyspace ycsb  WITH REPLICATION = {'class' : 'SimpleStrategy', 'replication_factor': 1 }; use ycsb;  create table usertable (y_id varchar primary key, field0 varchar, field1 varchar, field2 varchar, field3 varchar, field4 varchar, field5 varchar, field6 varchar, field7 varchar, field8 varchar, field9 varchar);" > ycsb_cql.temp
     while ! cqlsh < ycsb_cql.temp 2>/dev/null;do sleep 2; done
     rm ycsb_cql.temp
     
     echo "ended bootstrap" >> bootsrap.log
     
     #report alive in gmetric
     gmetric -n alive -v 1 -t int32 -u nodes -d 10000
     
     
     


May03 13:38:37 [DEBUG]  [cassandra_node_08]: Connecting to SSH
May03 13:38:37 [DEBUG]  [cassandra_node_08]: connected in 0 sec. Running SSH command
May03 13:40:59 [DEBUG]  [cassandra_node_08]: SSH command took 141 sec
May03 13:40:59 [DEBUG]  [cassandra_node_08]: command returned:

 	$:  CTOOL: Killing CassandraDaemon ()
	$:  Removing cassandra files and logs
	$:  Removing ganglia rrds
	$:  CTOOL: Done configuring
	$:  Starting casandra service, ganglia-monitor
	$:  Stopping Ganglia Monitor Daemon: gmond.
	$:  Starting Ganglia Monitor Daemon: gmond.
	$:  Attempting to create ycsb keyspace
	$:  kill: usage: kill [-s sigspec | -n signum | -sigspec] pid | jobspec ... or kill -l [sigspec]
	$:  rm: cannot remove `/var/log/cassandra/system.log': No such file or directory
	$:  


May03 13:40:59 [DEBUG]  [cassandra_node_08]: command returned:
	$:  CTOOL: Killing CassandraDaemon ()
	$:  Removing cassandra files and logs
	$:  Removing ganglia rrds
	$:  CTOOL: Done configuring
	$:  Starting casandra service, ganglia-monitor
	$:  Stopping Ganglia Monitor Daemon: gmond.
	$:  Starting Ganglia Monitor Daemon: gmond.
	$:  Attempting to create ycsb keyspace
	$:  kill: usage: kill [-s sigspec | -n signum | -sigspec] pid | jobspec ... or kill -l [sigspec]
	$:  rm: cannot remove `/var/log/cassandra/system.log': No such file or directory
	$:  
May03 13:40:59 [ INFO]  [cassandra_node_08]: is now bootstrapped (took 141 sec)
May03 13:41:03 [DEBUG]  [cassandra_node_08]: running SSH command:

     sed -i "/.*cassandra.*/g" /etc/hosts; sed -i "/^$/d" /etc/hosts


May03 13:41:03 [DEBUG]  [cassandra_node_08]: Connecting to SSH
May03 13:41:03 [DEBUG]  [cassandra_node_08]: connected in 0 sec. Running SSH command
May03 13:41:04 [DEBUG]  [cassandra_node_08]: SSH command took 0 sec
May03 13:41:04 [DEBUG]  [cassandra_node_08]: command returned:

 	$:  


May03 13:41:04 [DEBUG]  [cassandra_node_08]: running SSH command:

     echo '
     10.0.0.35 cassandra_seednode
     10.0.0.35 cassandra_seed_0
     10.0.0.13 cassandra_node_08
     10.0.0.31 cassandra_node_01
     10.0.0.11 cassandra_node_03
     10.0.0.38 cassandra_node_02
     10.0.0.16 cassandra_node_05
     10.0.0.45 cassandra_node_04
     10.0.0.37 cassandra_node_07
     10.0.0.44 cassandra_node_06' >> /etc/hosts; echo cassandra_node_08 >/etc/hostname


May03 13:41:04 [DEBUG]  [cassandra_node_08]: Connecting to SSH
May03 13:41:04 [DEBUG]  [cassandra_node_08]: connected in 0 sec. Running SSH command
May03 13:41:04 [DEBUG]  [cassandra_node_08]: SSH command took 0 sec
May03 13:41:04 [DEBUG]  [cassandra_node_08]: command returned:

 	$:  


May03 22:31:29 [DEBUG]  [cassandra_node_08]: cluster = cassandra
May03 22:31:29 [ INFO]  [cassandra_node_08]: running kill script
May03 22:31:29 [DEBUG]  [cassandra_node_08]: running SSH command:

     #!/bin/sh
     CAS_PID=$(jps | grep CassandraDaemon | awk  '{print $1}')
     echo "CTOOL: Killing CassandraDaemon ($CAS_PID)"
     kill -9 $CAS_PID &>/dev/null
     ## maybe problematic
     killall java
     
     
     
     ################ debug #################3
     echo "Removing cassandra files and logs" &>>ctool.log
     #cleaning cassandra files
     rm -rf /var/lib/cassandra/* &>>ctool.log
     rm /var/log/cassandra/system.log &>>ctool.log
     #cleaning ctool rrds
     echo "Removing ganglia rrds" &>>ctool.log
     rm -rf /var/lib/ganglia/rrds/* &>>ctool.log
     
     
     
     
     
     echo '
     
     ############  KILLED  ##############' >> ycsb_run.log
     
     #report not alive
     gmetric -n alive -v 0 -t int32 -u nodes -d 10000
     


May03 22:31:29 [DEBUG]  [cassandra_node_08]: Connecting to SSH
May03 22:31:30 [DEBUG]  [cassandra_node_08]: connected in 0 sec. Running SSH command
May03 22:31:31 [DEBUG]  [cassandra_node_08]: SSH command took 1 sec
May03 22:31:31 [DEBUG]  [cassandra_node_08]: command returned:

 	$:  CTOOL: Killing CassandraDaemon (26135)
	$:  


May03 22:31:47 [DEBUG]  [cassandra_node_08]: cluster = cassandra
May03 22:32:11 [DEBUG]  [cassandra_node_08]: cluster = cassandra
May03 22:39:33 [DEBUG]  [cassandra_node_08]: cluster = cassandra
May03 22:39:47 [DEBUG]  [cassandra_node_08]: cluster = cassandra
May03 23:16:08 [DEBUG]  [cassandra_node_08]: cluster = cassandra
May03 23:16:22 [DEBUG]  [cassandra_node_08]: cluster = cassandra
May04 00:16:28 [ INFO]  [cassandra_node_08]: Waiting for SSH daemon (83.212.118.12)
May04 00:16:28 [DEBUG]  [cassandra_node_08]: end time:2014-05-04 00:26:28.780588
May04 00:16:28 [DEBUG]  [cassandra_node_08]: ssh attempt:1
May04 00:16:28 [DEBUG]  [cassandra_node_08]: Connecting to SSH
May04 00:16:28 [DEBUG]  [cassandra_node_08]: connected in 0 sec. Running SSH command
May04 00:16:28 [DEBUG]  [cassandra_node_08]: SSH command took 0 sec
May04 00:16:28 [ INFO]  [cassandra_node_08]: now ready (took 0 sec)
May04 00:16:28 [DEBUG]  [cassandra_node_08]: running SSH command:

     sed -i "/.*cassandra.*/g" /etc/hosts; sed -i "/^$/d" /etc/hosts


May04 00:16:28 [DEBUG]  [cassandra_node_08]: Connecting to SSH
May04 00:16:29 [DEBUG]  [cassandra_node_08]: connected in 0 sec. Running SSH command
May04 00:16:29 [DEBUG]  [cassandra_node_08]: SSH command took 0 sec
May04 00:16:29 [DEBUG]  [cassandra_node_08]: command returned:

 	$:  


May04 00:16:29 [DEBUG]  [cassandra_node_08]: running SSH command:

     echo '
     10.0.0.35 cassandra_seednode
     10.0.0.35 cassandra_seed_0
     10.0.0.13 cassandra_node_08
     10.0.0.31 cassandra_node_01
     10.0.0.11 cassandra_node_03
     10.0.0.38 cassandra_node_02
     10.0.0.16 cassandra_node_05
     10.0.0.45 cassandra_node_04
     10.0.0.37 cassandra_node_07
     10.0.0.44 cassandra_node_06' >> /etc/hosts; echo cassandra_node_08 >/etc/hostname


May04 00:16:29 [DEBUG]  [cassandra_node_08]: Connecting to SSH
May04 00:16:29 [DEBUG]  [cassandra_node_08]: connected in 0 sec. Running SSH command
May04 00:16:29 [DEBUG]  [cassandra_node_08]: SSH command took 0 sec
May04 00:16:29 [DEBUG]  [cassandra_node_08]: command returned:

 	$:  


May04 00:16:29 [ INFO]  [cassandra_node_08]: running bootstrap script
May04 00:16:29 [DEBUG]  [cassandra_node_08]: running SSH command:

     #!/bin/bash
     
     MAX_WAIT=300  #5 min
     
     echo "started bootstrap" > bootsrap.log
     
     # check the seednode
     if ! ping -q -c 1 cassandra_seednode &>/dev/null   ;
     then
     echo CTOOL: ERROR - cassandra_seednode not pingable, exiting
     exit -1
     fi
     
     # kill the cassandra process
     CAS_PID=$(jps | grep CassandraDaemon | awk  '{print $1}')
     echo "CTOOL: Killing CassandraDaemon ($CAS_PID)"
     kill -9 $CAS_PID
     
     # clean previous files and logs
     echo "Removing cassandra files and logs"
     #cleaning cassandra files
     rm -rf /var/lib/cassandra/*
     rm /var/log/cassandra/system.log
     #cleaning ctool rrds
     echo "Removing ganglia rrds"
     rm -rf /var/lib/ganglia/rrds/*
     rm /var/log/cassandra/system.log
     
     # find my IP
     my_priv_addr=""
     #look for an IPv4 interface in range 10.0 and use that for the cassandra communication
     let if_count=($(ifconfig | grep eth | wc -l ))-1
     for i in $(seq 0 $if_count)
     do	#look for IPv4 address
     line=$(ifconfig eth$i | grep "inet addr:")
     line=$(echo $line | awk '{print $2}')
     address=$(echo $line | sed 's/addr://g')
     if [[ "$address" == 10.0.* ]] ;
     then
     my_priv_addr=$address
     break
     fi
     done
     
     # configure cassandra
     echo "configuring cassandra.yaml for my address:$my_priv_addr" >> ctool.log
     #change the listen address of this node
     sed "s/listen_address: .*/listen_address: $my_priv_addr/g"  /etc/cassandra/cassandra.yaml> tmp && mv tmp /etc/cassandra/cassandra.yaml
     #change the rpc_address of this node to 0.0.0.0
     sed "s/rpc_address: .*/rpc_address: 0.0.0.0/g"  /etc/cassandra/cassandra.yaml> tmp && mv tmp /etc/cassandra/cassandra.yaml
     #change the seeds to "cassandra_seednode"
     sed "s/seeds: .*/seeds: \"cassandra_seednode\"/g"  /etc/cassandra/cassandra.yaml> tmp && mv tmp /etc/cassandra/cassandra.yaml
     #add the jmx server whatever to cassandra-env.sh
     sed -i.bak "s/.*-Djava.rmi.server.hostname=.*/JVM_OPTS=\"\$JVM_OPTS -Djava.rmi.server.hostname=$my_priv_addr\"/g"  /etc/cassandra/cassandra-env.sh
     sed -i.bak "s/*JVM_OPTS=\"\$JVM_OPTS -Djava.rmi.server.hostname=*\"/JVM_OPTS=\"\$JVM_OPTS -Djava.rmi.server.hostname=$my_priv_addr\"/g"  /etc/cassandra/cassandra-env.sh
     #make sure no requests are dropped by using a big timeout
     sed -i.bak "s/read_request_timeout_in_ms:.*/read_request_timeout_in_ms: 50000/g" /etc/cassandra/cassandra.yaml
     sed -i.bak "s/write_request_timeout_in_ms:.*/write_request_timeout_in_ms: 50000/g" /etc/cassandra/cassandra.yaml
     echo "CTOOL: Done configuring"
     
     
     # start cassandra
     chmod -R o+rw /var/lib/cassandra
     echo Starting casandra service, ganglia-monitor
     service cassandra start
     service ganglia-monitor restart
     
     #wait until ready and try to create keyspace
     echo "Attempting to create ycsb keyspace"
     echo "create keyspace ycsb  WITH REPLICATION = {'class' : 'SimpleStrategy', 'replication_factor': 1 }; use ycsb;  create table usertable (y_id varchar primary key, field0 varchar, field1 varchar, field2 varchar, field3 varchar, field4 varchar, field5 varchar, field6 varchar, field7 varchar, field8 varchar, field9 varchar);" > ycsb_cql.temp
     while ! cqlsh < ycsb_cql.temp 2>/dev/null;do sleep 2; done
     rm ycsb_cql.temp
     
     echo "ended bootstrap" >> bootsrap.log
     
     #report alive in gmetric
     gmetric -n alive -v 1 -t int32 -u nodes -d 10000
     
     
     


May04 00:16:29 [DEBUG]  [cassandra_node_08]: Connecting to SSH
May04 00:16:29 [DEBUG]  [cassandra_node_08]: connected in 0 sec. Running SSH command
May04 00:18:42 [DEBUG]  [cassandra_node_08]: SSH command took 133 sec
May04 00:18:42 [DEBUG]  [cassandra_node_08]: command returned:

 	$:  CTOOL: Killing CassandraDaemon ()
	$:  Removing cassandra files and logs
	$:  Removing ganglia rrds
	$:  CTOOL: Done configuring
	$:  Starting casandra service, ganglia-monitor
	$:  Stopping Ganglia Monitor Daemon: gmond.
	$:  Starting Ganglia Monitor Daemon: gmond.
	$:  Attempting to create ycsb keyspace
	$:  kill: usage: kill [-s sigspec | -n signum | -sigspec] pid | jobspec ... or kill -l [sigspec]
	$:  rm: cannot remove `/var/log/cassandra/system.log': No such file or directory
	$:  rm: cannot remove `/var/log/cassandra/system.log': No such file or directory
	$:  


May04 00:18:42 [DEBUG]  [cassandra_node_08]: command returned:
	$:  CTOOL: Killing CassandraDaemon ()
	$:  Removing cassandra files and logs
	$:  Removing ganglia rrds
	$:  CTOOL: Done configuring
	$:  Starting casandra service, ganglia-monitor
	$:  Stopping Ganglia Monitor Daemon: gmond.
	$:  Starting Ganglia Monitor Daemon: gmond.
	$:  Attempting to create ycsb keyspace
	$:  kill: usage: kill [-s sigspec | -n signum | -sigspec] pid | jobspec ... or kill -l [sigspec]
	$:  rm: cannot remove `/var/log/cassandra/system.log': No such file or directory
	$:  rm: cannot remove `/var/log/cassandra/system.log': No such file or directory
	$:  
May04 00:18:42 [ INFO]  [cassandra_node_08]: is now bootstrapped (took 133 sec)
May04 00:18:49 [DEBUG]  [cassandra_node_08]: running SSH command:

     sed -i "/.*cassandra.*/g" /etc/hosts; sed -i "/^$/d" /etc/hosts


May04 00:18:49 [DEBUG]  [cassandra_node_08]: Connecting to SSH
May04 00:18:49 [DEBUG]  [cassandra_node_08]: connected in 0 sec. Running SSH command
May04 00:18:50 [DEBUG]  [cassandra_node_08]: SSH command took 0 sec
May04 00:18:50 [DEBUG]  [cassandra_node_08]: command returned:

 	$:  


May04 00:18:50 [DEBUG]  [cassandra_node_08]: running SSH command:

     echo '
     10.0.0.35 cassandra_seednode
     10.0.0.35 cassandra_seed_0
     10.0.0.13 cassandra_node_08
     10.0.0.31 cassandra_node_01
     10.0.0.11 cassandra_node_03
     10.0.0.38 cassandra_node_02
     10.0.0.16 cassandra_node_05
     10.0.0.45 cassandra_node_04
     10.0.0.37 cassandra_node_07
     10.0.0.44 cassandra_node_06' >> /etc/hosts; echo cassandra_node_08 >/etc/hostname


May04 00:18:50 [DEBUG]  [cassandra_node_08]: Connecting to SSH
May04 00:18:50 [DEBUG]  [cassandra_node_08]: connected in 0 sec. Running SSH command
May04 00:18:50 [DEBUG]  [cassandra_node_08]: SSH command took 0 sec
May04 00:18:50 [DEBUG]  [cassandra_node_08]: command returned:

 	$:  


May04 01:21:31 [DEBUG]  [cassandra_node_08]: running SSH command:

     sed -i "/.*cassandra.*/g" /etc/hosts; sed -i "/^$/d" /etc/hosts


May04 01:21:31 [DEBUG]  [cassandra_node_08]: Connecting to SSH
May04 01:21:31 [DEBUG]  [cassandra_node_08]: connected in 0 sec. Running SSH command
May04 01:21:31 [DEBUG]  [cassandra_node_08]: SSH command took 0 sec
May04 01:21:31 [DEBUG]  [cassandra_node_08]: command returned:

 	$:  


May04 01:21:31 [DEBUG]  [cassandra_node_08]: running SSH command:

     echo '
     10.0.0.35 cassandra_seednode
     10.0.0.35 cassandra_seed_0
     10.0.0.17 cassandra_node_09
     10.0.0.13 cassandra_node_08
     10.0.0.31 cassandra_node_01
     10.0.0.11 cassandra_node_03
     10.0.0.38 cassandra_node_02
     10.0.0.16 cassandra_node_05
     10.0.0.45 cassandra_node_04
     10.0.0.37 cassandra_node_07
     10.0.0.44 cassandra_node_06' >> /etc/hosts; echo cassandra_node_08 >/etc/hostname


May04 01:21:31 [DEBUG]  [cassandra_node_08]: Connecting to SSH
May04 01:21:31 [DEBUG]  [cassandra_node_08]: connected in 0 sec. Running SSH command
May04 01:21:31 [DEBUG]  [cassandra_node_08]: SSH command took 0 sec
May04 01:21:31 [DEBUG]  [cassandra_node_08]: command returned:

 	$:  


May04 02:24:08 [DEBUG]  [cassandra_node_08]: running SSH command:

     sed -i "/.*cassandra.*/g" /etc/hosts; sed -i "/^$/d" /etc/hosts


May04 02:24:08 [DEBUG]  [cassandra_node_08]: Connecting to SSH
May04 02:24:08 [DEBUG]  [cassandra_node_08]: connected in 0 sec. Running SSH command
May04 02:24:08 [DEBUG]  [cassandra_node_08]: SSH command took 0 sec
May04 02:24:08 [DEBUG]  [cassandra_node_08]: command returned:

 	$:  


May04 02:24:08 [DEBUG]  [cassandra_node_08]: running SSH command:

     echo '
     10.0.0.35 cassandra_seednode
     10.0.0.30 cassandra_node_10
     10.0.0.35 cassandra_seed_0
     10.0.0.17 cassandra_node_09
     10.0.0.13 cassandra_node_08
     10.0.0.31 cassandra_node_01
     10.0.0.11 cassandra_node_03
     10.0.0.38 cassandra_node_02
     10.0.0.16 cassandra_node_05
     10.0.0.45 cassandra_node_04
     10.0.0.37 cassandra_node_07
     10.0.0.44 cassandra_node_06' >> /etc/hosts; echo cassandra_node_08 >/etc/hostname


May04 02:24:08 [DEBUG]  [cassandra_node_08]: Connecting to SSH
May04 02:24:08 [DEBUG]  [cassandra_node_08]: connected in 0 sec. Running SSH command
May04 02:24:08 [DEBUG]  [cassandra_node_08]: SSH command took 0 sec
May04 02:24:08 [DEBUG]  [cassandra_node_08]: command returned:

 	$:  


May04 03:26:38 [DEBUG]  [cassandra_node_08]: running SSH command:

     sed -i "/.*cassandra.*/g" /etc/hosts; sed -i "/^$/d" /etc/hosts


May04 03:26:38 [DEBUG]  [cassandra_node_08]: Connecting to SSH
May04 03:26:39 [DEBUG]  [cassandra_node_08]: connected in 0 sec. Running SSH command
May04 03:26:39 [DEBUG]  [cassandra_node_08]: SSH command took 0 sec
May04 03:26:39 [DEBUG]  [cassandra_node_08]: command returned:

 	$:  


May04 03:26:39 [DEBUG]  [cassandra_node_08]: running SSH command:

     echo '
     10.0.0.35 cassandra_seednode
     10.0.0.18 cassandra_node_11
     10.0.0.30 cassandra_node_10
     10.0.0.35 cassandra_seed_0
     10.0.0.17 cassandra_node_09
     10.0.0.13 cassandra_node_08
     10.0.0.31 cassandra_node_01
     10.0.0.11 cassandra_node_03
     10.0.0.38 cassandra_node_02
     10.0.0.16 cassandra_node_05
     10.0.0.45 cassandra_node_04
     10.0.0.37 cassandra_node_07
     10.0.0.44 cassandra_node_06' >> /etc/hosts; echo cassandra_node_08 >/etc/hostname


May04 03:26:39 [DEBUG]  [cassandra_node_08]: Connecting to SSH
May04 03:26:39 [DEBUG]  [cassandra_node_08]: connected in 0 sec. Running SSH command
May04 03:26:39 [DEBUG]  [cassandra_node_08]: SSH command took 0 sec
May04 03:26:39 [DEBUG]  [cassandra_node_08]: command returned:

 	$:  


May04 04:29:06 [DEBUG]  [cassandra_node_08]: running SSH command:

     sed -i "/.*cassandra.*/g" /etc/hosts; sed -i "/^$/d" /etc/hosts


May04 04:29:06 [DEBUG]  [cassandra_node_08]: Connecting to SSH
May04 04:29:06 [DEBUG]  [cassandra_node_08]: connected in 0 sec. Running SSH command
May04 04:29:06 [DEBUG]  [cassandra_node_08]: SSH command took 0 sec
May04 04:29:06 [DEBUG]  [cassandra_node_08]: command returned:

 	$:  


May04 04:29:06 [DEBUG]  [cassandra_node_08]: running SSH command:

     echo '
     10.0.0.35 cassandra_seednode
     10.0.0.18 cassandra_node_11
     10.0.0.30 cassandra_node_10
     10.0.0.35 cassandra_seed_0
     10.0.0.17 cassandra_node_09
     10.0.0.13 cassandra_node_08
     10.0.0.42 cassandra_node_12
     10.0.0.31 cassandra_node_01
     10.0.0.11 cassandra_node_03
     10.0.0.38 cassandra_node_02
     10.0.0.16 cassandra_node_05
     10.0.0.45 cassandra_node_04
     10.0.0.37 cassandra_node_07
     10.0.0.44 cassandra_node_06' >> /etc/hosts; echo cassandra_node_08 >/etc/hostname


May04 04:29:06 [DEBUG]  [cassandra_node_08]: Connecting to SSH
May04 04:29:06 [DEBUG]  [cassandra_node_08]: connected in 0 sec. Running SSH command
May04 04:29:06 [DEBUG]  [cassandra_node_08]: SSH command took 0 sec
May04 04:29:06 [DEBUG]  [cassandra_node_08]: command returned:

 	$:  


May04 05:31:47 [DEBUG]  [cassandra_node_08]: running SSH command:

     sed -i "/.*cassandra.*/g" /etc/hosts; sed -i "/^$/d" /etc/hosts


May04 05:31:47 [DEBUG]  [cassandra_node_08]: Connecting to SSH
May04 05:31:47 [DEBUG]  [cassandra_node_08]: connected in 0 sec. Running SSH command
May04 05:31:47 [DEBUG]  [cassandra_node_08]: SSH command took 0 sec
May04 05:31:47 [DEBUG]  [cassandra_node_08]: command returned:

 	$:  


May04 05:31:47 [DEBUG]  [cassandra_node_08]: running SSH command:

     echo '
     10.0.0.35 cassandra_seednode
     10.0.0.18 cassandra_node_11
     10.0.0.30 cassandra_node_10
     10.0.0.35 cassandra_seed_0
     10.0.0.17 cassandra_node_09
     10.0.0.13 cassandra_node_08
     10.0.0.42 cassandra_node_12
     10.0.0.31 cassandra_node_01
     10.0.0.41 cassandra_node_13
     10.0.0.11 cassandra_node_03
     10.0.0.38 cassandra_node_02
     10.0.0.16 cassandra_node_05
     10.0.0.45 cassandra_node_04
     10.0.0.37 cassandra_node_07
     10.0.0.44 cassandra_node_06' >> /etc/hosts; echo cassandra_node_08 >/etc/hostname


May04 05:31:47 [DEBUG]  [cassandra_node_08]: Connecting to SSH
May04 05:31:48 [DEBUG]  [cassandra_node_08]: connected in 0 sec. Running SSH command
May04 05:31:48 [DEBUG]  [cassandra_node_08]: SSH command took 0 sec
May04 05:31:48 [DEBUG]  [cassandra_node_08]: command returned:

 	$:  


May04 06:34:14 [DEBUG]  [cassandra_node_08]: running SSH command:

     sed -i "/.*cassandra.*/g" /etc/hosts; sed -i "/^$/d" /etc/hosts


May04 06:34:14 [DEBUG]  [cassandra_node_08]: Connecting to SSH
May04 06:34:14 [DEBUG]  [cassandra_node_08]: connected in 0 sec. Running SSH command
May04 06:34:14 [DEBUG]  [cassandra_node_08]: SSH command took 0 sec
May04 06:34:14 [DEBUG]  [cassandra_node_08]: command returned:

 	$:  


May04 06:34:14 [DEBUG]  [cassandra_node_08]: running SSH command:

     echo '
     10.0.0.35 cassandra_seednode
     10.0.0.18 cassandra_node_11
     10.0.0.30 cassandra_node_10
     10.0.0.35 cassandra_seed_0
     10.0.0.17 cassandra_node_09
     10.0.0.13 cassandra_node_08
     10.0.0.42 cassandra_node_12
     10.0.0.33 cassandra_node_14
     10.0.0.31 cassandra_node_01
     10.0.0.41 cassandra_node_13
     10.0.0.11 cassandra_node_03
     10.0.0.38 cassandra_node_02
     10.0.0.16 cassandra_node_05
     10.0.0.45 cassandra_node_04
     10.0.0.37 cassandra_node_07
     10.0.0.44 cassandra_node_06' >> /etc/hosts; echo cassandra_node_08 >/etc/hostname


May04 06:34:14 [DEBUG]  [cassandra_node_08]: Connecting to SSH
May04 06:34:14 [DEBUG]  [cassandra_node_08]: connected in 0 sec. Running SSH command
May04 06:34:14 [DEBUG]  [cassandra_node_08]: SSH command took 0 sec
May04 06:34:14 [DEBUG]  [cassandra_node_08]: command returned:

 	$:  


May04 07:36:56 [DEBUG]  [cassandra_node_08]: running SSH command:

     sed -i "/.*cassandra.*/g" /etc/hosts; sed -i "/^$/d" /etc/hosts


May04 07:36:56 [DEBUG]  [cassandra_node_08]: Connecting to SSH
May04 07:36:56 [DEBUG]  [cassandra_node_08]: connected in 0 sec. Running SSH command
May04 07:36:56 [DEBUG]  [cassandra_node_08]: SSH command took 0 sec
May04 07:36:56 [DEBUG]  [cassandra_node_08]: command returned:

 	$:  


May04 07:36:56 [DEBUG]  [cassandra_node_08]: running SSH command:

     echo '
     10.0.0.35 cassandra_seednode
     10.0.0.18 cassandra_node_11
     10.0.0.30 cassandra_node_10
     10.0.0.32 cassandra_node_15
     10.0.0.35 cassandra_seed_0
     10.0.0.17 cassandra_node_09
     10.0.0.13 cassandra_node_08
     10.0.0.42 cassandra_node_12
     10.0.0.33 cassandra_node_14
     10.0.0.31 cassandra_node_01
     10.0.0.41 cassandra_node_13
     10.0.0.11 cassandra_node_03
     10.0.0.38 cassandra_node_02
     10.0.0.16 cassandra_node_05
     10.0.0.45 cassandra_node_04
     10.0.0.37 cassandra_node_07
     10.0.0.44 cassandra_node_06' >> /etc/hosts; echo cassandra_node_08 >/etc/hostname


May04 07:36:56 [DEBUG]  [cassandra_node_08]: Connecting to SSH
May04 07:36:56 [DEBUG]  [cassandra_node_08]: connected in 0 sec. Running SSH command
May04 07:36:56 [DEBUG]  [cassandra_node_08]: SSH command took 0 sec
May04 07:36:56 [DEBUG]  [cassandra_node_08]: command returned:

 	$:  


May04 08:40:13 [DEBUG]  [cassandra_node_08]: running SSH command:

     sed -i "/.*cassandra.*/g" /etc/hosts; sed -i "/^$/d" /etc/hosts


May04 08:40:13 [DEBUG]  [cassandra_node_08]: Connecting to SSH
May04 08:40:13 [DEBUG]  [cassandra_node_08]: connected in 0 sec. Running SSH command
May04 08:40:13 [DEBUG]  [cassandra_node_08]: SSH command took 0 sec
May04 08:40:13 [DEBUG]  [cassandra_node_08]: command returned:

 	$:  


May04 08:40:13 [DEBUG]  [cassandra_node_08]: running SSH command:

     echo '
     10.0.0.35 cassandra_seednode
     10.0.0.18 cassandra_node_11
     10.0.0.30 cassandra_node_10
     10.0.0.32 cassandra_node_15
     10.0.0.39 cassandra_node_16
     10.0.0.35 cassandra_seed_0
     10.0.0.17 cassandra_node_09
     10.0.0.13 cassandra_node_08
     10.0.0.42 cassandra_node_12
     10.0.0.33 cassandra_node_14
     10.0.0.31 cassandra_node_01
     10.0.0.41 cassandra_node_13
     10.0.0.11 cassandra_node_03
     10.0.0.38 cassandra_node_02
     10.0.0.16 cassandra_node_05
     10.0.0.45 cassandra_node_04
     10.0.0.37 cassandra_node_07
     10.0.0.44 cassandra_node_06' >> /etc/hosts; echo cassandra_node_08 >/etc/hostname


May04 08:40:13 [DEBUG]  [cassandra_node_08]: Connecting to SSH
May04 08:40:13 [DEBUG]  [cassandra_node_08]: connected in 0 sec. Running SSH command
May04 08:40:13 [DEBUG]  [cassandra_node_08]: SSH command took 0 sec
May04 08:40:13 [DEBUG]  [cassandra_node_08]: command returned:

 	$:  


May04 09:42:43 [DEBUG]  [cassandra_node_08]: running SSH command:

     sed -i "/.*cassandra.*/g" /etc/hosts; sed -i "/^$/d" /etc/hosts


May04 09:42:43 [DEBUG]  [cassandra_node_08]: Connecting to SSH
May04 09:42:43 [DEBUG]  [cassandra_node_08]: connected in 0 sec. Running SSH command
May04 09:42:43 [DEBUG]  [cassandra_node_08]: SSH command took 0 sec
May04 09:42:43 [DEBUG]  [cassandra_node_08]: command returned:

 	$:  


May04 09:42:43 [DEBUG]  [cassandra_node_08]: running SSH command:

     echo '
     10.0.0.35 cassandra_seednode
     10.0.0.18 cassandra_node_11
     10.0.0.30 cassandra_node_10
     10.0.0.32 cassandra_node_15
     10.0.0.39 cassandra_node_16
     10.0.0.43 cassandra_node_17
     10.0.0.35 cassandra_seed_0
     10.0.0.17 cassandra_node_09
     10.0.0.13 cassandra_node_08
     10.0.0.42 cassandra_node_12
     10.0.0.33 cassandra_node_14
     10.0.0.31 cassandra_node_01
     10.0.0.41 cassandra_node_13
     10.0.0.11 cassandra_node_03
     10.0.0.38 cassandra_node_02
     10.0.0.16 cassandra_node_05
     10.0.0.45 cassandra_node_04
     10.0.0.37 cassandra_node_07
     10.0.0.44 cassandra_node_06' >> /etc/hosts; echo cassandra_node_08 >/etc/hostname


May04 09:42:43 [DEBUG]  [cassandra_node_08]: Connecting to SSH
May04 09:42:43 [DEBUG]  [cassandra_node_08]: connected in 0 sec. Running SSH command
May04 09:42:43 [DEBUG]  [cassandra_node_08]: SSH command took 0 sec
May04 09:42:43 [DEBUG]  [cassandra_node_08]: command returned:

 	$:  


May04 10:45:17 [DEBUG]  [cassandra_node_08]: running SSH command:

     sed -i "/.*cassandra.*/g" /etc/hosts; sed -i "/^$/d" /etc/hosts


May04 10:45:17 [DEBUG]  [cassandra_node_08]: Connecting to SSH
May04 10:45:18 [DEBUG]  [cassandra_node_08]: connected in 0 sec. Running SSH command
May04 10:45:18 [DEBUG]  [cassandra_node_08]: SSH command took 0 sec
May04 10:45:18 [DEBUG]  [cassandra_node_08]: command returned:

 	$:  


May04 10:45:18 [DEBUG]  [cassandra_node_08]: running SSH command:

     echo '
     10.0.0.35 cassandra_seednode
     10.0.0.18 cassandra_node_11
     10.0.0.30 cassandra_node_10
     10.0.0.32 cassandra_node_15
     10.0.0.39 cassandra_node_16
     10.0.0.43 cassandra_node_17
     10.0.0.35 cassandra_seed_0
     10.0.0.17 cassandra_node_09
     10.0.0.13 cassandra_node_08
     10.0.0.40 cassandra_node_18
     10.0.0.42 cassandra_node_12
     10.0.0.33 cassandra_node_14
     10.0.0.31 cassandra_node_01
     10.0.0.41 cassandra_node_13
     10.0.0.11 cassandra_node_03
     10.0.0.38 cassandra_node_02
     10.0.0.16 cassandra_node_05
     10.0.0.45 cassandra_node_04
     10.0.0.37 cassandra_node_07
     10.0.0.44 cassandra_node_06' >> /etc/hosts; echo cassandra_node_08 >/etc/hostname


May04 10:45:18 [DEBUG]  [cassandra_node_08]: Connecting to SSH
May04 10:45:18 [DEBUG]  [cassandra_node_08]: connected in 0 sec. Running SSH command
May04 10:45:18 [DEBUG]  [cassandra_node_08]: SSH command took 0 sec
May04 10:45:18 [DEBUG]  [cassandra_node_08]: command returned:

 	$:  


May04 11:48:41 [DEBUG]  [cassandra_node_08]: running SSH command:

     sed -i "/.*cassandra.*/g" /etc/hosts; sed -i "/^$/d" /etc/hosts


May04 11:48:41 [DEBUG]  [cassandra_node_08]: Connecting to SSH
May04 11:48:42 [DEBUG]  [cassandra_node_08]: connected in 0 sec. Running SSH command
May04 11:48:42 [DEBUG]  [cassandra_node_08]: SSH command took 0 sec
May04 11:48:42 [DEBUG]  [cassandra_node_08]: command returned:

 	$:  


May04 11:48:42 [DEBUG]  [cassandra_node_08]: running SSH command:

     echo '
     10.0.0.35 cassandra_seednode
     10.0.0.18 cassandra_node_11
     10.0.0.30 cassandra_node_10
     10.0.0.32 cassandra_node_15
     10.0.0.39 cassandra_node_16
     10.0.0.43 cassandra_node_17
     10.0.0.35 cassandra_seed_0
     10.0.0.17 cassandra_node_09
     10.0.0.13 cassandra_node_08
     10.0.0.40 cassandra_node_18
     10.0.0.20 cassandra_node_19
     10.0.0.42 cassandra_node_12
     10.0.0.33 cassandra_node_14
     10.0.0.31 cassandra_node_01
     10.0.0.41 cassandra_node_13
     10.0.0.11 cassandra_node_03
     10.0.0.38 cassandra_node_02
     10.0.0.16 cassandra_node_05
     10.0.0.45 cassandra_node_04
     10.0.0.37 cassandra_node_07
     10.0.0.44 cassandra_node_06' >> /etc/hosts; echo cassandra_node_08 >/etc/hostname


May04 11:48:42 [DEBUG]  [cassandra_node_08]: Connecting to SSH
May04 11:48:42 [DEBUG]  [cassandra_node_08]: connected in 0 sec. Running SSH command
May04 11:48:42 [DEBUG]  [cassandra_node_08]: SSH command took 0 sec
May04 11:48:42 [DEBUG]  [cassandra_node_08]: command returned:

 	$:  


May04 22:45:44 [DEBUG]  [cassandra_node_08]: cluster = cassandra
May04 22:45:44 [ INFO]  [cassandra_node_08]: running kill script
May04 22:45:44 [DEBUG]  [cassandra_node_08]: running SSH command:

     #!/bin/sh
     CAS_PID=$(jps | grep CassandraDaemon | awk  '{print $1}')
     echo "CTOOL: Killing CassandraDaemon ($CAS_PID)"
     kill -9 $CAS_PID &>/dev/null
     ## maybe problematic
     killall java
     
     
     
     ################ debug #################3
     echo "Removing cassandra files and logs" &>>ctool.log
     #cleaning cassandra files
     rm -rf /var/lib/cassandra/* &>>ctool.log
     rm /var/log/cassandra/system.log &>>ctool.log
     #cleaning ctool rrds
     echo "Removing ganglia rrds" &>>ctool.log
     rm -rf /var/lib/ganglia/rrds/* &>>ctool.log
     
     
     
     
     
     echo '
     
     ############  KILLED  ##############' >> ycsb_run.log
     
     #report not alive
     gmetric -n alive -v 0 -t int32 -u nodes -d 10000
     


May04 22:45:44 [DEBUG]  [cassandra_node_08]: Connecting to SSH
May04 22:45:44 [DEBUG]  [cassandra_node_08]: connected in 0 sec. Running SSH command
May04 22:45:46 [DEBUG]  [cassandra_node_08]: SSH command took 1 sec
May04 22:45:46 [DEBUG]  [cassandra_node_08]: command returned:

 	$:  CTOOL: Killing CassandraDaemon (30772)
	$:  


May04 22:46:04 [DEBUG]  [cassandra_node_08]: cluster = cassandra
May04 22:46:21 [DEBUG]  [cassandra_node_08]: cluster = cassandra
May04 22:54:14 [DEBUG]  [cassandra_node_08]: cluster = cassandra
May04 22:54:29 [DEBUG]  [cassandra_node_08]: cluster = cassandra
May04 23:31:18 [DEBUG]  [cassandra_node_08]: cluster = cassandra
May04 23:31:32 [DEBUG]  [cassandra_node_08]: cluster = cassandra
May04 23:48:05 [ INFO]  [cassandra_node_08]: Waiting for SSH daemon (83.212.118.12)
May04 23:48:05 [DEBUG]  [cassandra_node_08]: end time:2014-05-04 23:58:05.311747
May04 23:48:05 [DEBUG]  [cassandra_node_08]: ssh attempt:1
May04 23:48:05 [DEBUG]  [cassandra_node_08]: Connecting to SSH
May04 23:48:05 [DEBUG]  [cassandra_node_08]: connected in 0 sec. Running SSH command
May04 23:48:05 [DEBUG]  [cassandra_node_08]: SSH command took 0 sec
May04 23:48:05 [ INFO]  [cassandra_node_08]: now ready (took 0 sec)
May04 23:48:05 [DEBUG]  [cassandra_node_08]: running SSH command:

     sed -i "/.*cassandra.*/g" /etc/hosts; sed -i "/^$/d" /etc/hosts


May04 23:48:05 [DEBUG]  [cassandra_node_08]: Connecting to SSH
May04 23:48:05 [DEBUG]  [cassandra_node_08]: connected in 0 sec. Running SSH command
May04 23:48:05 [DEBUG]  [cassandra_node_08]: SSH command took 0 sec
May04 23:48:05 [DEBUG]  [cassandra_node_08]: command returned:

 	$:  


May04 23:48:05 [DEBUG]  [cassandra_node_08]: running SSH command:

     echo '
     10.0.0.35 cassandra_seednode
     10.0.0.18 cassandra_node_11
     10.0.0.30 cassandra_node_10
     10.0.0.35 cassandra_seed_0
     10.0.0.17 cassandra_node_09
     10.0.0.13 cassandra_node_08
     10.0.0.31 cassandra_node_01
     10.0.0.11 cassandra_node_03
     10.0.0.38 cassandra_node_02
     10.0.0.16 cassandra_node_05
     10.0.0.45 cassandra_node_04
     10.0.0.37 cassandra_node_07
     10.0.0.44 cassandra_node_06' >> /etc/hosts; echo cassandra_node_08 >/etc/hostname


May04 23:48:05 [DEBUG]  [cassandra_node_08]: Connecting to SSH
May04 23:48:05 [DEBUG]  [cassandra_node_08]: connected in 0 sec. Running SSH command
May04 23:48:05 [DEBUG]  [cassandra_node_08]: SSH command took 0 sec
May04 23:48:05 [DEBUG]  [cassandra_node_08]: command returned:

 	$:  


May04 23:48:05 [ INFO]  [cassandra_node_08]: running bootstrap script
May04 23:48:05 [DEBUG]  [cassandra_node_08]: running SSH command:

     #!/bin/bash
     
     MAX_WAIT=300  #5 min
     
     echo "started bootstrap" > bootsrap.log
     
     # check the seednode
     if ! ping -q -c 1 cassandra_seednode &>/dev/null   ;
     then
     echo CTOOL: ERROR - cassandra_seednode not pingable, exiting
     exit -1
     fi
     
     # kill the cassandra process
     CAS_PID=$(jps | grep CassandraDaemon | awk  '{print $1}')
     echo "CTOOL: Killing CassandraDaemon ($CAS_PID)"
     kill -9 $CAS_PID
     
     # clean previous files and logs
     echo "Removing cassandra files and logs"
     #cleaning cassandra files
     rm -rf /var/lib/cassandra/*
     rm /var/log/cassandra/system.log
     #cleaning ctool rrds
     echo "Removing ganglia rrds"
     rm -rf /var/lib/ganglia/rrds/*
     rm /var/log/cassandra/system.log
     
     # find my IP
     my_priv_addr=""
     #look for an IPv4 interface in range 10.0 and use that for the cassandra communication
     let if_count=($(ifconfig | grep eth | wc -l ))-1
     for i in $(seq 0 $if_count)
     do	#look for IPv4 address
     line=$(ifconfig eth$i | grep "inet addr:")
     line=$(echo $line | awk '{print $2}')
     address=$(echo $line | sed 's/addr://g')
     if [[ "$address" == 10.0.* ]] ;
     then
     my_priv_addr=$address
     break
     fi
     done
     
     # configure cassandra
     echo "configuring cassandra.yaml for my address:$my_priv_addr" >> ctool.log
     #change the listen address of this node
     sed "s/listen_address: .*/listen_address: $my_priv_addr/g"  /etc/cassandra/cassandra.yaml> tmp && mv tmp /etc/cassandra/cassandra.yaml
     #change the rpc_address of this node to 0.0.0.0
     sed "s/rpc_address: .*/rpc_address: 0.0.0.0/g"  /etc/cassandra/cassandra.yaml> tmp && mv tmp /etc/cassandra/cassandra.yaml
     #change the seeds to "cassandra_seednode"
     sed "s/seeds: .*/seeds: \"cassandra_seednode\"/g"  /etc/cassandra/cassandra.yaml> tmp && mv tmp /etc/cassandra/cassandra.yaml
     #add the jmx server whatever to cassandra-env.sh
     sed -i.bak "s/.*-Djava.rmi.server.hostname=.*/JVM_OPTS=\"\$JVM_OPTS -Djava.rmi.server.hostname=$my_priv_addr\"/g"  /etc/cassandra/cassandra-env.sh
     sed -i.bak "s/*JVM_OPTS=\"\$JVM_OPTS -Djava.rmi.server.hostname=*\"/JVM_OPTS=\"\$JVM_OPTS -Djava.rmi.server.hostname=$my_priv_addr\"/g"  /etc/cassandra/cassandra-env.sh
     #make sure no requests are dropped by using a big timeout
     sed -i.bak "s/read_request_timeout_in_ms:.*/read_request_timeout_in_ms: 50000/g" /etc/cassandra/cassandra.yaml
     sed -i.bak "s/write_request_timeout_in_ms:.*/write_request_timeout_in_ms: 50000/g" /etc/cassandra/cassandra.yaml
     echo "CTOOL: Done configuring"
     
     
     # start cassandra
     chmod -R o+rw /var/lib/cassandra
     echo Starting casandra service, ganglia-monitor
     service cassandra start
     service ganglia-monitor restart
     
     #wait until ready and try to create keyspace
     echo "Attempting to create ycsb keyspace"
     echo "create keyspace ycsb  WITH REPLICATION = {'class' : 'SimpleStrategy', 'replication_factor': 1 }; use ycsb;  create table usertable (y_id varchar primary key, field0 varchar, field1 varchar, field2 varchar, field3 varchar, field4 varchar, field5 varchar, field6 varchar, field7 varchar, field8 varchar, field9 varchar);" > ycsb_cql.temp
     while ! cqlsh < ycsb_cql.temp 2>/dev/null;do sleep 2; done
     rm ycsb_cql.temp
     
     echo "ended bootstrap" >> bootsrap.log
     
     #report alive in gmetric
     gmetric -n alive -v 1 -t int32 -u nodes -d 10000
     
     
     


May04 23:48:05 [DEBUG]  [cassandra_node_08]: Connecting to SSH
May04 23:48:06 [DEBUG]  [cassandra_node_08]: connected in 0 sec. Running SSH command
May04 23:50:48 [DEBUG]  [cassandra_node_08]: SSH command took 162 sec
May04 23:50:48 [DEBUG]  [cassandra_node_08]: command returned:

 	$:  CTOOL: Killing CassandraDaemon ()
	$:  Removing cassandra files and logs
	$:  Removing ganglia rrds
	$:  CTOOL: Done configuring
	$:  Starting casandra service, ganglia-monitor
	$:  Stopping Ganglia Monitor Daemon: gmond.
	$:  Starting Ganglia Monitor Daemon: gmond.
	$:  Attempting to create ycsb keyspace
	$:  kill: usage: kill [-s sigspec | -n signum | -sigspec] pid | jobspec ... or kill -l [sigspec]
	$:  rm: cannot remove `/var/log/cassandra/system.log': No such file or directory
	$:  rm: cannot remove `/var/log/cassandra/system.log': No such file or directory
	$:  


May04 23:50:48 [DEBUG]  [cassandra_node_08]: command returned:
	$:  CTOOL: Killing CassandraDaemon ()
	$:  Removing cassandra files and logs
	$:  Removing ganglia rrds
	$:  CTOOL: Done configuring
	$:  Starting casandra service, ganglia-monitor
	$:  Stopping Ganglia Monitor Daemon: gmond.
	$:  Starting Ganglia Monitor Daemon: gmond.
	$:  Attempting to create ycsb keyspace
	$:  kill: usage: kill [-s sigspec | -n signum | -sigspec] pid | jobspec ... or kill -l [sigspec]
	$:  rm: cannot remove `/var/log/cassandra/system.log': No such file or directory
	$:  rm: cannot remove `/var/log/cassandra/system.log': No such file or directory
	$:  
May04 23:50:48 [ INFO]  [cassandra_node_08]: is now bootstrapped (took 162 sec)
May04 23:51:05 [DEBUG]  [cassandra_node_08]: running SSH command:

     sed -i "/.*cassandra.*/g" /etc/hosts; sed -i "/^$/d" /etc/hosts


May04 23:51:05 [DEBUG]  [cassandra_node_08]: Connecting to SSH
May04 23:51:05 [DEBUG]  [cassandra_node_08]: connected in 0 sec. Running SSH command
May04 23:51:05 [DEBUG]  [cassandra_node_08]: SSH command took 0 sec
May04 23:51:05 [DEBUG]  [cassandra_node_08]: command returned:

 	$:  


May04 23:51:05 [DEBUG]  [cassandra_node_08]: running SSH command:

     echo '
     10.0.0.35 cassandra_seednode
     10.0.0.18 cassandra_node_11
     10.0.0.30 cassandra_node_10
     10.0.0.35 cassandra_seed_0
     10.0.0.17 cassandra_node_09
     10.0.0.13 cassandra_node_08
     10.0.0.31 cassandra_node_01
     10.0.0.11 cassandra_node_03
     10.0.0.38 cassandra_node_02
     10.0.0.16 cassandra_node_05
     10.0.0.45 cassandra_node_04
     10.0.0.37 cassandra_node_07
     10.0.0.44 cassandra_node_06' >> /etc/hosts; echo cassandra_node_08 >/etc/hostname


May04 23:51:05 [DEBUG]  [cassandra_node_08]: Connecting to SSH
May04 23:51:06 [DEBUG]  [cassandra_node_08]: connected in 0 sec. Running SSH command
May04 23:51:06 [DEBUG]  [cassandra_node_08]: SSH command took 0 sec
May04 23:51:06 [DEBUG]  [cassandra_node_08]: command returned:

 	$:  


May04 23:59:13 [DEBUG]  [cassandra_node_08]: running SSH command:

     sed -i "/.*cassandra.*/g" /etc/hosts; sed -i "/^$/d" /etc/hosts


May04 23:59:13 [DEBUG]  [cassandra_node_08]: Connecting to SSH
May04 23:59:13 [DEBUG]  [cassandra_node_08]: connected in 0 sec. Running SSH command
May04 23:59:13 [DEBUG]  [cassandra_node_08]: SSH command took 0 sec
May04 23:59:13 [DEBUG]  [cassandra_node_08]: command returned:

 	$:  


May04 23:59:13 [DEBUG]  [cassandra_node_08]: running SSH command:

     echo '
     10.0.0.35 cassandra_seednode
     10.0.0.18 cassandra_node_11
     10.0.0.30 cassandra_node_10
     10.0.0.32 cassandra_node_15
     10.0.0.35 cassandra_seed_0
     10.0.0.17 cassandra_node_09
     10.0.0.13 cassandra_node_08
     10.0.0.42 cassandra_node_12
     10.0.0.33 cassandra_node_14
     10.0.0.31 cassandra_node_01
     10.0.0.41 cassandra_node_13
     10.0.0.11 cassandra_node_03
     10.0.0.38 cassandra_node_02
     10.0.0.16 cassandra_node_05
     10.0.0.45 cassandra_node_04
     10.0.0.37 cassandra_node_07
     10.0.0.44 cassandra_node_06' >> /etc/hosts; echo cassandra_node_08 >/etc/hostname


May04 23:59:13 [DEBUG]  [cassandra_node_08]: Connecting to SSH
May04 23:59:13 [DEBUG]  [cassandra_node_08]: connected in 0 sec. Running SSH command
May04 23:59:13 [DEBUG]  [cassandra_node_08]: SSH command took 0 sec
May04 23:59:13 [DEBUG]  [cassandra_node_08]: command returned:

 	$:  


May05 00:07:24 [DEBUG]  [cassandra_node_08]: running SSH command:

     sed -i "/.*cassandra.*/g" /etc/hosts; sed -i "/^$/d" /etc/hosts


May05 00:07:24 [DEBUG]  [cassandra_node_08]: Connecting to SSH
May05 00:07:24 [DEBUG]  [cassandra_node_08]: connected in 0 sec. Running SSH command
May05 00:07:25 [DEBUG]  [cassandra_node_08]: SSH command took 0 sec
May05 00:07:25 [DEBUG]  [cassandra_node_08]: command returned:

 	$:  


May05 00:07:25 [DEBUG]  [cassandra_node_08]: running SSH command:

     echo '
     10.0.0.35 cassandra_seednode
     10.0.0.18 cassandra_node_11
     10.0.0.30 cassandra_node_10
     10.0.0.32 cassandra_node_15
     10.0.0.39 cassandra_node_16
     10.0.0.43 cassandra_node_17
     10.0.0.35 cassandra_seed_0
     10.0.0.17 cassandra_node_09
     10.0.0.13 cassandra_node_08
     10.0.0.40 cassandra_node_18
     10.0.0.20 cassandra_node_19
     10.0.0.42 cassandra_node_12
     10.0.0.33 cassandra_node_14
     10.0.0.31 cassandra_node_01
     10.0.0.41 cassandra_node_13
     10.0.0.11 cassandra_node_03
     10.0.0.38 cassandra_node_02
     10.0.0.16 cassandra_node_05
     10.0.0.45 cassandra_node_04
     10.0.0.37 cassandra_node_07
     10.0.0.44 cassandra_node_06' >> /etc/hosts; echo cassandra_node_08 >/etc/hostname


May05 00:07:25 [DEBUG]  [cassandra_node_08]: Connecting to SSH
May05 00:07:25 [DEBUG]  [cassandra_node_08]: connected in 0 sec. Running SSH command
May05 00:07:25 [DEBUG]  [cassandra_node_08]: SSH command took 0 sec
May05 00:07:25 [DEBUG]  [cassandra_node_08]: command returned:

 	$:  


May05 00:27:10 [DEBUG]  [cassandra_node_08]: running SSH command:

     sed -i "/.*cassandra.*/g" /etc/hosts; sed -i "/^$/d" /etc/hosts


May05 00:27:10 [DEBUG]  [cassandra_node_08]: Connecting to SSH
May05 00:27:10 [DEBUG]  [cassandra_node_08]: connected in 0 sec. Running SSH command
May05 00:27:10 [DEBUG]  [cassandra_node_08]: SSH command took 0 sec
May05 00:27:10 [DEBUG]  [cassandra_node_08]: command returned:

 	$:  


May05 00:27:10 [DEBUG]  [cassandra_node_08]: running SSH command:

     echo '
     10.0.0.35 cassandra_seednode
     10.0.0.18 cassandra_node_11
     10.0.0.30 cassandra_node_10
     10.0.0.32 cassandra_node_15
     10.0.0.35 cassandra_seed_0
     10.0.0.17 cassandra_node_09
     10.0.0.13 cassandra_node_08
     10.0.0.42 cassandra_node_12
     10.0.0.33 cassandra_node_14
     10.0.0.31 cassandra_node_01
     10.0.0.41 cassandra_node_13
     10.0.0.11 cassandra_node_03
     10.0.0.38 cassandra_node_02
     10.0.0.16 cassandra_node_05
     10.0.0.45 cassandra_node_04
     10.0.0.37 cassandra_node_07
     10.0.0.44 cassandra_node_06' >> /etc/hosts; echo cassandra_node_08 >/etc/hostname


May05 00:27:10 [DEBUG]  [cassandra_node_08]: Connecting to SSH
May05 00:27:10 [DEBUG]  [cassandra_node_08]: connected in 0 sec. Running SSH command
May05 00:27:10 [DEBUG]  [cassandra_node_08]: SSH command took 0 sec
May05 00:27:10 [DEBUG]  [cassandra_node_08]: command returned:

 	$:  


May05 00:41:38 [DEBUG]  [cassandra_node_08]: running SSH command:

     sed -i "/.*cassandra.*/g" /etc/hosts; sed -i "/^$/d" /etc/hosts


May05 00:41:38 [DEBUG]  [cassandra_node_08]: Connecting to SSH
May05 00:41:39 [DEBUG]  [cassandra_node_08]: connected in 0 sec. Running SSH command
May05 00:41:39 [DEBUG]  [cassandra_node_08]: SSH command took 0 sec
May05 00:41:39 [DEBUG]  [cassandra_node_08]: command returned:

 	$:  


May05 00:41:39 [DEBUG]  [cassandra_node_08]: running SSH command:

     echo '
     10.0.0.35 cassandra_seednode
     10.0.0.18 cassandra_node_11
     10.0.0.30 cassandra_node_10
     10.0.0.35 cassandra_seed_0
     10.0.0.17 cassandra_node_09
     10.0.0.13 cassandra_node_08
     10.0.0.31 cassandra_node_01
     10.0.0.11 cassandra_node_03
     10.0.0.38 cassandra_node_02
     10.0.0.16 cassandra_node_05
     10.0.0.45 cassandra_node_04
     10.0.0.37 cassandra_node_07
     10.0.0.44 cassandra_node_06' >> /etc/hosts; echo cassandra_node_08 >/etc/hostname


May05 00:41:39 [DEBUG]  [cassandra_node_08]: Connecting to SSH
May05 00:41:39 [DEBUG]  [cassandra_node_08]: connected in 0 sec. Running SSH command
May05 00:41:39 [DEBUG]  [cassandra_node_08]: SSH command took 0 sec
May05 00:41:39 [DEBUG]  [cassandra_node_08]: command returned:

 	$:  


May05 00:49:48 [DEBUG]  [cassandra_node_08]: running SSH command:

     sed -i "/.*cassandra.*/g" /etc/hosts; sed -i "/^$/d" /etc/hosts


May05 00:49:48 [DEBUG]  [cassandra_node_08]: Connecting to SSH
May05 00:49:48 [DEBUG]  [cassandra_node_08]: connected in 0 sec. Running SSH command
May05 00:49:49 [DEBUG]  [cassandra_node_08]: SSH command took 0 sec
May05 00:49:49 [DEBUG]  [cassandra_node_08]: command returned:

 	$:  


May05 00:49:49 [DEBUG]  [cassandra_node_08]: running SSH command:

     echo '
     10.0.0.35 cassandra_seednode
     10.0.0.18 cassandra_node_11
     10.0.0.30 cassandra_node_10
     10.0.0.35 cassandra_seed_0
     10.0.0.17 cassandra_node_09
     10.0.0.13 cassandra_node_08
     10.0.0.42 cassandra_node_12
     10.0.0.31 cassandra_node_01
     10.0.0.11 cassandra_node_03
     10.0.0.38 cassandra_node_02
     10.0.0.16 cassandra_node_05
     10.0.0.45 cassandra_node_04
     10.0.0.37 cassandra_node_07
     10.0.0.44 cassandra_node_06' >> /etc/hosts; echo cassandra_node_08 >/etc/hostname


May05 00:49:49 [DEBUG]  [cassandra_node_08]: Connecting to SSH
May05 00:49:49 [DEBUG]  [cassandra_node_08]: connected in 0 sec. Running SSH command
May05 00:49:49 [DEBUG]  [cassandra_node_08]: SSH command took 0 sec
May05 00:49:49 [DEBUG]  [cassandra_node_08]: command returned:

 	$:  


May05 00:58:01 [DEBUG]  [cassandra_node_08]: running SSH command:

     sed -i "/.*cassandra.*/g" /etc/hosts; sed -i "/^$/d" /etc/hosts


May05 00:58:01 [DEBUG]  [cassandra_node_08]: Connecting to SSH
May05 00:58:02 [DEBUG]  [cassandra_node_08]: connected in 0 sec. Running SSH command
May05 00:58:02 [DEBUG]  [cassandra_node_08]: SSH command took 0 sec
May05 00:58:02 [DEBUG]  [cassandra_node_08]: command returned:

 	$:  


May05 00:58:02 [DEBUG]  [cassandra_node_08]: running SSH command:

     echo '
     10.0.0.35 cassandra_seednode
     10.0.0.18 cassandra_node_11
     10.0.0.30 cassandra_node_10
     10.0.0.32 cassandra_node_15
     10.0.0.43 cassandra_node_17
     10.0.0.35 cassandra_seed_0
     10.0.0.17 cassandra_node_09
     10.0.0.13 cassandra_node_08
     10.0.0.42 cassandra_node_12
     10.0.0.33 cassandra_node_14
     10.0.0.31 cassandra_node_01
     10.0.0.41 cassandra_node_13
     10.0.0.11 cassandra_node_03
     10.0.0.38 cassandra_node_02
     10.0.0.16 cassandra_node_05
     10.0.0.45 cassandra_node_04
     10.0.0.37 cassandra_node_07
     10.0.0.44 cassandra_node_06' >> /etc/hosts; echo cassandra_node_08 >/etc/hostname


May05 00:58:02 [DEBUG]  [cassandra_node_08]: Connecting to SSH
May05 00:58:02 [DEBUG]  [cassandra_node_08]: connected in 0 sec. Running SSH command
May05 00:58:03 [DEBUG]  [cassandra_node_08]: SSH command took 0 sec
May05 00:58:03 [DEBUG]  [cassandra_node_08]: command returned:

 	$:  


May05 01:06:23 [DEBUG]  [cassandra_node_08]: running SSH command:

     sed -i "/.*cassandra.*/g" /etc/hosts; sed -i "/^$/d" /etc/hosts


May05 01:06:23 [DEBUG]  [cassandra_node_08]: Connecting to SSH
May05 01:06:23 [DEBUG]  [cassandra_node_08]: connected in 0 sec. Running SSH command
May05 01:06:24 [DEBUG]  [cassandra_node_08]: SSH command took 0 sec
May05 01:06:24 [DEBUG]  [cassandra_node_08]: command returned:

 	$:  


May05 01:06:24 [DEBUG]  [cassandra_node_08]: running SSH command:

     echo '
     10.0.0.35 cassandra_seednode
     10.0.0.18 cassandra_node_11
     10.0.0.30 cassandra_node_10
     10.0.0.32 cassandra_node_15
     10.0.0.39 cassandra_node_16
     10.0.0.43 cassandra_node_17
     10.0.0.35 cassandra_seed_0
     10.0.0.17 cassandra_node_09
     10.0.0.13 cassandra_node_08
     10.0.0.40 cassandra_node_18
     10.0.0.20 cassandra_node_19
     10.0.0.42 cassandra_node_12
     10.0.0.33 cassandra_node_14
     10.0.0.31 cassandra_node_01
     10.0.0.41 cassandra_node_13
     10.0.0.11 cassandra_node_03
     10.0.0.38 cassandra_node_02
     10.0.0.16 cassandra_node_05
     10.0.0.45 cassandra_node_04
     10.0.0.37 cassandra_node_07
     10.0.0.44 cassandra_node_06' >> /etc/hosts; echo cassandra_node_08 >/etc/hostname


May05 01:06:24 [DEBUG]  [cassandra_node_08]: Connecting to SSH
May05 01:06:24 [DEBUG]  [cassandra_node_08]: connected in 0 sec. Running SSH command
May05 01:06:24 [DEBUG]  [cassandra_node_08]: SSH command took 0 sec
May05 01:06:24 [DEBUG]  [cassandra_node_08]: command returned:

 	$:  


May05 01:25:40 [DEBUG]  [cassandra_node_08]: running SSH command:

     sed -i "/.*cassandra.*/g" /etc/hosts; sed -i "/^$/d" /etc/hosts


May05 01:25:40 [DEBUG]  [cassandra_node_08]: Connecting to SSH
May05 01:25:40 [DEBUG]  [cassandra_node_08]: connected in 0 sec. Running SSH command
May05 01:25:41 [DEBUG]  [cassandra_node_08]: SSH command took 0 sec
May05 01:25:41 [DEBUG]  [cassandra_node_08]: command returned:

 	$:  


May05 01:25:41 [DEBUG]  [cassandra_node_08]: running SSH command:

     echo '
     10.0.0.35 cassandra_seednode
     10.0.0.18 cassandra_node_11
     10.0.0.30 cassandra_node_10
     10.0.0.32 cassandra_node_15
     10.0.0.35 cassandra_seed_0
     10.0.0.17 cassandra_node_09
     10.0.0.13 cassandra_node_08
     10.0.0.42 cassandra_node_12
     10.0.0.33 cassandra_node_14
     10.0.0.31 cassandra_node_01
     10.0.0.41 cassandra_node_13
     10.0.0.11 cassandra_node_03
     10.0.0.38 cassandra_node_02
     10.0.0.16 cassandra_node_05
     10.0.0.45 cassandra_node_04
     10.0.0.37 cassandra_node_07
     10.0.0.44 cassandra_node_06' >> /etc/hosts; echo cassandra_node_08 >/etc/hostname


May05 01:25:41 [DEBUG]  [cassandra_node_08]: Connecting to SSH
May05 01:25:41 [DEBUG]  [cassandra_node_08]: connected in 0 sec. Running SSH command
May05 01:25:41 [DEBUG]  [cassandra_node_08]: SSH command took 0 sec
May05 01:25:41 [DEBUG]  [cassandra_node_08]: command returned:

 	$:  


May05 01:41:29 [DEBUG]  [cassandra_node_08]: running SSH command:

     sed -i "/.*cassandra.*/g" /etc/hosts; sed -i "/^$/d" /etc/hosts


May05 01:41:29 [DEBUG]  [cassandra_node_08]: Connecting to SSH
May05 01:41:29 [DEBUG]  [cassandra_node_08]: connected in 0 sec. Running SSH command
May05 01:41:30 [DEBUG]  [cassandra_node_08]: SSH command took 0 sec
May05 01:41:30 [DEBUG]  [cassandra_node_08]: command returned:

 	$:  


May05 01:41:30 [DEBUG]  [cassandra_node_08]: running SSH command:

     echo '
     10.0.0.35 cassandra_seednode
     10.0.0.18 cassandra_node_11
     10.0.0.30 cassandra_node_10
     10.0.0.35 cassandra_seed_0
     10.0.0.17 cassandra_node_09
     10.0.0.13 cassandra_node_08
     10.0.0.31 cassandra_node_01
     10.0.0.11 cassandra_node_03
     10.0.0.38 cassandra_node_02
     10.0.0.16 cassandra_node_05
     10.0.0.45 cassandra_node_04
     10.0.0.37 cassandra_node_07
     10.0.0.44 cassandra_node_06' >> /etc/hosts; echo cassandra_node_08 >/etc/hostname


May05 01:41:30 [DEBUG]  [cassandra_node_08]: Connecting to SSH
May05 01:41:30 [DEBUG]  [cassandra_node_08]: connected in 0 sec. Running SSH command
May05 01:41:30 [DEBUG]  [cassandra_node_08]: SSH command took 0 sec
May05 01:41:30 [DEBUG]  [cassandra_node_08]: command returned:

 	$:  


May05 01:50:00 [DEBUG]  [cassandra_node_08]: running SSH command:

     sed -i "/.*cassandra.*/g" /etc/hosts; sed -i "/^$/d" /etc/hosts


May05 01:50:00 [DEBUG]  [cassandra_node_08]: Connecting to SSH
May05 01:50:00 [DEBUG]  [cassandra_node_08]: connected in 0 sec. Running SSH command
May05 01:50:00 [DEBUG]  [cassandra_node_08]: SSH command took 0 sec
May05 01:50:00 [DEBUG]  [cassandra_node_08]: command returned:

 	$:  


May05 01:50:00 [DEBUG]  [cassandra_node_08]: running SSH command:

     echo '
     10.0.0.35 cassandra_seednode
     10.0.0.18 cassandra_node_11
     10.0.0.30 cassandra_node_10
     10.0.0.35 cassandra_seed_0
     10.0.0.17 cassandra_node_09
     10.0.0.13 cassandra_node_08
     10.0.0.42 cassandra_node_12
     10.0.0.31 cassandra_node_01
     10.0.0.11 cassandra_node_03
     10.0.0.38 cassandra_node_02
     10.0.0.16 cassandra_node_05
     10.0.0.45 cassandra_node_04
     10.0.0.37 cassandra_node_07
     10.0.0.44 cassandra_node_06' >> /etc/hosts; echo cassandra_node_08 >/etc/hostname


May05 01:50:00 [DEBUG]  [cassandra_node_08]: Connecting to SSH
May05 01:50:01 [DEBUG]  [cassandra_node_08]: connected in 0 sec. Running SSH command
May05 01:50:01 [DEBUG]  [cassandra_node_08]: SSH command took 0 sec
May05 01:50:01 [DEBUG]  [cassandra_node_08]: command returned:

 	$:  


May05 01:58:28 [DEBUG]  [cassandra_node_08]: running SSH command:

     sed -i "/.*cassandra.*/g" /etc/hosts; sed -i "/^$/d" /etc/hosts


May05 01:58:28 [DEBUG]  [cassandra_node_08]: Connecting to SSH
May05 01:58:29 [DEBUG]  [cassandra_node_08]: connected in 0 sec. Running SSH command
May05 01:58:30 [DEBUG]  [cassandra_node_08]: SSH command took 0 sec
May05 01:58:30 [DEBUG]  [cassandra_node_08]: command returned:

 	$:  


May05 01:58:30 [DEBUG]  [cassandra_node_08]: running SSH command:

     echo '
     10.0.0.35 cassandra_seednode
     10.0.0.18 cassandra_node_11
     10.0.0.30 cassandra_node_10
     10.0.0.32 cassandra_node_15
     10.0.0.43 cassandra_node_17
     10.0.0.35 cassandra_seed_0
     10.0.0.17 cassandra_node_09
     10.0.0.13 cassandra_node_08
     10.0.0.42 cassandra_node_12
     10.0.0.33 cassandra_node_14
     10.0.0.31 cassandra_node_01
     10.0.0.41 cassandra_node_13
     10.0.0.11 cassandra_node_03
     10.0.0.38 cassandra_node_02
     10.0.0.16 cassandra_node_05
     10.0.0.45 cassandra_node_04
     10.0.0.37 cassandra_node_07
     10.0.0.44 cassandra_node_06' >> /etc/hosts; echo cassandra_node_08 >/etc/hostname


May05 01:58:30 [DEBUG]  [cassandra_node_08]: Connecting to SSH
May05 01:58:30 [DEBUG]  [cassandra_node_08]: connected in 0 sec. Running SSH command
May05 01:58:30 [DEBUG]  [cassandra_node_08]: SSH command took 0 sec
May05 01:58:30 [DEBUG]  [cassandra_node_08]: command returned:

 	$:  


May05 02:06:30 [DEBUG]  [cassandra_node_08]: running SSH command:

     sed -i "/.*cassandra.*/g" /etc/hosts; sed -i "/^$/d" /etc/hosts


May05 02:06:30 [DEBUG]  [cassandra_node_08]: Connecting to SSH
May05 02:06:31 [DEBUG]  [cassandra_node_08]: connected in 0 sec. Running SSH command
May05 02:06:31 [DEBUG]  [cassandra_node_08]: SSH command took 0 sec
May05 02:06:31 [DEBUG]  [cassandra_node_08]: command returned:

 	$:  


May05 02:06:31 [DEBUG]  [cassandra_node_08]: running SSH command:

     echo '
     10.0.0.35 cassandra_seednode
     10.0.0.18 cassandra_node_11
     10.0.0.30 cassandra_node_10
     10.0.0.32 cassandra_node_15
     10.0.0.39 cassandra_node_16
     10.0.0.43 cassandra_node_17
     10.0.0.35 cassandra_seed_0
     10.0.0.17 cassandra_node_09
     10.0.0.13 cassandra_node_08
     10.0.0.40 cassandra_node_18
     10.0.0.42 cassandra_node_12
     10.0.0.33 cassandra_node_14
     10.0.0.31 cassandra_node_01
     10.0.0.41 cassandra_node_13
     10.0.0.11 cassandra_node_03
     10.0.0.38 cassandra_node_02
     10.0.0.16 cassandra_node_05
     10.0.0.45 cassandra_node_04
     10.0.0.37 cassandra_node_07
     10.0.0.44 cassandra_node_06' >> /etc/hosts; echo cassandra_node_08 >/etc/hostname


May05 02:06:31 [DEBUG]  [cassandra_node_08]: Connecting to SSH
May05 02:06:31 [DEBUG]  [cassandra_node_08]: connected in 0 sec. Running SSH command
May05 02:06:31 [DEBUG]  [cassandra_node_08]: SSH command took 0 sec
May05 02:06:31 [DEBUG]  [cassandra_node_08]: command returned:

 	$:  


May05 02:26:02 [DEBUG]  [cassandra_node_08]: running SSH command:

     sed -i "/.*cassandra.*/g" /etc/hosts; sed -i "/^$/d" /etc/hosts


May05 02:26:02 [DEBUG]  [cassandra_node_08]: Connecting to SSH
May05 02:26:02 [DEBUG]  [cassandra_node_08]: connected in 0 sec. Running SSH command
May05 02:26:02 [DEBUG]  [cassandra_node_08]: SSH command took 0 sec
May05 02:26:02 [DEBUG]  [cassandra_node_08]: command returned:

 	$:  


May05 02:26:02 [DEBUG]  [cassandra_node_08]: running SSH command:

     echo '
     10.0.0.35 cassandra_seednode
     10.0.0.18 cassandra_node_11
     10.0.0.30 cassandra_node_10
     10.0.0.35 cassandra_seed_0
     10.0.0.17 cassandra_node_09
     10.0.0.13 cassandra_node_08
     10.0.0.42 cassandra_node_12
     10.0.0.33 cassandra_node_14
     10.0.0.31 cassandra_node_01
     10.0.0.41 cassandra_node_13
     10.0.0.11 cassandra_node_03
     10.0.0.38 cassandra_node_02
     10.0.0.16 cassandra_node_05
     10.0.0.45 cassandra_node_04
     10.0.0.37 cassandra_node_07
     10.0.0.44 cassandra_node_06' >> /etc/hosts; echo cassandra_node_08 >/etc/hostname


May05 02:26:02 [DEBUG]  [cassandra_node_08]: Connecting to SSH
May05 02:26:02 [DEBUG]  [cassandra_node_08]: connected in 0 sec. Running SSH command
May05 02:26:02 [DEBUG]  [cassandra_node_08]: SSH command took 0 sec
May05 02:26:02 [DEBUG]  [cassandra_node_08]: command returned:

 	$:  


May05 02:32:07 [DEBUG]  [cassandra_node_08]: cluster = cassandra
May05 02:32:20 [DEBUG]  [cassandra_node_08]: cluster = cassandra
May05 02:45:32 [DEBUG]  [cassandra_node_08]: running SSH command:

     sed -i "/.*cassandra.*/g" /etc/hosts; sed -i "/^$/d" /etc/hosts


May05 02:45:32 [DEBUG]  [cassandra_node_08]: Connecting to SSH
May05 02:45:32 [DEBUG]  [cassandra_node_08]: connected in 0 sec. Running SSH command
May05 02:45:32 [DEBUG]  [cassandra_node_08]: SSH command took 0 sec
May05 02:45:32 [DEBUG]  [cassandra_node_08]: command returned:

 	$:  


May05 02:45:32 [DEBUG]  [cassandra_node_08]: running SSH command:

     echo '
     10.0.0.35 cassandra_seednode
     10.0.0.30 cassandra_node_10
     10.0.0.35 cassandra_seed_0
     10.0.0.17 cassandra_node_09
     10.0.0.13 cassandra_node_08
     10.0.0.31 cassandra_node_01
     10.0.0.11 cassandra_node_03
     10.0.0.38 cassandra_node_02
     10.0.0.16 cassandra_node_05
     10.0.0.45 cassandra_node_04
     10.0.0.37 cassandra_node_07
     10.0.0.44 cassandra_node_06' >> /etc/hosts; echo cassandra_node_08 >/etc/hostname


May05 02:45:32 [DEBUG]  [cassandra_node_08]: Connecting to SSH
May05 02:45:32 [DEBUG]  [cassandra_node_08]: connected in 0 sec. Running SSH command
May05 02:45:33 [DEBUG]  [cassandra_node_08]: SSH command took 0 sec
May05 02:45:33 [DEBUG]  [cassandra_node_08]: command returned:

 	$:  


May05 02:59:51 [ INFO]  [cassandra_node_08]: running decommission script
May05 02:59:51 [DEBUG]  [cassandra_node_08]: running SSH command:

     #!/bin/sh
     nodetool repair -h 127.0.0.1 ycsb
     nodetool decommission
     #kill cassandra
     CAS_PID=$(jps | grep CassandraDaemon | awk  '{print $1}')
     echo "CTOOL: Killing CassandraDaemon ($CAS_PID)" >> ctool.log
     kill $CAS_PID &>/dev/null
     
     
     #report not alive
     gmetric -n alive -v 0 -t int32 -u nodes -d 10000
     


May05 02:59:51 [DEBUG]  [cassandra_node_08]: Connecting to SSH
May05 02:59:52 [DEBUG]  [cassandra_node_08]: connected in 0 sec. Running SSH command
May05 03:04:39 [DEBUG]  [cassandra_node_08]: SSH command took 287 sec
May05 03:04:39 [DEBUG]  [cassandra_node_08]: command returned:

 	$:  [2014-05-05 03:00:03,666] Starting repair command #1, repairing 256 ranges for keyspace ycsb
	$:  [2014-05-05 03:00:15,360] Repair command #1 finished
	$:  


May05 03:04:39 [ INFO]  [cassandra_node_08]: now decommissioned (took 287 sec)
May05 03:10:24 [ INFO]  [cassandra_node_08]: Waiting for SSH daemon (83.212.118.12)
May05 03:10:24 [DEBUG]  [cassandra_node_08]: end time:2014-05-05 03:20:24.377185
May05 03:10:24 [DEBUG]  [cassandra_node_08]: ssh attempt:1
May05 03:10:24 [DEBUG]  [cassandra_node_08]: Connecting to SSH
May05 03:10:24 [DEBUG]  [cassandra_node_08]: connected in 0 sec. Running SSH command
May05 03:10:24 [DEBUG]  [cassandra_node_08]: SSH command took 0 sec
May05 03:10:24 [ INFO]  [cassandra_node_08]: now ready (took 0 sec)
May05 03:10:24 [DEBUG]  [cassandra_node_08]: running SSH command:

     sed -i "/.*cassandra.*/g" /etc/hosts; sed -i "/^$/d" /etc/hosts


May05 03:10:24 [DEBUG]  [cassandra_node_08]: Connecting to SSH
May05 03:10:24 [DEBUG]  [cassandra_node_08]: connected in 0 sec. Running SSH command
May05 03:10:24 [DEBUG]  [cassandra_node_08]: SSH command took 0 sec
May05 03:10:24 [DEBUG]  [cassandra_node_08]: command returned:

 	$:  


May05 03:10:24 [DEBUG]  [cassandra_node_08]: running SSH command:

     echo '
     10.0.0.35 cassandra_seednode
     10.0.0.18 cassandra_node_11
     10.0.0.30 cassandra_node_10
     10.0.0.35 cassandra_seed_0
     10.0.0.17 cassandra_node_09
     10.0.0.13 cassandra_node_08
     10.0.0.31 cassandra_node_01
     10.0.0.11 cassandra_node_03
     10.0.0.38 cassandra_node_02
     10.0.0.16 cassandra_node_05
     10.0.0.45 cassandra_node_04
     10.0.0.37 cassandra_node_07
     10.0.0.44 cassandra_node_06' >> /etc/hosts; echo cassandra_node_08 >/etc/hostname


May05 03:10:24 [DEBUG]  [cassandra_node_08]: Connecting to SSH
May05 03:10:24 [DEBUG]  [cassandra_node_08]: connected in 0 sec. Running SSH command
May05 03:10:24 [DEBUG]  [cassandra_node_08]: SSH command took 0 sec
May05 03:10:24 [DEBUG]  [cassandra_node_08]: command returned:

 	$:  


May05 03:10:24 [ INFO]  [cassandra_node_08]: running bootstrap script
May05 03:10:24 [DEBUG]  [cassandra_node_08]: running SSH command:

     #!/bin/bash
     
     MAX_WAIT=300  #5 min
     
     echo "started bootstrap" > bootsrap.log
     
     # check the seednode
     if ! ping -q -c 1 cassandra_seednode &>/dev/null   ;
     then
     echo CTOOL: ERROR - cassandra_seednode not pingable, exiting
     exit -1
     fi
     
     # kill the cassandra process
     CAS_PID=$(jps | grep CassandraDaemon | awk  '{print $1}')
     echo "CTOOL: Killing CassandraDaemon ($CAS_PID)"
     kill -9 $CAS_PID
     
     # clean previous files and logs
     echo "Removing cassandra files and logs"
     #cleaning cassandra files
     rm -rf /var/lib/cassandra/*
     rm /var/log/cassandra/system.log
     #cleaning ctool rrds
     echo "Removing ganglia rrds"
     rm -rf /var/lib/ganglia/rrds/*
     rm /var/log/cassandra/system.log
     
     # find my IP
     my_priv_addr=""
     #look for an IPv4 interface in range 10.0 and use that for the cassandra communication
     let if_count=($(ifconfig | grep eth | wc -l ))-1
     for i in $(seq 0 $if_count)
     do	#look for IPv4 address
     line=$(ifconfig eth$i | grep "inet addr:")
     line=$(echo $line | awk '{print $2}')
     address=$(echo $line | sed 's/addr://g')
     if [[ "$address" == 10.0.* ]] ;
     then
     my_priv_addr=$address
     break
     fi
     done
     
     # configure cassandra
     echo "configuring cassandra.yaml for my address:$my_priv_addr" >> ctool.log
     #change the listen address of this node
     sed "s/listen_address: .*/listen_address: $my_priv_addr/g"  /etc/cassandra/cassandra.yaml> tmp && mv tmp /etc/cassandra/cassandra.yaml
     #change the rpc_address of this node to 0.0.0.0
     sed "s/rpc_address: .*/rpc_address: 0.0.0.0/g"  /etc/cassandra/cassandra.yaml> tmp && mv tmp /etc/cassandra/cassandra.yaml
     #change the seeds to "cassandra_seednode"
     sed "s/seeds: .*/seeds: \"cassandra_seednode\"/g"  /etc/cassandra/cassandra.yaml> tmp && mv tmp /etc/cassandra/cassandra.yaml
     #add the jmx server whatever to cassandra-env.sh
     sed -i.bak "s/.*-Djava.rmi.server.hostname=.*/JVM_OPTS=\"\$JVM_OPTS -Djava.rmi.server.hostname=$my_priv_addr\"/g"  /etc/cassandra/cassandra-env.sh
     sed -i.bak "s/*JVM_OPTS=\"\$JVM_OPTS -Djava.rmi.server.hostname=*\"/JVM_OPTS=\"\$JVM_OPTS -Djava.rmi.server.hostname=$my_priv_addr\"/g"  /etc/cassandra/cassandra-env.sh
     #make sure no requests are dropped by using a big timeout
     sed -i.bak "s/read_request_timeout_in_ms:.*/read_request_timeout_in_ms: 50000/g" /etc/cassandra/cassandra.yaml
     sed -i.bak "s/write_request_timeout_in_ms:.*/write_request_timeout_in_ms: 50000/g" /etc/cassandra/cassandra.yaml
     echo "CTOOL: Done configuring"
     
     
     # start cassandra
     chmod -R o+rw /var/lib/cassandra
     echo Starting casandra service, ganglia-monitor
     service cassandra start
     service ganglia-monitor restart
     
     #wait until ready and try to create keyspace
     echo "Attempting to create ycsb keyspace"
     echo "create keyspace ycsb  WITH REPLICATION = {'class' : 'SimpleStrategy', 'replication_factor': 1 }; use ycsb;  create table usertable (y_id varchar primary key, field0 varchar, field1 varchar, field2 varchar, field3 varchar, field4 varchar, field5 varchar, field6 varchar, field7 varchar, field8 varchar, field9 varchar);" > ycsb_cql.temp
     while ! cqlsh < ycsb_cql.temp 2>/dev/null;do sleep 2; done
     rm ycsb_cql.temp
     
     echo "ended bootstrap" >> bootsrap.log
     
     #report alive in gmetric
     gmetric -n alive -v 1 -t int32 -u nodes -d 10000
     
     
     


May05 03:10:24 [DEBUG]  [cassandra_node_08]: Connecting to SSH
May05 03:10:25 [DEBUG]  [cassandra_node_08]: connected in 0 sec. Running SSH command
May05 03:14:46 [DEBUG]  [cassandra_node_08]: SSH command took 261 sec
May05 03:14:46 [DEBUG]  [cassandra_node_08]: command returned:

 	$:  CTOOL: Killing CassandraDaemon ()
	$:  Removing cassandra files and logs
	$:  Removing ganglia rrds
	$:  CTOOL: Done configuring
	$:  Starting casandra service, ganglia-monitor
	$:  Stopping Ganglia Monitor Daemon: gmond.
	$:  Starting Ganglia Monitor Daemon: gmond.
	$:  Attempting to create ycsb keyspace
	$:  kill: usage: kill [-s sigspec | -n signum | -sigspec] pid | jobspec ... or kill -l [sigspec]
	$:  rm: cannot remove `/var/log/cassandra/system.log': No such file or directory
	$:  


May05 03:14:46 [DEBUG]  [cassandra_node_08]: command returned:
	$:  CTOOL: Killing CassandraDaemon ()
	$:  Removing cassandra files and logs
	$:  Removing ganglia rrds
	$:  CTOOL: Done configuring
	$:  Starting casandra service, ganglia-monitor
	$:  Stopping Ganglia Monitor Daemon: gmond.
	$:  Starting Ganglia Monitor Daemon: gmond.
	$:  Attempting to create ycsb keyspace
	$:  kill: usage: kill [-s sigspec | -n signum | -sigspec] pid | jobspec ... or kill -l [sigspec]
	$:  rm: cannot remove `/var/log/cassandra/system.log': No such file or directory
	$:  
May05 03:14:46 [ INFO]  [cassandra_node_08]: is now bootstrapped (took 262 sec)
May05 03:14:57 [DEBUG]  [cassandra_node_08]: running SSH command:

     sed -i "/.*cassandra.*/g" /etc/hosts; sed -i "/^$/d" /etc/hosts


May05 03:14:57 [DEBUG]  [cassandra_node_08]: Connecting to SSH
May05 03:14:58 [DEBUG]  [cassandra_node_08]: connected in 0 sec. Running SSH command
May05 03:14:58 [DEBUG]  [cassandra_node_08]: SSH command took 0 sec
May05 03:14:58 [DEBUG]  [cassandra_node_08]: command returned:

 	$:  


May05 03:14:58 [DEBUG]  [cassandra_node_08]: running SSH command:

     echo '
     10.0.0.35 cassandra_seednode
     10.0.0.18 cassandra_node_11
     10.0.0.30 cassandra_node_10
     10.0.0.35 cassandra_seed_0
     10.0.0.17 cassandra_node_09
     10.0.0.13 cassandra_node_08
     10.0.0.31 cassandra_node_01
     10.0.0.11 cassandra_node_03
     10.0.0.38 cassandra_node_02
     10.0.0.16 cassandra_node_05
     10.0.0.45 cassandra_node_04
     10.0.0.37 cassandra_node_07
     10.0.0.44 cassandra_node_06' >> /etc/hosts; echo cassandra_node_08 >/etc/hostname


May05 03:14:58 [DEBUG]  [cassandra_node_08]: Connecting to SSH
May05 03:14:58 [DEBUG]  [cassandra_node_08]: connected in 0 sec. Running SSH command
May05 03:14:59 [DEBUG]  [cassandra_node_08]: SSH command took 0 sec
May05 03:14:59 [DEBUG]  [cassandra_node_08]: command returned:

 	$:  


May05 03:24:41 [DEBUG]  [cassandra_node_08]: running SSH command:

     sed -i "/.*cassandra.*/g" /etc/hosts; sed -i "/^$/d" /etc/hosts


May05 03:24:41 [DEBUG]  [cassandra_node_08]: Connecting to SSH
May05 03:24:41 [DEBUG]  [cassandra_node_08]: connected in 0 sec. Running SSH command
May05 03:24:42 [DEBUG]  [cassandra_node_08]: SSH command took 0 sec
May05 03:24:42 [DEBUG]  [cassandra_node_08]: command returned:

 	$:  


May05 03:24:42 [DEBUG]  [cassandra_node_08]: running SSH command:

     echo '
     10.0.0.35 cassandra_seednode
     10.0.0.18 cassandra_node_11
     10.0.0.30 cassandra_node_10
     10.0.0.32 cassandra_node_15
     10.0.0.35 cassandra_seed_0
     10.0.0.17 cassandra_node_09
     10.0.0.13 cassandra_node_08
     10.0.0.42 cassandra_node_12
     10.0.0.33 cassandra_node_14
     10.0.0.31 cassandra_node_01
     10.0.0.41 cassandra_node_13
     10.0.0.11 cassandra_node_03
     10.0.0.38 cassandra_node_02
     10.0.0.16 cassandra_node_05
     10.0.0.45 cassandra_node_04
     10.0.0.37 cassandra_node_07
     10.0.0.44 cassandra_node_06' >> /etc/hosts; echo cassandra_node_08 >/etc/hostname


May05 03:24:42 [DEBUG]  [cassandra_node_08]: Connecting to SSH
May05 03:24:42 [DEBUG]  [cassandra_node_08]: connected in 0 sec. Running SSH command
May05 03:24:42 [DEBUG]  [cassandra_node_08]: SSH command took 0 sec
May05 03:24:42 [DEBUG]  [cassandra_node_08]: command returned:

 	$:  


May05 03:33:41 [DEBUG]  [cassandra_node_08]: running SSH command:

     sed -i "/.*cassandra.*/g" /etc/hosts; sed -i "/^$/d" /etc/hosts


May05 03:33:41 [DEBUG]  [cassandra_node_08]: Connecting to SSH
May05 03:33:42 [DEBUG]  [cassandra_node_08]: connected in 0 sec. Running SSH command
May05 03:33:42 [DEBUG]  [cassandra_node_08]: SSH command took 0 sec
May05 03:33:42 [DEBUG]  [cassandra_node_08]: command returned:

 	$:  


May05 03:33:42 [DEBUG]  [cassandra_node_08]: running SSH command:

     echo '
     10.0.0.35 cassandra_seednode
     10.0.0.18 cassandra_node_11
     10.0.0.30 cassandra_node_10
     10.0.0.32 cassandra_node_15
     10.0.0.39 cassandra_node_16
     10.0.0.43 cassandra_node_17
     10.0.0.35 cassandra_seed_0
     10.0.0.17 cassandra_node_09
     10.0.0.13 cassandra_node_08
     10.0.0.40 cassandra_node_18
     10.0.0.20 cassandra_node_19
     10.0.0.42 cassandra_node_12
     10.0.0.33 cassandra_node_14
     10.0.0.31 cassandra_node_01
     10.0.0.41 cassandra_node_13
     10.0.0.11 cassandra_node_03
     10.0.0.38 cassandra_node_02
     10.0.0.16 cassandra_node_05
     10.0.0.45 cassandra_node_04
     10.0.0.37 cassandra_node_07
     10.0.0.44 cassandra_node_06' >> /etc/hosts; echo cassandra_node_08 >/etc/hostname


May05 03:33:42 [DEBUG]  [cassandra_node_08]: Connecting to SSH
May05 03:33:43 [DEBUG]  [cassandra_node_08]: connected in 0 sec. Running SSH command
May05 03:33:43 [DEBUG]  [cassandra_node_08]: SSH command took 0 sec
May05 03:33:43 [DEBUG]  [cassandra_node_08]: command returned:

 	$:  


May05 03:41:51 [DEBUG]  [cassandra_node_08]: running SSH command:

     sed -i "/.*cassandra.*/g" /etc/hosts; sed -i "/^$/d" /etc/hosts


May05 03:41:51 [DEBUG]  [cassandra_node_08]: Connecting to SSH
May05 03:41:51 [DEBUG]  [cassandra_node_08]: connected in 0 sec. Running SSH command
May05 03:41:51 [DEBUG]  [cassandra_node_08]: SSH command took 0 sec
May05 03:41:51 [DEBUG]  [cassandra_node_08]: command returned:

 	$:  


May05 03:41:51 [DEBUG]  [cassandra_node_08]: running SSH command:

     echo '
     10.0.0.35 cassandra_seednode
     10.0.0.18 cassandra_node_11
     10.0.0.30 cassandra_node_10
     10.0.0.32 cassandra_node_15
     10.0.0.39 cassandra_node_16
     10.0.0.43 cassandra_node_17
     10.0.0.35 cassandra_seed_0
     10.0.0.17 cassandra_node_09
     10.0.0.13 cassandra_node_08
     10.0.0.40 cassandra_node_18
     10.0.0.42 cassandra_node_12
     10.0.0.33 cassandra_node_14
     10.0.0.31 cassandra_node_01
     10.0.0.41 cassandra_node_13
     10.0.0.11 cassandra_node_03
     10.0.0.38 cassandra_node_02
     10.0.0.16 cassandra_node_05
     10.0.0.45 cassandra_node_04
     10.0.0.37 cassandra_node_07
     10.0.0.44 cassandra_node_06' >> /etc/hosts; echo cassandra_node_08 >/etc/hostname


May05 03:41:51 [DEBUG]  [cassandra_node_08]: Connecting to SSH
May05 03:41:51 [DEBUG]  [cassandra_node_08]: connected in 0 sec. Running SSH command
May05 03:41:51 [DEBUG]  [cassandra_node_08]: SSH command took 0 sec
May05 03:41:51 [DEBUG]  [cassandra_node_08]: command returned:

 	$:  


May05 03:50:10 [DEBUG]  [cassandra_node_08]: running SSH command:

     sed -i "/.*cassandra.*/g" /etc/hosts; sed -i "/^$/d" /etc/hosts


May05 03:50:10 [DEBUG]  [cassandra_node_08]: Connecting to SSH
May05 03:50:10 [DEBUG]  [cassandra_node_08]: connected in 0 sec. Running SSH command
May05 03:50:10 [DEBUG]  [cassandra_node_08]: SSH command took 0 sec
May05 03:50:10 [DEBUG]  [cassandra_node_08]: command returned:

 	$:  


May05 03:50:10 [DEBUG]  [cassandra_node_08]: running SSH command:

     echo '
     10.0.0.35 cassandra_seednode
     10.0.0.18 cassandra_node_11
     10.0.0.30 cassandra_node_10
     10.0.0.32 cassandra_node_15
     10.0.0.39 cassandra_node_16
     10.0.0.43 cassandra_node_17
     10.0.0.35 cassandra_seed_0
     10.0.0.17 cassandra_node_09
     10.0.0.13 cassandra_node_08
     10.0.0.40 cassandra_node_18
     10.0.0.20 cassandra_node_19
     10.0.0.42 cassandra_node_12
     10.0.0.33 cassandra_node_14
     10.0.0.31 cassandra_node_01
     10.0.0.41 cassandra_node_13
     10.0.0.11 cassandra_node_03
     10.0.0.38 cassandra_node_02
     10.0.0.16 cassandra_node_05
     10.0.0.45 cassandra_node_04
     10.0.0.37 cassandra_node_07
     10.0.0.44 cassandra_node_06' >> /etc/hosts; echo cassandra_node_08 >/etc/hostname


May05 03:50:10 [DEBUG]  [cassandra_node_08]: Connecting to SSH
May05 03:50:11 [DEBUG]  [cassandra_node_08]: connected in 0 sec. Running SSH command
May05 03:50:11 [DEBUG]  [cassandra_node_08]: SSH command took 0 sec
May05 03:50:11 [DEBUG]  [cassandra_node_08]: command returned:

 	$:  


May05 04:05:40 [DEBUG]  [cassandra_node_08]: running SSH command:

     sed -i "/.*cassandra.*/g" /etc/hosts; sed -i "/^$/d" /etc/hosts


May05 04:05:40 [DEBUG]  [cassandra_node_08]: Connecting to SSH
May05 04:05:40 [DEBUG]  [cassandra_node_08]: connected in 0 sec. Running SSH command
May05 04:05:40 [DEBUG]  [cassandra_node_08]: SSH command took 0 sec
May05 04:05:40 [DEBUG]  [cassandra_node_08]: command returned:

 	$:  


May05 04:05:40 [DEBUG]  [cassandra_node_08]: running SSH command:

     echo '
     10.0.0.35 cassandra_seednode
     10.0.0.18 cassandra_node_11
     10.0.0.30 cassandra_node_10
     10.0.0.32 cassandra_node_15
     10.0.0.35 cassandra_seed_0
     10.0.0.17 cassandra_node_09
     10.0.0.13 cassandra_node_08
     10.0.0.42 cassandra_node_12
     10.0.0.33 cassandra_node_14
     10.0.0.31 cassandra_node_01
     10.0.0.41 cassandra_node_13
     10.0.0.11 cassandra_node_03
     10.0.0.38 cassandra_node_02
     10.0.0.16 cassandra_node_05
     10.0.0.45 cassandra_node_04
     10.0.0.37 cassandra_node_07
     10.0.0.44 cassandra_node_06' >> /etc/hosts; echo cassandra_node_08 >/etc/hostname


May05 04:05:40 [DEBUG]  [cassandra_node_08]: Connecting to SSH
May05 04:05:40 [DEBUG]  [cassandra_node_08]: connected in 0 sec. Running SSH command
May05 04:05:40 [DEBUG]  [cassandra_node_08]: SSH command took 0 sec
May05 04:05:40 [DEBUG]  [cassandra_node_08]: command returned:

 	$:  


May05 04:21:42 [DEBUG]  [cassandra_node_08]: running SSH command:

     sed -i "/.*cassandra.*/g" /etc/hosts; sed -i "/^$/d" /etc/hosts


May05 04:21:42 [DEBUG]  [cassandra_node_08]: Connecting to SSH
May05 04:21:42 [DEBUG]  [cassandra_node_08]: connected in 0 sec. Running SSH command
May05 04:21:42 [DEBUG]  [cassandra_node_08]: SSH command took 0 sec
May05 04:21:42 [DEBUG]  [cassandra_node_08]: command returned:

 	$:  


May05 04:21:42 [DEBUG]  [cassandra_node_08]: running SSH command:

     echo '
     10.0.0.35 cassandra_seednode
     10.0.0.18 cassandra_node_11
     10.0.0.30 cassandra_node_10
     10.0.0.35 cassandra_seed_0
     10.0.0.17 cassandra_node_09
     10.0.0.13 cassandra_node_08
     10.0.0.31 cassandra_node_01
     10.0.0.11 cassandra_node_03
     10.0.0.38 cassandra_node_02
     10.0.0.16 cassandra_node_05
     10.0.0.45 cassandra_node_04
     10.0.0.37 cassandra_node_07
     10.0.0.44 cassandra_node_06' >> /etc/hosts; echo cassandra_node_08 >/etc/hostname


May05 04:21:42 [DEBUG]  [cassandra_node_08]: Connecting to SSH
May05 04:21:42 [DEBUG]  [cassandra_node_08]: connected in 0 sec. Running SSH command
May05 04:21:42 [DEBUG]  [cassandra_node_08]: SSH command took 0 sec
May05 04:21:42 [DEBUG]  [cassandra_node_08]: command returned:

 	$:  


May05 04:36:21 [ INFO]  [cassandra_node_08]: running decommission script
May05 04:36:21 [DEBUG]  [cassandra_node_08]: running SSH command:

     #!/bin/sh
     nodetool repair -h 127.0.0.1 ycsb
     nodetool decommission
     #kill cassandra
     CAS_PID=$(jps | grep CassandraDaemon | awk  '{print $1}')
     echo "CTOOL: Killing CassandraDaemon ($CAS_PID)" >> ctool.log
     kill $CAS_PID &>/dev/null
     
     
     #report not alive
     gmetric -n alive -v 0 -t int32 -u nodes -d 10000
     


May05 04:36:21 [DEBUG]  [cassandra_node_08]: Connecting to SSH
May05 04:36:21 [DEBUG]  [cassandra_node_08]: connected in 0 sec. Running SSH command
May05 04:40:34 [DEBUG]  [cassandra_node_08]: SSH command took 252 sec
May05 04:40:34 [DEBUG]  [cassandra_node_08]: command returned:

 	$:  [2014-05-05 04:36:29,106] Starting repair command #1, repairing 256 ranges for keyspace ycsb
	$:  [2014-05-05 04:36:33,507] Repair command #1 finished
	$:  


May05 04:40:34 [ INFO]  [cassandra_node_08]: now decommissioned (took 253 sec)
May05 04:46:01 [ INFO]  [cassandra_node_08]: Waiting for SSH daemon (83.212.118.12)
May05 04:46:01 [DEBUG]  [cassandra_node_08]: end time:2014-05-05 04:56:01.724983
May05 04:46:01 [DEBUG]  [cassandra_node_08]: ssh attempt:1
May05 04:46:01 [DEBUG]  [cassandra_node_08]: Connecting to SSH
May05 04:46:01 [DEBUG]  [cassandra_node_08]: connected in 0 sec. Running SSH command
May05 04:46:02 [DEBUG]  [cassandra_node_08]: SSH command took 0 sec
May05 04:46:02 [ INFO]  [cassandra_node_08]: now ready (took 0 sec)
May05 04:46:02 [DEBUG]  [cassandra_node_08]: running SSH command:

     sed -i "/.*cassandra.*/g" /etc/hosts; sed -i "/^$/d" /etc/hosts


May05 04:46:02 [DEBUG]  [cassandra_node_08]: Connecting to SSH
May05 04:46:02 [DEBUG]  [cassandra_node_08]: connected in 0 sec. Running SSH command
May05 04:46:02 [DEBUG]  [cassandra_node_08]: SSH command took 0 sec
May05 04:46:02 [DEBUG]  [cassandra_node_08]: command returned:

 	$:  


May05 04:46:02 [DEBUG]  [cassandra_node_08]: running SSH command:

     echo '
     10.0.0.35 cassandra_seednode
     10.0.0.35 cassandra_seed_0
     10.0.0.13 cassandra_node_08
     10.0.0.31 cassandra_node_01
     10.0.0.11 cassandra_node_03
     10.0.0.38 cassandra_node_02
     10.0.0.16 cassandra_node_05
     10.0.0.45 cassandra_node_04
     10.0.0.37 cassandra_node_07
     10.0.0.44 cassandra_node_06' >> /etc/hosts; echo cassandra_node_08 >/etc/hostname


May05 04:46:02 [DEBUG]  [cassandra_node_08]: Connecting to SSH
May05 04:46:02 [DEBUG]  [cassandra_node_08]: connected in 0 sec. Running SSH command
May05 04:46:02 [DEBUG]  [cassandra_node_08]: SSH command took 0 sec
May05 04:46:02 [DEBUG]  [cassandra_node_08]: command returned:

 	$:  


May05 04:46:02 [ INFO]  [cassandra_node_08]: running bootstrap script
May05 04:46:02 [DEBUG]  [cassandra_node_08]: running SSH command:

     #!/bin/bash
     
     MAX_WAIT=300  #5 min
     
     echo "started bootstrap" > bootsrap.log
     
     # check the seednode
     if ! ping -q -c 1 cassandra_seednode &>/dev/null   ;
     then
     echo CTOOL: ERROR - cassandra_seednode not pingable, exiting
     exit -1
     fi
     
     # kill the cassandra process
     CAS_PID=$(jps | grep CassandraDaemon | awk  '{print $1}')
     echo "CTOOL: Killing CassandraDaemon ($CAS_PID)"
     kill -9 $CAS_PID
     
     # clean previous files and logs
     echo "Removing cassandra files and logs"
     #cleaning cassandra files
     rm -rf /var/lib/cassandra/*
     rm /var/log/cassandra/system.log
     #cleaning ctool rrds
     echo "Removing ganglia rrds"
     rm -rf /var/lib/ganglia/rrds/*
     rm /var/log/cassandra/system.log
     
     # find my IP
     my_priv_addr=""
     #look for an IPv4 interface in range 10.0 and use that for the cassandra communication
     let if_count=($(ifconfig | grep eth | wc -l ))-1
     for i in $(seq 0 $if_count)
     do	#look for IPv4 address
     line=$(ifconfig eth$i | grep "inet addr:")
     line=$(echo $line | awk '{print $2}')
     address=$(echo $line | sed 's/addr://g')
     if [[ "$address" == 10.0.* ]] ;
     then
     my_priv_addr=$address
     break
     fi
     done
     
     # configure cassandra
     echo "configuring cassandra.yaml for my address:$my_priv_addr" >> ctool.log
     #change the listen address of this node
     sed "s/listen_address: .*/listen_address: $my_priv_addr/g"  /etc/cassandra/cassandra.yaml> tmp && mv tmp /etc/cassandra/cassandra.yaml
     #change the rpc_address of this node to 0.0.0.0
     sed "s/rpc_address: .*/rpc_address: 0.0.0.0/g"  /etc/cassandra/cassandra.yaml> tmp && mv tmp /etc/cassandra/cassandra.yaml
     #change the seeds to "cassandra_seednode"
     sed "s/seeds: .*/seeds: \"cassandra_seednode\"/g"  /etc/cassandra/cassandra.yaml> tmp && mv tmp /etc/cassandra/cassandra.yaml
     #add the jmx server whatever to cassandra-env.sh
     sed -i.bak "s/.*-Djava.rmi.server.hostname=.*/JVM_OPTS=\"\$JVM_OPTS -Djava.rmi.server.hostname=$my_priv_addr\"/g"  /etc/cassandra/cassandra-env.sh
     sed -i.bak "s/*JVM_OPTS=\"\$JVM_OPTS -Djava.rmi.server.hostname=*\"/JVM_OPTS=\"\$JVM_OPTS -Djava.rmi.server.hostname=$my_priv_addr\"/g"  /etc/cassandra/cassandra-env.sh
     #make sure no requests are dropped by using a big timeout
     sed -i.bak "s/read_request_timeout_in_ms:.*/read_request_timeout_in_ms: 50000/g" /etc/cassandra/cassandra.yaml
     sed -i.bak "s/write_request_timeout_in_ms:.*/write_request_timeout_in_ms: 50000/g" /etc/cassandra/cassandra.yaml
     echo "CTOOL: Done configuring"
     
     
     # start cassandra
     chmod -R o+rw /var/lib/cassandra
     echo Starting casandra service, ganglia-monitor
     service cassandra start
     service ganglia-monitor restart
     
     #wait until ready and try to create keyspace
     echo "Attempting to create ycsb keyspace"
     echo "create keyspace ycsb  WITH REPLICATION = {'class' : 'SimpleStrategy', 'replication_factor': 1 }; use ycsb;  create table usertable (y_id varchar primary key, field0 varchar, field1 varchar, field2 varchar, field3 varchar, field4 varchar, field5 varchar, field6 varchar, field7 varchar, field8 varchar, field9 varchar);" > ycsb_cql.temp
     while ! cqlsh < ycsb_cql.temp 2>/dev/null;do sleep 2; done
     rm ycsb_cql.temp
     
     echo "ended bootstrap" >> bootsrap.log
     
     #report alive in gmetric
     gmetric -n alive -v 1 -t int32 -u nodes -d 10000
     
     
     


May05 04:46:02 [DEBUG]  [cassandra_node_08]: Connecting to SSH
May05 04:46:02 [DEBUG]  [cassandra_node_08]: connected in 0 sec. Running SSH command
May05 04:50:31 [DEBUG]  [cassandra_node_08]: SSH command took 268 sec
May05 04:50:31 [DEBUG]  [cassandra_node_08]: command returned:

 	$:  CTOOL: Killing CassandraDaemon ()
	$:  Removing cassandra files and logs
	$:  Removing ganglia rrds
	$:  CTOOL: Done configuring
	$:  Starting casandra service, ganglia-monitor
	$:  Stopping Ganglia Monitor Daemon: gmond.
	$:  Starting Ganglia Monitor Daemon: gmond.
	$:  Attempting to create ycsb keyspace
	$:  kill: usage: kill [-s sigspec | -n signum | -sigspec] pid | jobspec ... or kill -l [sigspec]
	$:  rm: cannot remove `/var/log/cassandra/system.log': No such file or directory
	$:  


May05 04:50:31 [DEBUG]  [cassandra_node_08]: command returned:
	$:  CTOOL: Killing CassandraDaemon ()
	$:  Removing cassandra files and logs
	$:  Removing ganglia rrds
	$:  CTOOL: Done configuring
	$:  Starting casandra service, ganglia-monitor
	$:  Stopping Ganglia Monitor Daemon: gmond.
	$:  Starting Ganglia Monitor Daemon: gmond.
	$:  Attempting to create ycsb keyspace
	$:  kill: usage: kill [-s sigspec | -n signum | -sigspec] pid | jobspec ... or kill -l [sigspec]
	$:  rm: cannot remove `/var/log/cassandra/system.log': No such file or directory
	$:  
May05 04:50:31 [ INFO]  [cassandra_node_08]: is now bootstrapped (took 269 sec)
May05 04:50:40 [DEBUG]  [cassandra_node_08]: running SSH command:

     sed -i "/.*cassandra.*/g" /etc/hosts; sed -i "/^$/d" /etc/hosts


May05 04:50:40 [DEBUG]  [cassandra_node_08]: Connecting to SSH
May05 04:50:40 [DEBUG]  [cassandra_node_08]: connected in 0 sec. Running SSH command
May05 04:50:41 [DEBUG]  [cassandra_node_08]: SSH command took 0 sec
May05 04:50:41 [DEBUG]  [cassandra_node_08]: command returned:

 	$:  


May05 04:50:41 [DEBUG]  [cassandra_node_08]: running SSH command:

     echo '
     10.0.0.35 cassandra_seednode
     10.0.0.35 cassandra_seed_0
     10.0.0.13 cassandra_node_08
     10.0.0.31 cassandra_node_01
     10.0.0.11 cassandra_node_03
     10.0.0.38 cassandra_node_02
     10.0.0.16 cassandra_node_05
     10.0.0.45 cassandra_node_04
     10.0.0.37 cassandra_node_07
     10.0.0.44 cassandra_node_06' >> /etc/hosts; echo cassandra_node_08 >/etc/hostname


May05 04:50:41 [DEBUG]  [cassandra_node_08]: Connecting to SSH
May05 04:50:42 [DEBUG]  [cassandra_node_08]: connected in 0 sec. Running SSH command
May05 04:50:42 [DEBUG]  [cassandra_node_08]: SSH command took 0 sec
May05 04:50:42 [DEBUG]  [cassandra_node_08]: command returned:

 	$:  


May05 05:00:53 [DEBUG]  [cassandra_node_08]: running SSH command:

     sed -i "/.*cassandra.*/g" /etc/hosts; sed -i "/^$/d" /etc/hosts


May05 05:00:53 [DEBUG]  [cassandra_node_08]: Connecting to SSH
May05 05:00:54 [DEBUG]  [cassandra_node_08]: connected in 0 sec. Running SSH command
May05 05:00:54 [DEBUG]  [cassandra_node_08]: SSH command took 0 sec
May05 05:00:54 [DEBUG]  [cassandra_node_08]: command returned:

 	$:  


May05 05:00:54 [DEBUG]  [cassandra_node_08]: running SSH command:

     echo '
     10.0.0.35 cassandra_seednode
     10.0.0.35 cassandra_seed_0
     10.0.0.17 cassandra_node_09
     10.0.0.13 cassandra_node_08
     10.0.0.31 cassandra_node_01
     10.0.0.11 cassandra_node_03
     10.0.0.38 cassandra_node_02
     10.0.0.16 cassandra_node_05
     10.0.0.45 cassandra_node_04
     10.0.0.37 cassandra_node_07
     10.0.0.44 cassandra_node_06' >> /etc/hosts; echo cassandra_node_08 >/etc/hostname


May05 05:00:54 [DEBUG]  [cassandra_node_08]: Connecting to SSH
May05 05:00:54 [DEBUG]  [cassandra_node_08]: connected in 0 sec. Running SSH command
May05 05:00:55 [DEBUG]  [cassandra_node_08]: SSH command took 0 sec
May05 05:00:55 [DEBUG]  [cassandra_node_08]: command returned:

 	$:  


May05 05:10:27 [DEBUG]  [cassandra_node_08]: running SSH command:

     sed -i "/.*cassandra.*/g" /etc/hosts; sed -i "/^$/d" /etc/hosts


May05 05:10:27 [DEBUG]  [cassandra_node_08]: Connecting to SSH
May05 05:10:27 [DEBUG]  [cassandra_node_08]: connected in 0 sec. Running SSH command
May05 05:10:27 [DEBUG]  [cassandra_node_08]: SSH command took 0 sec
May05 05:10:27 [DEBUG]  [cassandra_node_08]: command returned:

 	$:  


May05 05:10:27 [DEBUG]  [cassandra_node_08]: running SSH command:

     echo '
     10.0.0.35 cassandra_seednode
     10.0.0.18 cassandra_node_11
     10.0.0.30 cassandra_node_10
     10.0.0.35 cassandra_seed_0
     10.0.0.17 cassandra_node_09
     10.0.0.13 cassandra_node_08
     10.0.0.42 cassandra_node_12
     10.0.0.31 cassandra_node_01
     10.0.0.41 cassandra_node_13
     10.0.0.11 cassandra_node_03
     10.0.0.38 cassandra_node_02
     10.0.0.16 cassandra_node_05
     10.0.0.45 cassandra_node_04
     10.0.0.37 cassandra_node_07
     10.0.0.44 cassandra_node_06' >> /etc/hosts; echo cassandra_node_08 >/etc/hostname


May05 05:10:27 [DEBUG]  [cassandra_node_08]: Connecting to SSH
May05 05:10:28 [DEBUG]  [cassandra_node_08]: connected in 0 sec. Running SSH command
May05 05:10:28 [DEBUG]  [cassandra_node_08]: SSH command took 0 sec
May05 05:10:28 [DEBUG]  [cassandra_node_08]: command returned:

 	$:  


May05 05:19:36 [DEBUG]  [cassandra_node_08]: running SSH command:

     sed -i "/.*cassandra.*/g" /etc/hosts; sed -i "/^$/d" /etc/hosts


May05 05:19:36 [DEBUG]  [cassandra_node_08]: Connecting to SSH
May05 05:19:36 [DEBUG]  [cassandra_node_08]: connected in 0 sec. Running SSH command
May05 05:19:37 [DEBUG]  [cassandra_node_08]: SSH command took 0 sec
May05 05:19:37 [DEBUG]  [cassandra_node_08]: command returned:

 	$:  


May05 05:19:37 [DEBUG]  [cassandra_node_08]: running SSH command:

     echo '
     10.0.0.35 cassandra_seednode
     10.0.0.18 cassandra_node_11
     10.0.0.30 cassandra_node_10
     10.0.0.32 cassandra_node_15
     10.0.0.39 cassandra_node_16
     10.0.0.43 cassandra_node_17
     10.0.0.35 cassandra_seed_0
     10.0.0.17 cassandra_node_09
     10.0.0.13 cassandra_node_08
     10.0.0.42 cassandra_node_12
     10.0.0.33 cassandra_node_14
     10.0.0.31 cassandra_node_01
     10.0.0.41 cassandra_node_13
     10.0.0.11 cassandra_node_03
     10.0.0.38 cassandra_node_02
     10.0.0.16 cassandra_node_05
     10.0.0.45 cassandra_node_04
     10.0.0.37 cassandra_node_07
     10.0.0.44 cassandra_node_06' >> /etc/hosts; echo cassandra_node_08 >/etc/hostname


May05 05:19:37 [DEBUG]  [cassandra_node_08]: Connecting to SSH
May05 05:19:37 [DEBUG]  [cassandra_node_08]: connected in 0 sec. Running SSH command
May05 05:19:37 [DEBUG]  [cassandra_node_08]: SSH command took 0 sec
May05 05:19:37 [DEBUG]  [cassandra_node_08]: command returned:

 	$:  


May05 05:28:27 [DEBUG]  [cassandra_node_08]: running SSH command:

     sed -i "/.*cassandra.*/g" /etc/hosts; sed -i "/^$/d" /etc/hosts


May05 05:28:27 [DEBUG]  [cassandra_node_08]: Connecting to SSH
May05 05:28:28 [DEBUG]  [cassandra_node_08]: connected in 0 sec. Running SSH command
May05 05:28:28 [DEBUG]  [cassandra_node_08]: SSH command took 0 sec
May05 05:28:28 [DEBUG]  [cassandra_node_08]: command returned:

 	$:  


May05 05:28:28 [DEBUG]  [cassandra_node_08]: running SSH command:

     echo '
     10.0.0.35 cassandra_seednode
     10.0.0.18 cassandra_node_11
     10.0.0.30 cassandra_node_10
     10.0.0.32 cassandra_node_15
     10.0.0.39 cassandra_node_16
     10.0.0.43 cassandra_node_17
     10.0.0.35 cassandra_seed_0
     10.0.0.17 cassandra_node_09
     10.0.0.13 cassandra_node_08
     10.0.0.40 cassandra_node_18
     10.0.0.20 cassandra_node_19
     10.0.0.42 cassandra_node_12
     10.0.0.33 cassandra_node_14
     10.0.0.31 cassandra_node_01
     10.0.0.41 cassandra_node_13
     10.0.0.11 cassandra_node_03
     10.0.0.38 cassandra_node_02
     10.0.0.16 cassandra_node_05
     10.0.0.45 cassandra_node_04
     10.0.0.37 cassandra_node_07
     10.0.0.44 cassandra_node_06' >> /etc/hosts; echo cassandra_node_08 >/etc/hostname


May05 05:28:28 [DEBUG]  [cassandra_node_08]: Connecting to SSH
May05 05:28:28 [DEBUG]  [cassandra_node_08]: connected in 0 sec. Running SSH command
May05 05:28:29 [DEBUG]  [cassandra_node_08]: SSH command took 0 sec
May05 05:28:29 [DEBUG]  [cassandra_node_08]: command returned:

 	$:  


May05 05:37:32 [DEBUG]  [cassandra_node_08]: running SSH command:

     sed -i "/.*cassandra.*/g" /etc/hosts; sed -i "/^$/d" /etc/hosts


May05 05:37:32 [DEBUG]  [cassandra_node_08]: Connecting to SSH
May05 05:37:32 [DEBUG]  [cassandra_node_08]: connected in 0 sec. Running SSH command
May05 05:37:32 [DEBUG]  [cassandra_node_08]: SSH command took 0 sec
May05 05:37:32 [DEBUG]  [cassandra_node_08]: command returned:

 	$:  


May05 05:37:32 [DEBUG]  [cassandra_node_08]: running SSH command:

     echo '
     10.0.0.35 cassandra_seednode
     10.0.0.18 cassandra_node_11
     10.0.0.30 cassandra_node_10
     10.0.0.32 cassandra_node_15
     10.0.0.39 cassandra_node_16
     10.0.0.43 cassandra_node_17
     10.0.0.35 cassandra_seed_0
     10.0.0.17 cassandra_node_09
     10.0.0.13 cassandra_node_08
     10.0.0.40 cassandra_node_18
     10.0.0.42 cassandra_node_12
     10.0.0.33 cassandra_node_14
     10.0.0.31 cassandra_node_01
     10.0.0.41 cassandra_node_13
     10.0.0.11 cassandra_node_03
     10.0.0.38 cassandra_node_02
     10.0.0.16 cassandra_node_05
     10.0.0.45 cassandra_node_04
     10.0.0.37 cassandra_node_07
     10.0.0.44 cassandra_node_06' >> /etc/hosts; echo cassandra_node_08 >/etc/hostname


May05 05:37:32 [DEBUG]  [cassandra_node_08]: Connecting to SSH
May05 05:37:32 [DEBUG]  [cassandra_node_08]: connected in 0 sec. Running SSH command
May05 05:37:32 [DEBUG]  [cassandra_node_08]: SSH command took 0 sec
May05 05:37:32 [DEBUG]  [cassandra_node_08]: command returned:

 	$:  


May05 05:48:44 [DEBUG]  [cassandra_node_08]: running SSH command:

     sed -i "/.*cassandra.*/g" /etc/hosts; sed -i "/^$/d" /etc/hosts


May05 05:48:44 [DEBUG]  [cassandra_node_08]: Connecting to SSH
May05 05:48:44 [DEBUG]  [cassandra_node_08]: connected in 0 sec. Running SSH command
May05 05:48:44 [DEBUG]  [cassandra_node_08]: SSH command took 0 sec
May05 05:48:44 [DEBUG]  [cassandra_node_08]: command returned:

 	$:  


May05 05:48:44 [DEBUG]  [cassandra_node_08]: running SSH command:

     echo '
     10.0.0.35 cassandra_seednode
     10.0.0.18 cassandra_node_11
     10.0.0.30 cassandra_node_10
     10.0.0.32 cassandra_node_15
     10.0.0.39 cassandra_node_16
     10.0.0.35 cassandra_seed_0
     10.0.0.17 cassandra_node_09
     10.0.0.13 cassandra_node_08
     10.0.0.42 cassandra_node_12
     10.0.0.33 cassandra_node_14
     10.0.0.31 cassandra_node_01
     10.0.0.41 cassandra_node_13
     10.0.0.11 cassandra_node_03
     10.0.0.38 cassandra_node_02
     10.0.0.16 cassandra_node_05
     10.0.0.45 cassandra_node_04
     10.0.0.37 cassandra_node_07
     10.0.0.44 cassandra_node_06' >> /etc/hosts; echo cassandra_node_08 >/etc/hostname


May05 05:48:44 [DEBUG]  [cassandra_node_08]: Connecting to SSH
May05 05:48:45 [DEBUG]  [cassandra_node_08]: connected in 0 sec. Running SSH command
May05 05:48:45 [DEBUG]  [cassandra_node_08]: SSH command took 0 sec
May05 05:48:45 [DEBUG]  [cassandra_node_08]: command returned:

 	$:  


May05 05:57:21 [DEBUG]  [cassandra_node_08]: running SSH command:

     sed -i "/.*cassandra.*/g" /etc/hosts; sed -i "/^$/d" /etc/hosts


May05 05:57:21 [DEBUG]  [cassandra_node_08]: Connecting to SSH
May05 05:57:21 [DEBUG]  [cassandra_node_08]: connected in 0 sec. Running SSH command
May05 05:57:21 [DEBUG]  [cassandra_node_08]: SSH command took 0 sec
May05 05:57:21 [DEBUG]  [cassandra_node_08]: command returned:

 	$:  


May05 05:57:21 [DEBUG]  [cassandra_node_08]: running SSH command:

     echo '
     10.0.0.35 cassandra_seednode
     10.0.0.18 cassandra_node_11
     10.0.0.30 cassandra_node_10
     10.0.0.32 cassandra_node_15
     10.0.0.39 cassandra_node_16
     10.0.0.43 cassandra_node_17
     10.0.0.35 cassandra_seed_0
     10.0.0.17 cassandra_node_09
     10.0.0.13 cassandra_node_08
     10.0.0.40 cassandra_node_18
     10.0.0.42 cassandra_node_12
     10.0.0.33 cassandra_node_14
     10.0.0.31 cassandra_node_01
     10.0.0.41 cassandra_node_13
     10.0.0.11 cassandra_node_03
     10.0.0.38 cassandra_node_02
     10.0.0.16 cassandra_node_05
     10.0.0.45 cassandra_node_04
     10.0.0.37 cassandra_node_07
     10.0.0.44 cassandra_node_06' >> /etc/hosts; echo cassandra_node_08 >/etc/hostname


May05 05:57:21 [DEBUG]  [cassandra_node_08]: Connecting to SSH
May05 05:57:22 [DEBUG]  [cassandra_node_08]: connected in 0 sec. Running SSH command
May05 05:57:22 [DEBUG]  [cassandra_node_08]: SSH command took 0 sec
May05 05:57:22 [DEBUG]  [cassandra_node_08]: command returned:

 	$:  


May05 06:12:52 [DEBUG]  [cassandra_node_08]: running SSH command:

     sed -i "/.*cassandra.*/g" /etc/hosts; sed -i "/^$/d" /etc/hosts


May05 06:12:52 [DEBUG]  [cassandra_node_08]: Connecting to SSH
May05 06:12:52 [DEBUG]  [cassandra_node_08]: connected in 0 sec. Running SSH command
May05 06:12:52 [DEBUG]  [cassandra_node_08]: SSH command took 0 sec
May05 06:12:52 [DEBUG]  [cassandra_node_08]: command returned:

 	$:  


May05 06:12:52 [DEBUG]  [cassandra_node_08]: running SSH command:

     echo '
     10.0.0.35 cassandra_seednode
     10.0.0.18 cassandra_node_11
     10.0.0.30 cassandra_node_10
     10.0.0.35 cassandra_seed_0
     10.0.0.17 cassandra_node_09
     10.0.0.13 cassandra_node_08
     10.0.0.42 cassandra_node_12
     10.0.0.33 cassandra_node_14
     10.0.0.31 cassandra_node_01
     10.0.0.41 cassandra_node_13
     10.0.0.11 cassandra_node_03
     10.0.0.38 cassandra_node_02
     10.0.0.16 cassandra_node_05
     10.0.0.45 cassandra_node_04
     10.0.0.37 cassandra_node_07
     10.0.0.44 cassandra_node_06' >> /etc/hosts; echo cassandra_node_08 >/etc/hostname


May05 06:12:52 [DEBUG]  [cassandra_node_08]: Connecting to SSH
May05 06:12:52 [DEBUG]  [cassandra_node_08]: connected in 0 sec. Running SSH command
May05 06:12:52 [DEBUG]  [cassandra_node_08]: SSH command took 0 sec
May05 06:12:52 [DEBUG]  [cassandra_node_08]: command returned:

 	$:  


May05 06:28:50 [DEBUG]  [cassandra_node_08]: running SSH command:

     sed -i "/.*cassandra.*/g" /etc/hosts; sed -i "/^$/d" /etc/hosts


May05 06:28:50 [DEBUG]  [cassandra_node_08]: Connecting to SSH
May05 06:28:51 [DEBUG]  [cassandra_node_08]: connected in 0 sec. Running SSH command
May05 06:28:51 [DEBUG]  [cassandra_node_08]: SSH command took 0 sec
May05 06:28:51 [DEBUG]  [cassandra_node_08]: command returned:

 	$:  


May05 06:28:51 [DEBUG]  [cassandra_node_08]: running SSH command:

     echo '
     10.0.0.35 cassandra_seednode
     10.0.0.30 cassandra_node_10
     10.0.0.35 cassandra_seed_0
     10.0.0.17 cassandra_node_09
     10.0.0.13 cassandra_node_08
     10.0.0.31 cassandra_node_01
     10.0.0.11 cassandra_node_03
     10.0.0.38 cassandra_node_02
     10.0.0.16 cassandra_node_05
     10.0.0.45 cassandra_node_04
     10.0.0.37 cassandra_node_07
     10.0.0.44 cassandra_node_06' >> /etc/hosts; echo cassandra_node_08 >/etc/hostname


May05 06:28:51 [DEBUG]  [cassandra_node_08]: Connecting to SSH
May05 06:28:51 [DEBUG]  [cassandra_node_08]: connected in 0 sec. Running SSH command
May05 06:28:51 [DEBUG]  [cassandra_node_08]: SSH command took 0 sec
May05 06:28:51 [DEBUG]  [cassandra_node_08]: command returned:

 	$:  


May05 06:40:21 [ INFO]  [cassandra_node_08]: running decommission script
May05 06:40:21 [DEBUG]  [cassandra_node_08]: running SSH command:

     #!/bin/sh
     nodetool repair -h 127.0.0.1 ycsb
     nodetool decommission
     #kill cassandra
     CAS_PID=$(jps | grep CassandraDaemon | awk  '{print $1}')
     echo "CTOOL: Killing CassandraDaemon ($CAS_PID)" >> ctool.log
     kill $CAS_PID &>/dev/null
     
     
     #report not alive
     gmetric -n alive -v 0 -t int32 -u nodes -d 10000
     


May05 06:40:21 [DEBUG]  [cassandra_node_08]: Connecting to SSH
May05 06:40:21 [DEBUG]  [cassandra_node_08]: connected in 0 sec. Running SSH command
May05 06:43:49 [DEBUG]  [cassandra_node_08]: SSH command took 208 sec
May05 06:43:49 [DEBUG]  [cassandra_node_08]: command returned:

 	$:  [2014-05-05 06:40:28,593] Starting repair command #1, repairing 256 ranges for keyspace ycsb
	$:  [2014-05-05 06:40:32,642] Repair command #1 finished
	$:  


May05 06:43:49 [ INFO]  [cassandra_node_08]: now decommissioned (took 208 sec)
May05 06:49:11 [ INFO]  [cassandra_node_08]: Waiting for SSH daemon (83.212.118.12)
May05 06:49:11 [DEBUG]  [cassandra_node_08]: end time:2014-05-05 06:59:11.145151
May05 06:49:11 [DEBUG]  [cassandra_node_08]: ssh attempt:1
May05 06:49:11 [DEBUG]  [cassandra_node_08]: Connecting to SSH
May05 06:49:11 [DEBUG]  [cassandra_node_08]: connected in 0 sec. Running SSH command
May05 06:49:11 [DEBUG]  [cassandra_node_08]: SSH command took 0 sec
May05 06:49:11 [ INFO]  [cassandra_node_08]: now ready (took 0 sec)
May05 06:49:11 [DEBUG]  [cassandra_node_08]: running SSH command:

     sed -i "/.*cassandra.*/g" /etc/hosts; sed -i "/^$/d" /etc/hosts


May05 06:49:11 [DEBUG]  [cassandra_node_08]: Connecting to SSH
May05 06:49:11 [DEBUG]  [cassandra_node_08]: connected in 0 sec. Running SSH command
May05 06:49:11 [DEBUG]  [cassandra_node_08]: SSH command took 0 sec
May05 06:49:11 [DEBUG]  [cassandra_node_08]: command returned:

 	$:  


May05 06:49:11 [DEBUG]  [cassandra_node_08]: running SSH command:

     echo '
     10.0.0.35 cassandra_seednode
     10.0.0.35 cassandra_seed_0
     10.0.0.13 cassandra_node_08
     10.0.0.31 cassandra_node_01
     10.0.0.11 cassandra_node_03
     10.0.0.38 cassandra_node_02
     10.0.0.16 cassandra_node_05
     10.0.0.45 cassandra_node_04
     10.0.0.37 cassandra_node_07
     10.0.0.44 cassandra_node_06' >> /etc/hosts; echo cassandra_node_08 >/etc/hostname


May05 06:49:11 [DEBUG]  [cassandra_node_08]: Connecting to SSH
May05 06:49:11 [DEBUG]  [cassandra_node_08]: connected in 0 sec. Running SSH command
May05 06:49:11 [DEBUG]  [cassandra_node_08]: SSH command took 0 sec
May05 06:49:11 [DEBUG]  [cassandra_node_08]: command returned:

 	$:  


May05 06:49:11 [ INFO]  [cassandra_node_08]: running bootstrap script
May05 06:49:11 [DEBUG]  [cassandra_node_08]: running SSH command:

     #!/bin/bash
     
     MAX_WAIT=300  #5 min
     
     echo "started bootstrap" > bootsrap.log
     
     # check the seednode
     if ! ping -q -c 1 cassandra_seednode &>/dev/null   ;
     then
     echo CTOOL: ERROR - cassandra_seednode not pingable, exiting
     exit -1
     fi
     
     # kill the cassandra process
     CAS_PID=$(jps | grep CassandraDaemon | awk  '{print $1}')
     echo "CTOOL: Killing CassandraDaemon ($CAS_PID)"
     kill -9 $CAS_PID
     
     # clean previous files and logs
     echo "Removing cassandra files and logs"
     #cleaning cassandra files
     rm -rf /var/lib/cassandra/*
     rm /var/log/cassandra/system.log
     #cleaning ctool rrds
     echo "Removing ganglia rrds"
     rm -rf /var/lib/ganglia/rrds/*
     rm /var/log/cassandra/system.log
     
     # find my IP
     my_priv_addr=""
     #look for an IPv4 interface in range 10.0 and use that for the cassandra communication
     let if_count=($(ifconfig | grep eth | wc -l ))-1
     for i in $(seq 0 $if_count)
     do	#look for IPv4 address
     line=$(ifconfig eth$i | grep "inet addr:")
     line=$(echo $line | awk '{print $2}')
     address=$(echo $line | sed 's/addr://g')
     if [[ "$address" == 10.0.* ]] ;
     then
     my_priv_addr=$address
     break
     fi
     done
     
     # configure cassandra
     echo "configuring cassandra.yaml for my address:$my_priv_addr" >> ctool.log
     #change the listen address of this node
     sed "s/listen_address: .*/listen_address: $my_priv_addr/g"  /etc/cassandra/cassandra.yaml> tmp && mv tmp /etc/cassandra/cassandra.yaml
     #change the rpc_address of this node to 0.0.0.0
     sed "s/rpc_address: .*/rpc_address: 0.0.0.0/g"  /etc/cassandra/cassandra.yaml> tmp && mv tmp /etc/cassandra/cassandra.yaml
     #change the seeds to "cassandra_seednode"
     sed "s/seeds: .*/seeds: \"cassandra_seednode\"/g"  /etc/cassandra/cassandra.yaml> tmp && mv tmp /etc/cassandra/cassandra.yaml
     #add the jmx server whatever to cassandra-env.sh
     sed -i.bak "s/.*-Djava.rmi.server.hostname=.*/JVM_OPTS=\"\$JVM_OPTS -Djava.rmi.server.hostname=$my_priv_addr\"/g"  /etc/cassandra/cassandra-env.sh
     sed -i.bak "s/*JVM_OPTS=\"\$JVM_OPTS -Djava.rmi.server.hostname=*\"/JVM_OPTS=\"\$JVM_OPTS -Djava.rmi.server.hostname=$my_priv_addr\"/g"  /etc/cassandra/cassandra-env.sh
     #make sure no requests are dropped by using a big timeout
     sed -i.bak "s/read_request_timeout_in_ms:.*/read_request_timeout_in_ms: 50000/g" /etc/cassandra/cassandra.yaml
     sed -i.bak "s/write_request_timeout_in_ms:.*/write_request_timeout_in_ms: 50000/g" /etc/cassandra/cassandra.yaml
     echo "CTOOL: Done configuring"
     
     
     # start cassandra
     chmod -R o+rw /var/lib/cassandra
     echo Starting casandra service, ganglia-monitor
     service cassandra start
     service ganglia-monitor restart
     
     #wait until ready and try to create keyspace
     echo "Attempting to create ycsb keyspace"
     echo "create keyspace ycsb  WITH REPLICATION = {'class' : 'SimpleStrategy', 'replication_factor': 1 }; use ycsb;  create table usertable (y_id varchar primary key, field0 varchar, field1 varchar, field2 varchar, field3 varchar, field4 varchar, field5 varchar, field6 varchar, field7 varchar, field8 varchar, field9 varchar);" > ycsb_cql.temp
     while ! cqlsh < ycsb_cql.temp 2>/dev/null;do sleep 2; done
     rm ycsb_cql.temp
     
     echo "ended bootstrap" >> bootsrap.log
     
     #report alive in gmetric
     gmetric -n alive -v 1 -t int32 -u nodes -d 10000
     
     
     


May05 06:49:11 [DEBUG]  [cassandra_node_08]: Connecting to SSH
May05 06:49:11 [DEBUG]  [cassandra_node_08]: connected in 0 sec. Running SSH command
May05 06:54:18 [DEBUG]  [cassandra_node_08]: SSH command took 306 sec
May05 06:54:18 [DEBUG]  [cassandra_node_08]: command returned:

 	$:  CTOOL: Killing CassandraDaemon ()
	$:  Removing cassandra files and logs
	$:  Removing ganglia rrds
	$:  CTOOL: Done configuring
	$:  Starting casandra service, ganglia-monitor
	$:  Stopping Ganglia Monitor Daemon: gmond.
	$:  Starting Ganglia Monitor Daemon: gmond.
	$:  Attempting to create ycsb keyspace
	$:  kill: usage: kill [-s sigspec | -n signum | -sigspec] pid | jobspec ... or kill -l [sigspec]
	$:  rm: cannot remove `/var/log/cassandra/system.log': No such file or directory
	$:  


May05 06:54:18 [DEBUG]  [cassandra_node_08]: command returned:
	$:  CTOOL: Killing CassandraDaemon ()
	$:  Removing cassandra files and logs
	$:  Removing ganglia rrds
	$:  CTOOL: Done configuring
	$:  Starting casandra service, ganglia-monitor
	$:  Stopping Ganglia Monitor Daemon: gmond.
	$:  Starting Ganglia Monitor Daemon: gmond.
	$:  Attempting to create ycsb keyspace
	$:  kill: usage: kill [-s sigspec | -n signum | -sigspec] pid | jobspec ... or kill -l [sigspec]
	$:  rm: cannot remove `/var/log/cassandra/system.log': No such file or directory
	$:  
May05 06:54:18 [ INFO]  [cassandra_node_08]: is now bootstrapped (took 306 sec)
May05 06:54:30 [DEBUG]  [cassandra_node_08]: running SSH command:

     sed -i "/.*cassandra.*/g" /etc/hosts; sed -i "/^$/d" /etc/hosts


May05 06:54:30 [DEBUG]  [cassandra_node_08]: Connecting to SSH
May05 06:54:30 [DEBUG]  [cassandra_node_08]: connected in 0 sec. Running SSH command
May05 06:54:31 [DEBUG]  [cassandra_node_08]: SSH command took 0 sec
May05 06:54:31 [DEBUG]  [cassandra_node_08]: command returned:

 	$:  


May05 06:54:31 [DEBUG]  [cassandra_node_08]: running SSH command:

     echo '
     10.0.0.35 cassandra_seednode
     10.0.0.35 cassandra_seed_0
     10.0.0.13 cassandra_node_08
     10.0.0.31 cassandra_node_01
     10.0.0.11 cassandra_node_03
     10.0.0.38 cassandra_node_02
     10.0.0.16 cassandra_node_05
     10.0.0.45 cassandra_node_04
     10.0.0.37 cassandra_node_07
     10.0.0.44 cassandra_node_06' >> /etc/hosts; echo cassandra_node_08 >/etc/hostname


May05 06:54:31 [DEBUG]  [cassandra_node_08]: Connecting to SSH
May05 06:54:31 [DEBUG]  [cassandra_node_08]: connected in 0 sec. Running SSH command
May05 06:54:32 [DEBUG]  [cassandra_node_08]: SSH command took 0 sec
May05 06:54:32 [DEBUG]  [cassandra_node_08]: command returned:

 	$:  


May05 07:04:58 [DEBUG]  [cassandra_node_08]: running SSH command:

     sed -i "/.*cassandra.*/g" /etc/hosts; sed -i "/^$/d" /etc/hosts


May05 07:04:58 [DEBUG]  [cassandra_node_08]: Connecting to SSH
May05 07:04:59 [DEBUG]  [cassandra_node_08]: connected in 0 sec. Running SSH command
May05 07:04:59 [DEBUG]  [cassandra_node_08]: SSH command took 0 sec
May05 07:04:59 [DEBUG]  [cassandra_node_08]: command returned:

 	$:  


May05 07:04:59 [DEBUG]  [cassandra_node_08]: running SSH command:

     echo '
     10.0.0.35 cassandra_seednode
     10.0.0.30 cassandra_node_10
     10.0.0.35 cassandra_seed_0
     10.0.0.17 cassandra_node_09
     10.0.0.13 cassandra_node_08
     10.0.0.31 cassandra_node_01
     10.0.0.11 cassandra_node_03
     10.0.0.38 cassandra_node_02
     10.0.0.16 cassandra_node_05
     10.0.0.45 cassandra_node_04
     10.0.0.37 cassandra_node_07
     10.0.0.44 cassandra_node_06' >> /etc/hosts; echo cassandra_node_08 >/etc/hostname


May05 07:04:59 [DEBUG]  [cassandra_node_08]: Connecting to SSH
May05 07:05:00 [DEBUG]  [cassandra_node_08]: connected in 0 sec. Running SSH command
May05 07:05:00 [DEBUG]  [cassandra_node_08]: SSH command took 0 sec
May05 07:05:00 [DEBUG]  [cassandra_node_08]: command returned:

 	$:  


May05 07:15:03 [DEBUG]  [cassandra_node_08]: running SSH command:

     sed -i "/.*cassandra.*/g" /etc/hosts; sed -i "/^$/d" /etc/hosts


May05 07:15:03 [DEBUG]  [cassandra_node_08]: Connecting to SSH
May05 07:15:04 [DEBUG]  [cassandra_node_08]: connected in 0 sec. Running SSH command
May05 07:15:04 [DEBUG]  [cassandra_node_08]: SSH command took 0 sec
May05 07:15:04 [DEBUG]  [cassandra_node_08]: command returned:

 	$:  


May05 07:15:04 [DEBUG]  [cassandra_node_08]: running SSH command:

     echo '
     10.0.0.35 cassandra_seednode
     10.0.0.18 cassandra_node_11
     10.0.0.30 cassandra_node_10
     10.0.0.35 cassandra_seed_0
     10.0.0.17 cassandra_node_09
     10.0.0.13 cassandra_node_08
     10.0.0.42 cassandra_node_12
     10.0.0.33 cassandra_node_14
     10.0.0.31 cassandra_node_01
     10.0.0.41 cassandra_node_13
     10.0.0.11 cassandra_node_03
     10.0.0.38 cassandra_node_02
     10.0.0.16 cassandra_node_05
     10.0.0.45 cassandra_node_04
     10.0.0.37 cassandra_node_07
     10.0.0.44 cassandra_node_06' >> /etc/hosts; echo cassandra_node_08 >/etc/hostname


May05 07:15:04 [DEBUG]  [cassandra_node_08]: Connecting to SSH
May05 07:15:04 [DEBUG]  [cassandra_node_08]: connected in 0 sec. Running SSH command
May05 07:15:04 [DEBUG]  [cassandra_node_08]: SSH command took 0 sec
May05 07:15:04 [DEBUG]  [cassandra_node_08]: command returned:

 	$:  


May05 07:24:13 [DEBUG]  [cassandra_node_08]: running SSH command:

     sed -i "/.*cassandra.*/g" /etc/hosts; sed -i "/^$/d" /etc/hosts


May05 07:24:13 [DEBUG]  [cassandra_node_08]: Connecting to SSH
May05 07:24:14 [DEBUG]  [cassandra_node_08]: connected in 0 sec. Running SSH command
May05 07:24:14 [DEBUG]  [cassandra_node_08]: SSH command took 0 sec
May05 07:24:14 [DEBUG]  [cassandra_node_08]: command returned:

 	$:  


May05 07:24:14 [DEBUG]  [cassandra_node_08]: running SSH command:

     echo '
     10.0.0.35 cassandra_seednode
     10.0.0.18 cassandra_node_11
     10.0.0.30 cassandra_node_10
     10.0.0.32 cassandra_node_15
     10.0.0.39 cassandra_node_16
     10.0.0.35 cassandra_seed_0
     10.0.0.17 cassandra_node_09
     10.0.0.13 cassandra_node_08
     10.0.0.42 cassandra_node_12
     10.0.0.33 cassandra_node_14
     10.0.0.31 cassandra_node_01
     10.0.0.41 cassandra_node_13
     10.0.0.11 cassandra_node_03
     10.0.0.38 cassandra_node_02
     10.0.0.16 cassandra_node_05
     10.0.0.45 cassandra_node_04
     10.0.0.37 cassandra_node_07
     10.0.0.44 cassandra_node_06' >> /etc/hosts; echo cassandra_node_08 >/etc/hostname


May05 07:24:14 [DEBUG]  [cassandra_node_08]: Connecting to SSH
May05 07:24:14 [DEBUG]  [cassandra_node_08]: connected in 0 sec. Running SSH command
May05 07:24:14 [DEBUG]  [cassandra_node_08]: SSH command took 0 sec
May05 07:24:14 [DEBUG]  [cassandra_node_08]: command returned:

 	$:  


May05 07:32:58 [DEBUG]  [cassandra_node_08]: running SSH command:

     sed -i "/.*cassandra.*/g" /etc/hosts; sed -i "/^$/d" /etc/hosts


May05 07:32:58 [DEBUG]  [cassandra_node_08]: Connecting to SSH
May05 07:32:58 [DEBUG]  [cassandra_node_08]: connected in 0 sec. Running SSH command
May05 07:32:58 [DEBUG]  [cassandra_node_08]: SSH command took 0 sec
May05 07:32:58 [DEBUG]  [cassandra_node_08]: command returned:

 	$:  


May05 07:32:58 [DEBUG]  [cassandra_node_08]: running SSH command:

     echo '
     10.0.0.35 cassandra_seednode
     10.0.0.18 cassandra_node_11
     10.0.0.30 cassandra_node_10
     10.0.0.32 cassandra_node_15
     10.0.0.39 cassandra_node_16
     10.0.0.43 cassandra_node_17
     10.0.0.35 cassandra_seed_0
     10.0.0.17 cassandra_node_09
     10.0.0.13 cassandra_node_08
     10.0.0.40 cassandra_node_18
     10.0.0.20 cassandra_node_19
     10.0.0.42 cassandra_node_12
     10.0.0.33 cassandra_node_14
     10.0.0.31 cassandra_node_01
     10.0.0.41 cassandra_node_13
     10.0.0.11 cassandra_node_03
     10.0.0.38 cassandra_node_02
     10.0.0.16 cassandra_node_05
     10.0.0.45 cassandra_node_04
     10.0.0.37 cassandra_node_07
     10.0.0.44 cassandra_node_06' >> /etc/hosts; echo cassandra_node_08 >/etc/hostname


May05 07:32:58 [DEBUG]  [cassandra_node_08]: Connecting to SSH
May05 07:32:58 [DEBUG]  [cassandra_node_08]: connected in 0 sec. Running SSH command
May05 07:32:58 [DEBUG]  [cassandra_node_08]: SSH command took 0 sec
May05 07:32:58 [DEBUG]  [cassandra_node_08]: command returned:

 	$:  


May05 07:40:41 [DEBUG]  [cassandra_node_08]: running SSH command:

     sed -i "/.*cassandra.*/g" /etc/hosts; sed -i "/^$/d" /etc/hosts


May05 07:40:41 [DEBUG]  [cassandra_node_08]: Connecting to SSH
May05 07:40:41 [DEBUG]  [cassandra_node_08]: connected in 0 sec. Running SSH command
May05 07:40:41 [DEBUG]  [cassandra_node_08]: SSH command took 0 sec
May05 07:40:41 [DEBUG]  [cassandra_node_08]: command returned:

 	$:  


May05 07:40:41 [DEBUG]  [cassandra_node_08]: running SSH command:

     echo '
     10.0.0.35 cassandra_seednode
     10.0.0.18 cassandra_node_11
     10.0.0.30 cassandra_node_10
     10.0.0.32 cassandra_node_15
     10.0.0.39 cassandra_node_16
     10.0.0.43 cassandra_node_17
     10.0.0.35 cassandra_seed_0
     10.0.0.17 cassandra_node_09
     10.0.0.13 cassandra_node_08
     10.0.0.40 cassandra_node_18
     10.0.0.42 cassandra_node_12
     10.0.0.33 cassandra_node_14
     10.0.0.31 cassandra_node_01
     10.0.0.41 cassandra_node_13
     10.0.0.11 cassandra_node_03
     10.0.0.38 cassandra_node_02
     10.0.0.16 cassandra_node_05
     10.0.0.45 cassandra_node_04
     10.0.0.37 cassandra_node_07
     10.0.0.44 cassandra_node_06' >> /etc/hosts; echo cassandra_node_08 >/etc/hostname


May05 07:40:41 [DEBUG]  [cassandra_node_08]: Connecting to SSH
May05 07:40:42 [DEBUG]  [cassandra_node_08]: connected in 0 sec. Running SSH command
May05 07:40:42 [DEBUG]  [cassandra_node_08]: SSH command took 0 sec
May05 07:40:42 [DEBUG]  [cassandra_node_08]: command returned:

 	$:  


May05 07:49:03 [DEBUG]  [cassandra_node_08]: running SSH command:

     sed -i "/.*cassandra.*/g" /etc/hosts; sed -i "/^$/d" /etc/hosts


May05 07:49:03 [DEBUG]  [cassandra_node_08]: Connecting to SSH
May05 07:49:03 [DEBUG]  [cassandra_node_08]: connected in 0 sec. Running SSH command
May05 07:49:03 [DEBUG]  [cassandra_node_08]: SSH command took 0 sec
May05 07:49:03 [DEBUG]  [cassandra_node_08]: command returned:

 	$:  


May05 07:49:03 [DEBUG]  [cassandra_node_08]: running SSH command:

     echo '
     10.0.0.35 cassandra_seednode
     10.0.0.18 cassandra_node_11
     10.0.0.30 cassandra_node_10
     10.0.0.32 cassandra_node_15
     10.0.0.39 cassandra_node_16
     10.0.0.43 cassandra_node_17
     10.0.0.35 cassandra_seed_0
     10.0.0.17 cassandra_node_09
     10.0.0.13 cassandra_node_08
     10.0.0.40 cassandra_node_18
     10.0.0.20 cassandra_node_19
     10.0.0.42 cassandra_node_12
     10.0.0.33 cassandra_node_14
     10.0.0.31 cassandra_node_01
     10.0.0.41 cassandra_node_13
     10.0.0.11 cassandra_node_03
     10.0.0.38 cassandra_node_02
     10.0.0.16 cassandra_node_05
     10.0.0.45 cassandra_node_04
     10.0.0.37 cassandra_node_07
     10.0.0.44 cassandra_node_06' >> /etc/hosts; echo cassandra_node_08 >/etc/hostname


May05 07:49:03 [DEBUG]  [cassandra_node_08]: Connecting to SSH
May05 07:49:03 [DEBUG]  [cassandra_node_08]: connected in 0 sec. Running SSH command
May05 07:49:03 [DEBUG]  [cassandra_node_08]: SSH command took 0 sec
May05 07:49:03 [DEBUG]  [cassandra_node_08]: command returned:

 	$:  


May05 08:04:41 [DEBUG]  [cassandra_node_08]: running SSH command:

     sed -i "/.*cassandra.*/g" /etc/hosts; sed -i "/^$/d" /etc/hosts


May05 08:04:41 [DEBUG]  [cassandra_node_08]: Connecting to SSH
May05 08:04:42 [DEBUG]  [cassandra_node_08]: connected in 0 sec. Running SSH command
May05 08:04:42 [DEBUG]  [cassandra_node_08]: SSH command took 0 sec
May05 08:04:42 [DEBUG]  [cassandra_node_08]: command returned:

 	$:  


May05 08:04:42 [DEBUG]  [cassandra_node_08]: running SSH command:

     echo '
     10.0.0.35 cassandra_seednode
     10.0.0.18 cassandra_node_11
     10.0.0.30 cassandra_node_10
     10.0.0.32 cassandra_node_15
     10.0.0.35 cassandra_seed_0
     10.0.0.17 cassandra_node_09
     10.0.0.13 cassandra_node_08
     10.0.0.42 cassandra_node_12
     10.0.0.33 cassandra_node_14
     10.0.0.31 cassandra_node_01
     10.0.0.41 cassandra_node_13
     10.0.0.11 cassandra_node_03
     10.0.0.38 cassandra_node_02
     10.0.0.16 cassandra_node_05
     10.0.0.45 cassandra_node_04
     10.0.0.37 cassandra_node_07
     10.0.0.44 cassandra_node_06' >> /etc/hosts; echo cassandra_node_08 >/etc/hostname


May05 08:04:42 [DEBUG]  [cassandra_node_08]: Connecting to SSH
May05 08:04:42 [DEBUG]  [cassandra_node_08]: connected in 0 sec. Running SSH command
May05 08:04:42 [DEBUG]  [cassandra_node_08]: SSH command took 0 sec
May05 08:04:42 [DEBUG]  [cassandra_node_08]: command returned:

 	$:  


May05 08:21:14 [DEBUG]  [cassandra_node_08]: running SSH command:

     sed -i "/.*cassandra.*/g" /etc/hosts; sed -i "/^$/d" /etc/hosts


May05 08:21:14 [DEBUG]  [cassandra_node_08]: Connecting to SSH
May05 08:21:14 [DEBUG]  [cassandra_node_08]: connected in 0 sec. Running SSH command
May05 08:21:15 [DEBUG]  [cassandra_node_08]: SSH command took 0 sec
May05 08:21:15 [DEBUG]  [cassandra_node_08]: command returned:

 	$:  


May05 08:21:15 [DEBUG]  [cassandra_node_08]: running SSH command:

     echo '
     10.0.0.35 cassandra_seednode
     10.0.0.18 cassandra_node_11
     10.0.0.30 cassandra_node_10
     10.0.0.35 cassandra_seed_0
     10.0.0.17 cassandra_node_09
     10.0.0.13 cassandra_node_08
     10.0.0.31 cassandra_node_01
     10.0.0.11 cassandra_node_03
     10.0.0.38 cassandra_node_02
     10.0.0.16 cassandra_node_05
     10.0.0.45 cassandra_node_04
     10.0.0.37 cassandra_node_07
     10.0.0.44 cassandra_node_06' >> /etc/hosts; echo cassandra_node_08 >/etc/hostname


May05 08:21:15 [DEBUG]  [cassandra_node_08]: Connecting to SSH
May05 08:21:15 [DEBUG]  [cassandra_node_08]: connected in 0 sec. Running SSH command
May05 08:21:15 [DEBUG]  [cassandra_node_08]: SSH command took 0 sec
May05 08:21:15 [DEBUG]  [cassandra_node_08]: command returned:

 	$:  


May05 13:09:35 [DEBUG]  [cassandra_node_08]: cluster = cassandra
May05 13:09:49 [DEBUG]  [cassandra_node_08]: cluster = cassandra
May05 13:13:32 [DEBUG]  [cassandra_node_08]: cluster = cassandra
May05 13:13:32 [ INFO]  [cassandra_node_08]: running decommission script
May05 13:13:32 [DEBUG]  [cassandra_node_08]: running SSH command:

     #!/bin/sh
     nodetool repair -h 127.0.0.1 ycsb
     nodetool decommission
     #kill cassandra
     CAS_PID=$(jps | grep CassandraDaemon | awk  '{print $1}')
     echo "CTOOL: Killing CassandraDaemon ($CAS_PID)" >> ctool.log
     kill $CAS_PID &>/dev/null
     
     
     #report not alive
     gmetric -n alive -v 0 -t int32 -u nodes -d 10000
     


May05 13:13:32 [DEBUG]  [cassandra_node_08]: Connecting to SSH
May05 13:13:32 [DEBUG]  [cassandra_node_08]: connected in 0 sec. Running SSH command
May05 13:18:03 [DEBUG]  [cassandra_node_08]: SSH command took 270 sec
May05 13:18:03 [DEBUG]  [cassandra_node_08]: command returned:

 	$:  [2014-05-05 13:13:39,400] Starting repair command #1, repairing 256 ranges for keyspace ycsb
	$:  [2014-05-05 13:13:42,215] Repair command #1 finished
	$:  


May05 13:18:03 [ INFO]  [cassandra_node_08]: now decommissioned (took 270 sec)
May05 13:19:33 [DEBUG]  [cassandra_node_08]: cluster = cassandra
May05 13:19:51 [DEBUG]  [cassandra_node_08]: cluster = cassandra
May05 14:29:45 [DEBUG]  [cassandra_node_08]: cluster = cassandra
May05 14:30:00 [DEBUG]  [cassandra_node_08]: cluster = cassandra
May05 14:35:32 [ INFO]  [cassandra_node_08]: Waiting for SSH daemon (83.212.118.12)
May05 14:35:32 [DEBUG]  [cassandra_node_08]: end time:2014-05-05 14:45:32.399038
May05 14:35:32 [DEBUG]  [cassandra_node_08]: ssh attempt:1
May05 14:35:32 [DEBUG]  [cassandra_node_08]: Connecting to SSH
May05 14:35:32 [DEBUG]  [cassandra_node_08]: connected in 0 sec. Running SSH command
May05 14:35:32 [DEBUG]  [cassandra_node_08]: SSH command took 0 sec
May05 14:35:32 [ INFO]  [cassandra_node_08]: now ready (took 0 sec)
May05 14:35:32 [DEBUG]  [cassandra_node_08]: running SSH command:

     sed -i "/.*cassandra.*/g" /etc/hosts; sed -i "/^$/d" /etc/hosts


May05 14:35:32 [DEBUG]  [cassandra_node_08]: Connecting to SSH
May05 14:35:32 [DEBUG]  [cassandra_node_08]: connected in 0 sec. Running SSH command
May05 14:35:32 [DEBUG]  [cassandra_node_08]: SSH command took 0 sec
May05 14:35:32 [DEBUG]  [cassandra_node_08]: command returned:

 	$:  


May05 14:35:32 [DEBUG]  [cassandra_node_08]: running SSH command:

     echo '
     10.0.0.35 cassandra_seednode
     10.0.0.30 cassandra_node_10
     10.0.0.35 cassandra_seed_0
     10.0.0.17 cassandra_node_09
     10.0.0.13 cassandra_node_08
     10.0.0.31 cassandra_node_01
     10.0.0.11 cassandra_node_03
     10.0.0.38 cassandra_node_02
     10.0.0.16 cassandra_node_05
     10.0.0.45 cassandra_node_04
     10.0.0.37 cassandra_node_07
     10.0.0.44 cassandra_node_06' >> /etc/hosts; echo cassandra_node_08 >/etc/hostname


May05 14:35:32 [DEBUG]  [cassandra_node_08]: Connecting to SSH
May05 14:35:32 [DEBUG]  [cassandra_node_08]: connected in 0 sec. Running SSH command
May05 14:35:32 [DEBUG]  [cassandra_node_08]: SSH command took 0 sec
May05 14:35:32 [DEBUG]  [cassandra_node_08]: command returned:

 	$:  


May05 14:35:32 [ INFO]  [cassandra_node_08]: running bootstrap script
May05 14:35:32 [DEBUG]  [cassandra_node_08]: running SSH command:

     #!/bin/bash
     
     MAX_WAIT=300  #5 min
     
     echo "started bootstrap" > bootsrap.log
     
     # check the seednode
     if ! ping -q -c 1 cassandra_seednode &>/dev/null   ;
     then
     echo CTOOL: ERROR - cassandra_seednode not pingable, exiting
     exit -1
     fi
     
     # kill the cassandra process
     CAS_PID=$(jps | grep CassandraDaemon | awk  '{print $1}')
     echo "CTOOL: Killing CassandraDaemon ($CAS_PID)"
     kill -9 $CAS_PID
     
     # clean previous files and logs
     echo "Removing cassandra files and logs"
     #cleaning cassandra files
     rm -rf /var/lib/cassandra/*
     rm /var/log/cassandra/system.log
     #cleaning ctool rrds
     echo "Removing ganglia rrds"
     rm -rf /var/lib/ganglia/rrds/*
     rm /var/log/cassandra/system.log
     
     # find my IP
     my_priv_addr=""
     #look for an IPv4 interface in range 10.0 and use that for the cassandra communication
     let if_count=($(ifconfig | grep eth | wc -l ))-1
     for i in $(seq 0 $if_count)
     do	#look for IPv4 address
     line=$(ifconfig eth$i | grep "inet addr:")
     line=$(echo $line | awk '{print $2}')
     address=$(echo $line | sed 's/addr://g')
     if [[ "$address" == 10.0.* ]] ;
     then
     my_priv_addr=$address
     break
     fi
     done
     
     # configure cassandra
     echo "configuring cassandra.yaml for my address:$my_priv_addr" >> ctool.log
     #change the listen address of this node
     sed "s/listen_address: .*/listen_address: $my_priv_addr/g"  /etc/cassandra/cassandra.yaml> tmp && mv tmp /etc/cassandra/cassandra.yaml
     #change the rpc_address of this node to 0.0.0.0
     sed "s/rpc_address: .*/rpc_address: 0.0.0.0/g"  /etc/cassandra/cassandra.yaml> tmp && mv tmp /etc/cassandra/cassandra.yaml
     #change the seeds to "cassandra_seednode"
     sed "s/seeds: .*/seeds: \"cassandra_seednode\"/g"  /etc/cassandra/cassandra.yaml> tmp && mv tmp /etc/cassandra/cassandra.yaml
     #add the jmx server whatever to cassandra-env.sh
     sed -i.bak "s/.*-Djava.rmi.server.hostname=.*/JVM_OPTS=\"\$JVM_OPTS -Djava.rmi.server.hostname=$my_priv_addr\"/g"  /etc/cassandra/cassandra-env.sh
     sed -i.bak "s/*JVM_OPTS=\"\$JVM_OPTS -Djava.rmi.server.hostname=*\"/JVM_OPTS=\"\$JVM_OPTS -Djava.rmi.server.hostname=$my_priv_addr\"/g"  /etc/cassandra/cassandra-env.sh
     #make sure no requests are dropped by using a big timeout
     sed -i.bak "s/read_request_timeout_in_ms:.*/read_request_timeout_in_ms: 50000/g" /etc/cassandra/cassandra.yaml
     sed -i.bak "s/write_request_timeout_in_ms:.*/write_request_timeout_in_ms: 50000/g" /etc/cassandra/cassandra.yaml
     echo "CTOOL: Done configuring"
     
     
     # start cassandra
     chmod -R o+rw /var/lib/cassandra
     echo Starting casandra service, ganglia-monitor
     service cassandra start
     service ganglia-monitor restart
     
     #wait until ready and try to create keyspace
     echo "Attempting to create ycsb keyspace"
     echo "create keyspace ycsb  WITH REPLICATION = {'class' : 'SimpleStrategy', 'replication_factor': 1 }; use ycsb;  create table usertable (y_id varchar primary key, field0 varchar, field1 varchar, field2 varchar, field3 varchar, field4 varchar, field5 varchar, field6 varchar, field7 varchar, field8 varchar, field9 varchar);" > ycsb_cql.temp
     while ! cqlsh < ycsb_cql.temp 2>/dev/null;do sleep 2; done
     rm ycsb_cql.temp
     
     echo "ended bootstrap" >> bootsrap.log
     
     #report alive in gmetric
     gmetric -n alive -v 1 -t int32 -u nodes -d 10000
     
     
     


May05 14:35:32 [DEBUG]  [cassandra_node_08]: Connecting to SSH
May05 14:35:33 [DEBUG]  [cassandra_node_08]: connected in 0 sec. Running SSH command
May05 14:40:05 [DEBUG]  [cassandra_node_08]: SSH command took 272 sec
May05 14:40:05 [DEBUG]  [cassandra_node_08]: command returned:

 	$:  CTOOL: Killing CassandraDaemon ()
	$:  Removing cassandra files and logs
	$:  Removing ganglia rrds
	$:  CTOOL: Done configuring
	$:  Starting casandra service, ganglia-monitor
	$:  Stopping Ganglia Monitor Daemon: gmond.
	$:  Starting Ganglia Monitor Daemon: gmond.
	$:  Attempting to create ycsb keyspace
	$:  kill: usage: kill [-s sigspec | -n signum | -sigspec] pid | jobspec ... or kill -l [sigspec]
	$:  rm: cannot remove `/var/log/cassandra/system.log': No such file or directory
	$:  


May05 14:40:05 [DEBUG]  [cassandra_node_08]: command returned:
	$:  CTOOL: Killing CassandraDaemon ()
	$:  Removing cassandra files and logs
	$:  Removing ganglia rrds
	$:  CTOOL: Done configuring
	$:  Starting casandra service, ganglia-monitor
	$:  Stopping Ganglia Monitor Daemon: gmond.
	$:  Starting Ganglia Monitor Daemon: gmond.
	$:  Attempting to create ycsb keyspace
	$:  kill: usage: kill [-s sigspec | -n signum | -sigspec] pid | jobspec ... or kill -l [sigspec]
	$:  rm: cannot remove `/var/log/cassandra/system.log': No such file or directory
	$:  
May05 14:40:05 [ INFO]  [cassandra_node_08]: is now bootstrapped (took 272 sec)
May05 14:40:23 [DEBUG]  [cassandra_node_08]: running SSH command:

     sed -i "/.*cassandra.*/g" /etc/hosts; sed -i "/^$/d" /etc/hosts


May05 14:40:23 [DEBUG]  [cassandra_node_08]: Connecting to SSH
May05 14:40:24 [DEBUG]  [cassandra_node_08]: connected in 0 sec. Running SSH command
May05 14:40:24 [DEBUG]  [cassandra_node_08]: SSH command took 0 sec
May05 14:40:24 [DEBUG]  [cassandra_node_08]: command returned:

 	$:  


May05 14:40:24 [DEBUG]  [cassandra_node_08]: running SSH command:

     echo '
     10.0.0.35 cassandra_seednode
     10.0.0.30 cassandra_node_10
     10.0.0.35 cassandra_seed_0
     10.0.0.17 cassandra_node_09
     10.0.0.13 cassandra_node_08
     10.0.0.31 cassandra_node_01
     10.0.0.11 cassandra_node_03
     10.0.0.38 cassandra_node_02
     10.0.0.16 cassandra_node_05
     10.0.0.45 cassandra_node_04
     10.0.0.37 cassandra_node_07
     10.0.0.44 cassandra_node_06' >> /etc/hosts; echo cassandra_node_08 >/etc/hostname


May05 14:40:24 [DEBUG]  [cassandra_node_08]: Connecting to SSH
May05 14:40:25 [DEBUG]  [cassandra_node_08]: connected in 0 sec. Running SSH command
May05 14:40:25 [DEBUG]  [cassandra_node_08]: SSH command took 0 sec
May05 14:40:25 [DEBUG]  [cassandra_node_08]: command returned:

 	$:  


May05 14:50:01 [DEBUG]  [cassandra_node_08]: running SSH command:

     sed -i "/.*cassandra.*/g" /etc/hosts; sed -i "/^$/d" /etc/hosts


May05 14:50:01 [DEBUG]  [cassandra_node_08]: Connecting to SSH
May05 14:50:02 [DEBUG]  [cassandra_node_08]: connected in 0 sec. Running SSH command
May05 14:50:02 [DEBUG]  [cassandra_node_08]: SSH command took 0 sec
May05 14:50:02 [DEBUG]  [cassandra_node_08]: command returned:

 	$:  


May05 14:50:02 [DEBUG]  [cassandra_node_08]: running SSH command:

     echo '
     10.0.0.35 cassandra_seednode
     10.0.0.18 cassandra_node_11
     10.0.0.30 cassandra_node_10
     10.0.0.35 cassandra_seed_0
     10.0.0.17 cassandra_node_09
     10.0.0.13 cassandra_node_08
     10.0.0.42 cassandra_node_12
     10.0.0.33 cassandra_node_14
     10.0.0.31 cassandra_node_01
     10.0.0.41 cassandra_node_13
     10.0.0.11 cassandra_node_03
     10.0.0.38 cassandra_node_02
     10.0.0.16 cassandra_node_05
     10.0.0.45 cassandra_node_04
     10.0.0.37 cassandra_node_07
     10.0.0.44 cassandra_node_06' >> /etc/hosts; echo cassandra_node_08 >/etc/hostname


May05 14:50:02 [DEBUG]  [cassandra_node_08]: Connecting to SSH
May05 14:50:03 [DEBUG]  [cassandra_node_08]: connected in 1 sec. Running SSH command
May05 14:50:04 [DEBUG]  [cassandra_node_08]: SSH command took 0 sec
May05 14:50:04 [DEBUG]  [cassandra_node_08]: command returned:

 	$:  


May05 14:51:52 [DEBUG]  [cassandra_node_08]: cluster = cassandra
May05 14:52:36 [DEBUG]  [cassandra_node_08]: cluster = cassandra
May05 15:01:41 [DEBUG]  [cassandra_node_08]: running SSH command:

     sed -i "/.*cassandra.*/g" /etc/hosts; sed -i "/^$/d" /etc/hosts


May05 15:01:41 [DEBUG]  [cassandra_node_08]: Connecting to SSH
May05 15:01:42 [DEBUG]  [cassandra_node_08]: connected in 0 sec. Running SSH command
May05 15:01:42 [DEBUG]  [cassandra_node_08]: SSH command took 0 sec
May05 15:01:42 [DEBUG]  [cassandra_node_08]: command returned:

 	$:  


May05 15:01:42 [DEBUG]  [cassandra_node_08]: running SSH command:

     echo '
     10.0.0.35 cassandra_seednode
     10.0.0.30 cassandra_node_10
     10.0.0.35 cassandra_seed_0
     10.0.0.17 cassandra_node_09
     10.0.0.13 cassandra_node_08
     10.0.0.31 cassandra_node_01
     10.0.0.11 cassandra_node_03
     10.0.0.38 cassandra_node_02
     10.0.0.16 cassandra_node_05
     10.0.0.45 cassandra_node_04
     10.0.0.37 cassandra_node_07
     10.0.0.44 cassandra_node_06' >> /etc/hosts; echo cassandra_node_08 >/etc/hostname


May05 15:01:42 [DEBUG]  [cassandra_node_08]: Connecting to SSH
May05 15:01:42 [DEBUG]  [cassandra_node_08]: connected in 0 sec. Running SSH command
May05 15:01:42 [DEBUG]  [cassandra_node_08]: SSH command took 0 sec
May05 15:01:42 [DEBUG]  [cassandra_node_08]: command returned:

 	$:  


May05 15:01:59 [DEBUG]  [cassandra_node_08]: cluster = cassandra
May05 15:02:13 [DEBUG]  [cassandra_node_08]: cluster = cassandra
May05 15:15:34 [DEBUG]  [cassandra_node_08]: running SSH command:

     sed -i "/.*cassandra.*/g" /etc/hosts; sed -i "/^$/d" /etc/hosts


May05 15:15:34 [DEBUG]  [cassandra_node_08]: Connecting to SSH
May05 15:15:34 [DEBUG]  [cassandra_node_08]: connected in 0 sec. Running SSH command
May05 15:15:35 [DEBUG]  [cassandra_node_08]: SSH command took 0 sec
May05 15:15:35 [DEBUG]  [cassandra_node_08]: command returned:

 	$:  


May05 15:15:35 [DEBUG]  [cassandra_node_08]: running SSH command:

     echo '
     10.0.0.35 cassandra_seednode
     10.0.0.35 cassandra_seed_0
     10.0.0.13 cassandra_node_08
     10.0.0.31 cassandra_node_01
     10.0.0.11 cassandra_node_03
     10.0.0.38 cassandra_node_02
     10.0.0.16 cassandra_node_05
     10.0.0.45 cassandra_node_04
     10.0.0.37 cassandra_node_07
     10.0.0.44 cassandra_node_06' >> /etc/hosts; echo cassandra_node_08 >/etc/hostname


May05 15:15:35 [DEBUG]  [cassandra_node_08]: Connecting to SSH
May05 15:15:35 [DEBUG]  [cassandra_node_08]: connected in 0 sec. Running SSH command
May05 15:15:35 [DEBUG]  [cassandra_node_08]: SSH command took 0 sec
May05 15:15:35 [DEBUG]  [cassandra_node_08]: command returned:

 	$:  


May05 15:26:44 [DEBUG]  [cassandra_node_08]: running SSH command:

     sed -i "/.*cassandra.*/g" /etc/hosts; sed -i "/^$/d" /etc/hosts


May05 15:26:44 [DEBUG]  [cassandra_node_08]: Connecting to SSH
May05 15:26:44 [DEBUG]  [cassandra_node_08]: connected in 0 sec. Running SSH command
May05 15:26:44 [DEBUG]  [cassandra_node_08]: SSH command took 0 sec
May05 15:26:44 [DEBUG]  [cassandra_node_08]: command returned:

 	$:  


May05 15:26:44 [DEBUG]  [cassandra_node_08]: running SSH command:

     echo '
     10.0.0.35 cassandra_seednode
     10.0.0.18 cassandra_node_11
     10.0.0.30 cassandra_node_10
     10.0.0.35 cassandra_seed_0
     10.0.0.17 cassandra_node_09
     10.0.0.13 cassandra_node_08
     10.0.0.42 cassandra_node_12
     10.0.0.31 cassandra_node_01
     10.0.0.11 cassandra_node_03
     10.0.0.38 cassandra_node_02
     10.0.0.16 cassandra_node_05
     10.0.0.45 cassandra_node_04
     10.0.0.37 cassandra_node_07
     10.0.0.44 cassandra_node_06' >> /etc/hosts; echo cassandra_node_08 >/etc/hostname


May05 15:26:44 [DEBUG]  [cassandra_node_08]: Connecting to SSH
May05 15:26:45 [DEBUG]  [cassandra_node_08]: connected in 0 sec. Running SSH command
May05 15:26:45 [DEBUG]  [cassandra_node_08]: SSH command took 0 sec
May05 15:26:45 [DEBUG]  [cassandra_node_08]: command returned:

 	$:  


May05 15:36:32 [DEBUG]  [cassandra_node_08]: running SSH command:

     sed -i "/.*cassandra.*/g" /etc/hosts; sed -i "/^$/d" /etc/hosts


May05 15:36:32 [DEBUG]  [cassandra_node_08]: Connecting to SSH
May05 15:36:33 [DEBUG]  [cassandra_node_08]: connected in 0 sec. Running SSH command
May05 15:36:33 [DEBUG]  [cassandra_node_08]: SSH command took 0 sec
May05 15:36:33 [DEBUG]  [cassandra_node_08]: command returned:

 	$:  


May05 15:36:33 [DEBUG]  [cassandra_node_08]: running SSH command:

     echo '
     10.0.0.35 cassandra_seednode
     10.0.0.18 cassandra_node_11
     10.0.0.30 cassandra_node_10
     10.0.0.32 cassandra_node_15
     10.0.0.39 cassandra_node_16
     10.0.0.35 cassandra_seed_0
     10.0.0.17 cassandra_node_09
     10.0.0.13 cassandra_node_08
     10.0.0.42 cassandra_node_12
     10.0.0.33 cassandra_node_14
     10.0.0.31 cassandra_node_01
     10.0.0.41 cassandra_node_13
     10.0.0.11 cassandra_node_03
     10.0.0.38 cassandra_node_02
     10.0.0.16 cassandra_node_05
     10.0.0.45 cassandra_node_04
     10.0.0.37 cassandra_node_07
     10.0.0.44 cassandra_node_06' >> /etc/hosts; echo cassandra_node_08 >/etc/hostname


May05 15:36:33 [DEBUG]  [cassandra_node_08]: Connecting to SSH
May05 15:36:33 [DEBUG]  [cassandra_node_08]: connected in 0 sec. Running SSH command
May05 15:36:33 [DEBUG]  [cassandra_node_08]: SSH command took 0 sec
May05 15:36:33 [DEBUG]  [cassandra_node_08]: command returned:

 	$:  


May05 15:46:24 [DEBUG]  [cassandra_node_08]: running SSH command:

     sed -i "/.*cassandra.*/g" /etc/hosts; sed -i "/^$/d" /etc/hosts


May05 15:46:24 [DEBUG]  [cassandra_node_08]: Connecting to SSH
May05 15:46:25 [DEBUG]  [cassandra_node_08]: connected in 0 sec. Running SSH command
May05 15:46:25 [DEBUG]  [cassandra_node_08]: SSH command took 0 sec
May05 15:46:25 [DEBUG]  [cassandra_node_08]: command returned:

 	$:  


May05 15:46:25 [DEBUG]  [cassandra_node_08]: running SSH command:

     echo '
     10.0.0.35 cassandra_seednode
     10.0.0.18 cassandra_node_11
     10.0.0.30 cassandra_node_10
     10.0.0.32 cassandra_node_15
     10.0.0.39 cassandra_node_16
     10.0.0.43 cassandra_node_17
     10.0.0.35 cassandra_seed_0
     10.0.0.17 cassandra_node_09
     10.0.0.13 cassandra_node_08
     10.0.0.40 cassandra_node_18
     10.0.0.20 cassandra_node_19
     10.0.0.42 cassandra_node_12
     10.0.0.33 cassandra_node_14
     10.0.0.31 cassandra_node_01
     10.0.0.41 cassandra_node_13
     10.0.0.11 cassandra_node_03
     10.0.0.38 cassandra_node_02
     10.0.0.16 cassandra_node_05
     10.0.0.45 cassandra_node_04
     10.0.0.37 cassandra_node_07
     10.0.0.44 cassandra_node_06' >> /etc/hosts; echo cassandra_node_08 >/etc/hostname


May05 15:46:25 [DEBUG]  [cassandra_node_08]: Connecting to SSH
May05 15:46:25 [DEBUG]  [cassandra_node_08]: connected in 0 sec. Running SSH command
May05 15:46:25 [DEBUG]  [cassandra_node_08]: SSH command took 0 sec
May05 15:46:25 [DEBUG]  [cassandra_node_08]: command returned:

 	$:  


May05 16:00:38 [DEBUG]  [cassandra_node_08]: running SSH command:

     sed -i "/.*cassandra.*/g" /etc/hosts; sed -i "/^$/d" /etc/hosts


May05 16:00:38 [DEBUG]  [cassandra_node_08]: Connecting to SSH
May05 16:00:38 [DEBUG]  [cassandra_node_08]: connected in 0 sec. Running SSH command
May05 16:00:38 [DEBUG]  [cassandra_node_08]: SSH command took 0 sec
May05 16:00:38 [DEBUG]  [cassandra_node_08]: command returned:

 	$:  


May05 16:00:38 [DEBUG]  [cassandra_node_08]: running SSH command:

     echo '
     10.0.0.35 cassandra_seednode
     10.0.0.18 cassandra_node_11
     10.0.0.30 cassandra_node_10
     10.0.0.32 cassandra_node_15
     10.0.0.35 cassandra_seed_0
     10.0.0.17 cassandra_node_09
     10.0.0.13 cassandra_node_08
     10.0.0.42 cassandra_node_12
     10.0.0.33 cassandra_node_14
     10.0.0.31 cassandra_node_01
     10.0.0.41 cassandra_node_13
     10.0.0.11 cassandra_node_03
     10.0.0.38 cassandra_node_02
     10.0.0.16 cassandra_node_05
     10.0.0.45 cassandra_node_04
     10.0.0.37 cassandra_node_07
     10.0.0.44 cassandra_node_06' >> /etc/hosts; echo cassandra_node_08 >/etc/hostname


May05 16:00:38 [DEBUG]  [cassandra_node_08]: Connecting to SSH
May05 16:00:38 [DEBUG]  [cassandra_node_08]: connected in 0 sec. Running SSH command
May05 16:00:38 [DEBUG]  [cassandra_node_08]: SSH command took 0 sec
May05 16:00:38 [DEBUG]  [cassandra_node_08]: command returned:

 	$:  


May05 16:19:06 [DEBUG]  [cassandra_node_08]: running SSH command:

     sed -i "/.*cassandra.*/g" /etc/hosts; sed -i "/^$/d" /etc/hosts


May05 16:19:06 [DEBUG]  [cassandra_node_08]: Connecting to SSH
May05 16:19:07 [DEBUG]  [cassandra_node_08]: connected in 0 sec. Running SSH command
May05 16:19:07 [DEBUG]  [cassandra_node_08]: SSH command took 0 sec
May05 16:19:07 [DEBUG]  [cassandra_node_08]: command returned:

 	$:  


May05 16:19:07 [DEBUG]  [cassandra_node_08]: running SSH command:

     echo '
     10.0.0.35 cassandra_seednode
     10.0.0.18 cassandra_node_11
     10.0.0.30 cassandra_node_10
     10.0.0.35 cassandra_seed_0
     10.0.0.17 cassandra_node_09
     10.0.0.13 cassandra_node_08
     10.0.0.31 cassandra_node_01
     10.0.0.11 cassandra_node_03
     10.0.0.38 cassandra_node_02
     10.0.0.16 cassandra_node_05
     10.0.0.45 cassandra_node_04
     10.0.0.37 cassandra_node_07
     10.0.0.44 cassandra_node_06' >> /etc/hosts; echo cassandra_node_08 >/etc/hostname


May05 16:19:07 [DEBUG]  [cassandra_node_08]: Connecting to SSH
May05 16:19:07 [DEBUG]  [cassandra_node_08]: connected in 0 sec. Running SSH command
May05 16:19:07 [DEBUG]  [cassandra_node_08]: SSH command took 0 sec
May05 16:19:07 [DEBUG]  [cassandra_node_08]: command returned:

 	$:  


May05 16:28:32 [DEBUG]  [cassandra_node_08]: running SSH command:

     sed -i "/.*cassandra.*/g" /etc/hosts; sed -i "/^$/d" /etc/hosts


May05 16:28:32 [DEBUG]  [cassandra_node_08]: Connecting to SSH
May05 16:28:32 [DEBUG]  [cassandra_node_08]: connected in 0 sec. Running SSH command
May05 16:28:32 [DEBUG]  [cassandra_node_08]: SSH command took 0 sec
May05 16:28:32 [DEBUG]  [cassandra_node_08]: command returned:

 	$:  


May05 16:28:32 [DEBUG]  [cassandra_node_08]: running SSH command:

     echo '
     10.0.0.35 cassandra_seednode
     10.0.0.18 cassandra_node_11
     10.0.0.30 cassandra_node_10
     10.0.0.32 cassandra_node_15
     10.0.0.35 cassandra_seed_0
     10.0.0.17 cassandra_node_09
     10.0.0.13 cassandra_node_08
     10.0.0.42 cassandra_node_12
     10.0.0.33 cassandra_node_14
     10.0.0.31 cassandra_node_01
     10.0.0.41 cassandra_node_13
     10.0.0.11 cassandra_node_03
     10.0.0.38 cassandra_node_02
     10.0.0.16 cassandra_node_05
     10.0.0.45 cassandra_node_04
     10.0.0.37 cassandra_node_07
     10.0.0.44 cassandra_node_06' >> /etc/hosts; echo cassandra_node_08 >/etc/hostname


May05 16:28:32 [DEBUG]  [cassandra_node_08]: Connecting to SSH
May05 16:28:33 [DEBUG]  [cassandra_node_08]: connected in 0 sec. Running SSH command
May05 16:28:33 [DEBUG]  [cassandra_node_08]: SSH command took 0 sec
May05 16:28:33 [DEBUG]  [cassandra_node_08]: command returned:

 	$:  


May05 16:37:53 [DEBUG]  [cassandra_node_08]: running SSH command:

     sed -i "/.*cassandra.*/g" /etc/hosts; sed -i "/^$/d" /etc/hosts


May05 16:37:53 [DEBUG]  [cassandra_node_08]: Connecting to SSH
May05 16:37:54 [DEBUG]  [cassandra_node_08]: connected in 0 sec. Running SSH command
May05 16:37:55 [DEBUG]  [cassandra_node_08]: SSH command took 0 sec
May05 16:37:55 [DEBUG]  [cassandra_node_08]: command returned:

 	$:  


May05 16:37:55 [DEBUG]  [cassandra_node_08]: running SSH command:

     echo '
     10.0.0.35 cassandra_seednode
     10.0.0.18 cassandra_node_11
     10.0.0.30 cassandra_node_10
     10.0.0.32 cassandra_node_15
     10.0.0.39 cassandra_node_16
     10.0.0.43 cassandra_node_17
     10.0.0.35 cassandra_seed_0
     10.0.0.17 cassandra_node_09
     10.0.0.13 cassandra_node_08
     10.0.0.40 cassandra_node_18
     10.0.0.20 cassandra_node_19
     10.0.0.42 cassandra_node_12
     10.0.0.33 cassandra_node_14
     10.0.0.31 cassandra_node_01
     10.0.0.41 cassandra_node_13
     10.0.0.11 cassandra_node_03
     10.0.0.38 cassandra_node_02
     10.0.0.16 cassandra_node_05
     10.0.0.45 cassandra_node_04
     10.0.0.37 cassandra_node_07
     10.0.0.44 cassandra_node_06' >> /etc/hosts; echo cassandra_node_08 >/etc/hostname


May05 16:37:55 [DEBUG]  [cassandra_node_08]: Connecting to SSH
May05 16:37:55 [DEBUG]  [cassandra_node_08]: connected in 0 sec. Running SSH command
May05 16:37:55 [DEBUG]  [cassandra_node_08]: SSH command took 0 sec
May05 16:37:55 [DEBUG]  [cassandra_node_08]: command returned:

 	$:  


May05 16:46:10 [DEBUG]  [cassandra_node_08]: running SSH command:

     sed -i "/.*cassandra.*/g" /etc/hosts; sed -i "/^$/d" /etc/hosts


May05 16:46:10 [DEBUG]  [cassandra_node_08]: Connecting to SSH
May05 16:46:10 [DEBUG]  [cassandra_node_08]: connected in 0 sec. Running SSH command
May05 16:46:10 [DEBUG]  [cassandra_node_08]: SSH command took 0 sec
May05 16:46:10 [DEBUG]  [cassandra_node_08]: command returned:

 	$:  


May05 16:46:10 [DEBUG]  [cassandra_node_08]: running SSH command:

     echo '
     10.0.0.35 cassandra_seednode
     10.0.0.18 cassandra_node_11
     10.0.0.30 cassandra_node_10
     10.0.0.32 cassandra_node_15
     10.0.0.39 cassandra_node_16
     10.0.0.43 cassandra_node_17
     10.0.0.35 cassandra_seed_0
     10.0.0.17 cassandra_node_09
     10.0.0.13 cassandra_node_08
     10.0.0.40 cassandra_node_18
     10.0.0.42 cassandra_node_12
     10.0.0.33 cassandra_node_14
     10.0.0.31 cassandra_node_01
     10.0.0.41 cassandra_node_13
     10.0.0.11 cassandra_node_03
     10.0.0.38 cassandra_node_02
     10.0.0.16 cassandra_node_05
     10.0.0.45 cassandra_node_04
     10.0.0.37 cassandra_node_07
     10.0.0.44 cassandra_node_06' >> /etc/hosts; echo cassandra_node_08 >/etc/hostname


May05 16:46:10 [DEBUG]  [cassandra_node_08]: Connecting to SSH
May05 16:46:11 [DEBUG]  [cassandra_node_08]: connected in 0 sec. Running SSH command
May05 16:46:11 [DEBUG]  [cassandra_node_08]: SSH command took 0 sec
May05 16:46:11 [DEBUG]  [cassandra_node_08]: command returned:

 	$:  


May05 17:01:19 [DEBUG]  [cassandra_node_08]: running SSH command:

     sed -i "/.*cassandra.*/g" /etc/hosts; sed -i "/^$/d" /etc/hosts


May05 17:01:19 [DEBUG]  [cassandra_node_08]: Connecting to SSH
May05 17:01:19 [DEBUG]  [cassandra_node_08]: connected in 0 sec. Running SSH command
May05 17:01:20 [DEBUG]  [cassandra_node_08]: SSH command took 0 sec
May05 17:01:20 [DEBUG]  [cassandra_node_08]: command returned:

 	$:  


May05 17:01:20 [DEBUG]  [cassandra_node_08]: running SSH command:

     echo '
     10.0.0.35 cassandra_seednode
     10.0.0.18 cassandra_node_11
     10.0.0.30 cassandra_node_10
     10.0.0.35 cassandra_seed_0
     10.0.0.17 cassandra_node_09
     10.0.0.13 cassandra_node_08
     10.0.0.42 cassandra_node_12
     10.0.0.33 cassandra_node_14
     10.0.0.31 cassandra_node_01
     10.0.0.41 cassandra_node_13
     10.0.0.11 cassandra_node_03
     10.0.0.38 cassandra_node_02
     10.0.0.16 cassandra_node_05
     10.0.0.45 cassandra_node_04
     10.0.0.37 cassandra_node_07
     10.0.0.44 cassandra_node_06' >> /etc/hosts; echo cassandra_node_08 >/etc/hostname


May05 17:01:20 [DEBUG]  [cassandra_node_08]: Connecting to SSH
May05 17:01:20 [DEBUG]  [cassandra_node_08]: connected in 0 sec. Running SSH command
May05 17:01:20 [DEBUG]  [cassandra_node_08]: SSH command took 0 sec
May05 17:01:20 [DEBUG]  [cassandra_node_08]: command returned:

 	$:  


May05 17:28:35 [DEBUG]  [cassandra_node_08]: cluster = cassandra
May05 17:50:23 [DEBUG]  [cassandra_node_08]: cluster = cassandra
May05 17:50:23 [ INFO]  [cassandra_node_08]: running kill script
May05 17:50:23 [DEBUG]  [cassandra_node_08]: running SSH command:

     #!/bin/sh
     CAS_PID=$(jps | grep CassandraDaemon | awk  '{print $1}')
     echo "CTOOL: Killing CassandraDaemon ($CAS_PID)"
     kill -9 $CAS_PID &>/dev/null
     ## maybe problematic
     killall java
     
     
     
     ################ debug #################3
     echo "Removing cassandra files and logs" &>>ctool.log
     #cleaning cassandra files
     rm -rf /var/lib/cassandra/* &>>ctool.log
     rm /var/log/cassandra/system.log &>>ctool.log
     #cleaning ctool rrds
     echo "Removing ganglia rrds" &>>ctool.log
     rm -rf /var/lib/ganglia/rrds/* &>>ctool.log
     
     
     
     
     
     echo '
     
     ############  KILLED  ##############' >> ycsb_run.log
     
     #report not alive
     gmetric -n alive -v 0 -t int32 -u nodes -d 10000
     


May05 17:50:23 [DEBUG]  [cassandra_node_08]: Connecting to SSH
May05 17:50:27 [DEBUG]  [cassandra_node_08]: connected in 3 sec. Running SSH command
May05 17:50:27 [DEBUG]  [cassandra_node_08]: SSH command took 0 sec
May05 17:50:27 [DEBUG]  [cassandra_node_08]: command returned:

 	$:  CTOOL: Killing CassandraDaemon (18039)
	$:  


May05 17:50:45 [DEBUG]  [cassandra_node_08]: cluster = cassandra
May05 17:51:09 [DEBUG]  [cassandra_node_08]: cluster = cassandra
May05 17:52:52 [DEBUG]  [cassandra_node_08]: cluster = cassandra
May05 17:52:52 [ INFO]  [cassandra_node_08]: running kill script
May05 17:52:52 [DEBUG]  [cassandra_node_08]: running SSH command:

     #!/bin/sh
     CAS_PID=$(jps | grep CassandraDaemon | awk  '{print $1}')
     echo "CTOOL: Killing CassandraDaemon ($CAS_PID)"
     kill -9 $CAS_PID &>/dev/null
     ## maybe problematic
     killall java
     
     
     
     ################ debug #################3
     echo "Removing cassandra files and logs" &>>ctool.log
     #cleaning cassandra files
     rm -rf /var/lib/cassandra/* &>>ctool.log
     rm /var/log/cassandra/system.log &>>ctool.log
     #cleaning ctool rrds
     echo "Removing ganglia rrds" &>>ctool.log
     rm -rf /var/lib/ganglia/rrds/* &>>ctool.log
     
     
     
     
     
     echo '
     
     ############  KILLED  ##############' >> ycsb_run.log
     
     #report not alive
     gmetric -n alive -v 0 -t int32 -u nodes -d 10000
     


May05 17:52:52 [DEBUG]  [cassandra_node_08]: Connecting to SSH
May05 17:52:52 [DEBUG]  [cassandra_node_08]: connected in 0 sec. Running SSH command
May05 17:52:53 [DEBUG]  [cassandra_node_08]: SSH command took 0 sec
May05 17:52:53 [DEBUG]  [cassandra_node_08]: command returned:

 	$:  CTOOL: Killing CassandraDaemon ()
	$:  java: no process found
	$:  


May05 17:53:14 [DEBUG]  [cassandra_node_08]: cluster = cassandra
May05 17:53:30 [DEBUG]  [cassandra_node_08]: cluster = cassandra
May05 18:01:41 [DEBUG]  [cassandra_node_08]: cluster = cassandra
May05 18:01:56 [DEBUG]  [cassandra_node_08]: cluster = cassandra
May05 18:38:27 [DEBUG]  [cassandra_node_08]: cluster = cassandra
May05 18:38:41 [DEBUG]  [cassandra_node_08]: cluster = cassandra
May05 18:44:42 [ INFO]  [cassandra_node_08]: Waiting for SSH daemon (83.212.118.12)
May05 18:44:42 [DEBUG]  [cassandra_node_08]: end time:2014-05-05 18:54:42.100849
May05 18:44:42 [DEBUG]  [cassandra_node_08]: ssh attempt:1
May05 18:44:42 [DEBUG]  [cassandra_node_08]: Connecting to SSH
May05 18:44:42 [DEBUG]  [cassandra_node_08]: connected in 0 sec. Running SSH command
May05 18:44:42 [DEBUG]  [cassandra_node_08]: SSH command took 0 sec
May05 18:44:42 [ INFO]  [cassandra_node_08]: now ready (took 0 sec)
May05 18:44:42 [DEBUG]  [cassandra_node_08]: running SSH command:

     sed -i "/.*cassandra.*/g" /etc/hosts; sed -i "/^$/d" /etc/hosts


May05 18:44:42 [DEBUG]  [cassandra_node_08]: Connecting to SSH
May05 18:44:42 [DEBUG]  [cassandra_node_08]: connected in 0 sec. Running SSH command
May05 18:44:42 [DEBUG]  [cassandra_node_08]: SSH command took 0 sec
May05 18:44:42 [DEBUG]  [cassandra_node_08]: command returned:

 	$:  


May05 18:44:42 [DEBUG]  [cassandra_node_08]: running SSH command:

     echo '
     10.0.0.35 cassandra_seednode
     10.0.0.35 cassandra_seed_0
     10.0.0.13 cassandra_node_08
     10.0.0.31 cassandra_node_01
     10.0.0.11 cassandra_node_03
     10.0.0.38 cassandra_node_02
     10.0.0.16 cassandra_node_05
     10.0.0.45 cassandra_node_04
     10.0.0.37 cassandra_node_07
     10.0.0.44 cassandra_node_06' >> /etc/hosts; echo cassandra_node_08 >/etc/hostname


May05 18:44:42 [DEBUG]  [cassandra_node_08]: Connecting to SSH
May05 18:44:42 [DEBUG]  [cassandra_node_08]: connected in 0 sec. Running SSH command
May05 18:44:42 [DEBUG]  [cassandra_node_08]: SSH command took 0 sec
May05 18:44:42 [DEBUG]  [cassandra_node_08]: command returned:

 	$:  


May05 18:44:42 [ INFO]  [cassandra_node_08]: running bootstrap script
May05 18:44:42 [DEBUG]  [cassandra_node_08]: running SSH command:

     #!/bin/bash
     
     MAX_WAIT=300  #5 min
     
     echo "started bootstrap" > bootsrap.log
     
     # check the seednode
     if ! ping -q -c 1 cassandra_seednode &>/dev/null   ;
     then
     echo CTOOL: ERROR - cassandra_seednode not pingable, exiting
     exit -1
     fi
     
     # kill the cassandra process
     CAS_PID=$(jps | grep CassandraDaemon | awk  '{print $1}')
     echo "CTOOL: Killing CassandraDaemon ($CAS_PID)"
     kill -9 $CAS_PID
     
     # clean previous files and logs
     echo "Removing cassandra files and logs"
     #cleaning cassandra files
     rm -rf /var/lib/cassandra/*
     rm /var/log/cassandra/system.log
     #cleaning ctool rrds
     echo "Removing ganglia rrds"
     rm -rf /var/lib/ganglia/rrds/*
     rm /var/log/cassandra/system.log
     
     # find my IP
     my_priv_addr=""
     #look for an IPv4 interface in range 10.0 and use that for the cassandra communication
     let if_count=($(ifconfig | grep eth | wc -l ))-1
     for i in $(seq 0 $if_count)
     do	#look for IPv4 address
     line=$(ifconfig eth$i | grep "inet addr:")
     line=$(echo $line | awk '{print $2}')
     address=$(echo $line | sed 's/addr://g')
     if [[ "$address" == 10.0.* ]] ;
     then
     my_priv_addr=$address
     break
     fi
     done
     
     # configure cassandra
     echo "configuring cassandra.yaml for my address:$my_priv_addr" >> ctool.log
     #change the listen address of this node
     sed "s/listen_address: .*/listen_address: $my_priv_addr/g"  /etc/cassandra/cassandra.yaml> tmp && mv tmp /etc/cassandra/cassandra.yaml
     #change the rpc_address of this node to 0.0.0.0
     sed "s/rpc_address: .*/rpc_address: 0.0.0.0/g"  /etc/cassandra/cassandra.yaml> tmp && mv tmp /etc/cassandra/cassandra.yaml
     #change the seeds to "cassandra_seednode"
     sed "s/seeds: .*/seeds: \"cassandra_seednode\"/g"  /etc/cassandra/cassandra.yaml> tmp && mv tmp /etc/cassandra/cassandra.yaml
     #add the jmx server whatever to cassandra-env.sh
     sed -i.bak "s/.*-Djava.rmi.server.hostname=.*/JVM_OPTS=\"\$JVM_OPTS -Djava.rmi.server.hostname=$my_priv_addr\"/g"  /etc/cassandra/cassandra-env.sh
     sed -i.bak "s/*JVM_OPTS=\"\$JVM_OPTS -Djava.rmi.server.hostname=*\"/JVM_OPTS=\"\$JVM_OPTS -Djava.rmi.server.hostname=$my_priv_addr\"/g"  /etc/cassandra/cassandra-env.sh
     #make sure no requests are dropped by using a big timeout
     sed -i.bak "s/read_request_timeout_in_ms:.*/read_request_timeout_in_ms: 50000/g" /etc/cassandra/cassandra.yaml
     sed -i.bak "s/write_request_timeout_in_ms:.*/write_request_timeout_in_ms: 50000/g" /etc/cassandra/cassandra.yaml
     echo "CTOOL: Done configuring"
     
     
     # start cassandra
     chmod -R o+rw /var/lib/cassandra
     echo Starting casandra service, ganglia-monitor
     service cassandra start
     service ganglia-monitor restart
     
     #wait until ready and try to create keyspace
     echo "Attempting to create ycsb keyspace"
     echo "create keyspace ycsb  WITH REPLICATION = {'class' : 'SimpleStrategy', 'replication_factor': 1 }; use ycsb;  create table usertable (y_id varchar primary key, field0 varchar, field1 varchar, field2 varchar, field3 varchar, field4 varchar, field5 varchar, field6 varchar, field7 varchar, field8 varchar, field9 varchar);" > ycsb_cql.temp
     while ! cqlsh < ycsb_cql.temp 2>/dev/null;do sleep 2; done
     rm ycsb_cql.temp
     
     echo "ended bootstrap" >> bootsrap.log
     
     #report alive in gmetric
     gmetric -n alive -v 1 -t int32 -u nodes -d 10000
     
     
     


May05 18:44:42 [DEBUG]  [cassandra_node_08]: Connecting to SSH
May05 18:44:42 [DEBUG]  [cassandra_node_08]: connected in 0 sec. Running SSH command
May05 18:46:55 [DEBUG]  [cassandra_node_08]: SSH command took 132 sec
May05 18:46:55 [DEBUG]  [cassandra_node_08]: command returned:

 	$:  CTOOL: Killing CassandraDaemon ()
	$:  Removing cassandra files and logs
	$:  Removing ganglia rrds
	$:  CTOOL: Done configuring
	$:  Starting casandra service, ganglia-monitor
	$:  Stopping Ganglia Monitor Daemon: gmond.
	$:  Starting Ganglia Monitor Daemon: gmond.
	$:  Attempting to create ycsb keyspace
	$:  kill: usage: kill [-s sigspec | -n signum | -sigspec] pid | jobspec ... or kill -l [sigspec]
	$:  rm: cannot remove `/var/log/cassandra/system.log': No such file or directory
	$:  rm: cannot remove `/var/log/cassandra/system.log': No such file or directory
	$:  


May05 18:46:55 [DEBUG]  [cassandra_node_08]: command returned:
	$:  CTOOL: Killing CassandraDaemon ()
	$:  Removing cassandra files and logs
	$:  Removing ganglia rrds
	$:  CTOOL: Done configuring
	$:  Starting casandra service, ganglia-monitor
	$:  Stopping Ganglia Monitor Daemon: gmond.
	$:  Starting Ganglia Monitor Daemon: gmond.
	$:  Attempting to create ycsb keyspace
	$:  kill: usage: kill [-s sigspec | -n signum | -sigspec] pid | jobspec ... or kill -l [sigspec]
	$:  rm: cannot remove `/var/log/cassandra/system.log': No such file or directory
	$:  rm: cannot remove `/var/log/cassandra/system.log': No such file or directory
	$:  
May05 18:46:55 [ INFO]  [cassandra_node_08]: is now bootstrapped (took 132 sec)
May05 18:47:02 [DEBUG]  [cassandra_node_08]: running SSH command:

     sed -i "/.*cassandra.*/g" /etc/hosts; sed -i "/^$/d" /etc/hosts


May05 18:47:02 [DEBUG]  [cassandra_node_08]: Connecting to SSH
May05 18:47:02 [DEBUG]  [cassandra_node_08]: connected in 0 sec. Running SSH command
May05 18:47:02 [DEBUG]  [cassandra_node_08]: SSH command took 0 sec
May05 18:47:02 [DEBUG]  [cassandra_node_08]: command returned:

 	$:  


May05 18:47:02 [DEBUG]  [cassandra_node_08]: running SSH command:

     echo '
     10.0.0.35 cassandra_seednode
     10.0.0.35 cassandra_seed_0
     10.0.0.13 cassandra_node_08
     10.0.0.31 cassandra_node_01
     10.0.0.11 cassandra_node_03
     10.0.0.38 cassandra_node_02
     10.0.0.16 cassandra_node_05
     10.0.0.45 cassandra_node_04
     10.0.0.37 cassandra_node_07
     10.0.0.44 cassandra_node_06' >> /etc/hosts; echo cassandra_node_08 >/etc/hostname


May05 18:47:02 [DEBUG]  [cassandra_node_08]: Connecting to SSH
May05 18:47:02 [DEBUG]  [cassandra_node_08]: connected in 0 sec. Running SSH command
May05 18:47:02 [DEBUG]  [cassandra_node_08]: SSH command took 0 sec
May05 18:47:02 [DEBUG]  [cassandra_node_08]: command returned:

 	$:  


May05 18:55:04 [DEBUG]  [cassandra_node_08]: running SSH command:

     sed -i "/.*cassandra.*/g" /etc/hosts; sed -i "/^$/d" /etc/hosts


May05 18:55:04 [DEBUG]  [cassandra_node_08]: Connecting to SSH
May05 18:55:04 [DEBUG]  [cassandra_node_08]: connected in 0 sec. Running SSH command
May05 18:55:04 [DEBUG]  [cassandra_node_08]: SSH command took 0 sec
May05 18:55:04 [DEBUG]  [cassandra_node_08]: command returned:

 	$:  


May05 18:55:04 [DEBUG]  [cassandra_node_08]: running SSH command:

     echo '
     10.0.0.35 cassandra_seednode
     10.0.0.35 cassandra_seed_0
     10.0.0.17 cassandra_node_09
     10.0.0.13 cassandra_node_08
     10.0.0.31 cassandra_node_01
     10.0.0.11 cassandra_node_03
     10.0.0.38 cassandra_node_02
     10.0.0.16 cassandra_node_05
     10.0.0.45 cassandra_node_04
     10.0.0.37 cassandra_node_07
     10.0.0.44 cassandra_node_06' >> /etc/hosts; echo cassandra_node_08 >/etc/hostname


May05 18:55:04 [DEBUG]  [cassandra_node_08]: Connecting to SSH
May05 18:55:04 [DEBUG]  [cassandra_node_08]: connected in 0 sec. Running SSH command
May05 18:55:04 [DEBUG]  [cassandra_node_08]: SSH command took 0 sec
May05 18:55:04 [DEBUG]  [cassandra_node_08]: command returned:

 	$:  


May05 19:04:05 [DEBUG]  [cassandra_node_08]: running SSH command:

     sed -i "/.*cassandra.*/g" /etc/hosts; sed -i "/^$/d" /etc/hosts


May05 19:04:05 [DEBUG]  [cassandra_node_08]: Connecting to SSH
May05 19:04:05 [DEBUG]  [cassandra_node_08]: connected in 0 sec. Running SSH command
May05 19:04:05 [DEBUG]  [cassandra_node_08]: SSH command took 0 sec
May05 19:04:05 [DEBUG]  [cassandra_node_08]: command returned:

 	$:  


May05 19:04:05 [DEBUG]  [cassandra_node_08]: running SSH command:

     echo '
     10.0.0.35 cassandra_seednode
     10.0.0.30 cassandra_node_10
     10.0.0.35 cassandra_seed_0
     10.0.0.17 cassandra_node_09
     10.0.0.13 cassandra_node_08
     10.0.0.31 cassandra_node_01
     10.0.0.11 cassandra_node_03
     10.0.0.38 cassandra_node_02
     10.0.0.16 cassandra_node_05
     10.0.0.45 cassandra_node_04
     10.0.0.37 cassandra_node_07
     10.0.0.44 cassandra_node_06' >> /etc/hosts; echo cassandra_node_08 >/etc/hostname


May05 19:04:05 [DEBUG]  [cassandra_node_08]: Connecting to SSH
May05 19:04:05 [DEBUG]  [cassandra_node_08]: connected in 0 sec. Running SSH command
May05 19:04:05 [DEBUG]  [cassandra_node_08]: SSH command took 0 sec
May05 19:04:05 [DEBUG]  [cassandra_node_08]: command returned:

 	$:  


May05 19:12:34 [DEBUG]  [cassandra_node_08]: running SSH command:

     sed -i "/.*cassandra.*/g" /etc/hosts; sed -i "/^$/d" /etc/hosts


May05 19:12:34 [DEBUG]  [cassandra_node_08]: Connecting to SSH
May05 19:12:34 [DEBUG]  [cassandra_node_08]: connected in 0 sec. Running SSH command
May05 19:12:35 [DEBUG]  [cassandra_node_08]: SSH command took 0 sec
May05 19:12:35 [DEBUG]  [cassandra_node_08]: command returned:

 	$:  


May05 19:12:35 [DEBUG]  [cassandra_node_08]: running SSH command:

     echo '
     10.0.0.35 cassandra_seednode
     10.0.0.18 cassandra_node_11
     10.0.0.30 cassandra_node_10
     10.0.0.35 cassandra_seed_0
     10.0.0.17 cassandra_node_09
     10.0.0.13 cassandra_node_08
     10.0.0.42 cassandra_node_12
     10.0.0.33 cassandra_node_14
     10.0.0.31 cassandra_node_01
     10.0.0.41 cassandra_node_13
     10.0.0.11 cassandra_node_03
     10.0.0.38 cassandra_node_02
     10.0.0.16 cassandra_node_05
     10.0.0.45 cassandra_node_04
     10.0.0.37 cassandra_node_07
     10.0.0.44 cassandra_node_06' >> /etc/hosts; echo cassandra_node_08 >/etc/hostname


May05 19:12:35 [DEBUG]  [cassandra_node_08]: Connecting to SSH
May05 19:12:35 [DEBUG]  [cassandra_node_08]: connected in 0 sec. Running SSH command
May05 19:12:35 [DEBUG]  [cassandra_node_08]: SSH command took 0 sec
May05 19:12:35 [DEBUG]  [cassandra_node_08]: command returned:

 	$:  


May05 20:33:02 [DEBUG]  [cassandra_node_08]: cluster = cassandra
May05 20:33:02 [ INFO]  [cassandra_node_08]: running kill script
May05 20:33:02 [DEBUG]  [cassandra_node_08]: running SSH command:

     #!/bin/sh
     CAS_PID=$(jps | grep CassandraDaemon | awk  '{print $1}')
     echo "CTOOL: Killing CassandraDaemon ($CAS_PID)"
     kill -9 $CAS_PID &>/dev/null
     ## maybe problematic
     killall java
     
     
     
     ################ debug #################3
     echo "Removing cassandra files and logs" &>>ctool.log
     #cleaning cassandra files
     rm -rf /var/lib/cassandra/* &>>ctool.log
     rm /var/log/cassandra/system.log &>>ctool.log
     #cleaning ctool rrds
     echo "Removing ganglia rrds" &>>ctool.log
     rm -rf /var/lib/ganglia/rrds/* &>>ctool.log
     
     
     
     
     
     echo '
     
     ############  KILLED  ##############' >> ycsb_run.log
     
     #report not alive
     gmetric -n alive -v 0 -t int32 -u nodes -d 10000
     


May05 20:33:02 [DEBUG]  [cassandra_node_08]: Connecting to SSH
May05 20:33:03 [DEBUG]  [cassandra_node_08]: connected in 1 sec. Running SSH command
May05 20:33:05 [DEBUG]  [cassandra_node_08]: SSH command took 1 sec
May05 20:33:05 [DEBUG]  [cassandra_node_08]: command returned:

 	$:  CTOOL: Killing CassandraDaemon (21655)
	$:  


May05 20:33:29 [DEBUG]  [cassandra_node_08]: cluster = cassandra
May05 20:34:00 [DEBUG]  [cassandra_node_08]: cluster = cassandra
May05 20:43:14 [DEBUG]  [cassandra_node_08]: cluster = cassandra
May05 20:43:28 [DEBUG]  [cassandra_node_08]: cluster = cassandra
May05 21:01:24 [DEBUG]  [cassandra_node_08]: cluster = cassandra
May05 21:01:39 [DEBUG]  [cassandra_node_08]: cluster = cassandra
May05 21:07:10 [ INFO]  [cassandra_node_08]: Waiting for SSH daemon (83.212.118.12)
May05 21:07:10 [DEBUG]  [cassandra_node_08]: end time:2014-05-05 21:17:10.580941
May05 21:07:10 [DEBUG]  [cassandra_node_08]: ssh attempt:1
May05 21:07:10 [DEBUG]  [cassandra_node_08]: Connecting to SSH
May05 21:07:10 [DEBUG]  [cassandra_node_08]: connected in 0 sec. Running SSH command
May05 21:07:10 [DEBUG]  [cassandra_node_08]: SSH command took 0 sec
May05 21:07:10 [ INFO]  [cassandra_node_08]: now ready (took 0 sec)
May05 21:07:10 [DEBUG]  [cassandra_node_08]: running SSH command:

     sed -i "/.*cassandra.*/g" /etc/hosts; sed -i "/^$/d" /etc/hosts


May05 21:07:10 [DEBUG]  [cassandra_node_08]: Connecting to SSH
May05 21:07:10 [DEBUG]  [cassandra_node_08]: connected in 0 sec. Running SSH command
May05 21:07:10 [DEBUG]  [cassandra_node_08]: SSH command took 0 sec
May05 21:07:10 [DEBUG]  [cassandra_node_08]: command returned:

 	$:  


May05 21:07:10 [DEBUG]  [cassandra_node_08]: running SSH command:

     echo '
     10.0.0.35 cassandra_seednode
     10.0.0.35 cassandra_seed_0
     10.0.0.13 cassandra_node_08
     10.0.0.31 cassandra_node_01
     10.0.0.11 cassandra_node_03
     10.0.0.38 cassandra_node_02
     10.0.0.16 cassandra_node_05
     10.0.0.45 cassandra_node_04
     10.0.0.37 cassandra_node_07
     10.0.0.44 cassandra_node_06' >> /etc/hosts; echo cassandra_node_08 >/etc/hostname


May05 21:07:10 [DEBUG]  [cassandra_node_08]: Connecting to SSH
May05 21:07:11 [DEBUG]  [cassandra_node_08]: connected in 0 sec. Running SSH command
May05 21:07:11 [DEBUG]  [cassandra_node_08]: SSH command took 0 sec
May05 21:07:11 [DEBUG]  [cassandra_node_08]: command returned:

 	$:  


May05 21:07:11 [ INFO]  [cassandra_node_08]: running bootstrap script
May05 21:07:11 [DEBUG]  [cassandra_node_08]: running SSH command:

     #!/bin/bash
     
     MAX_WAIT=300  #5 min
     
     echo "started bootstrap" > bootsrap.log
     
     # check the seednode
     if ! ping -q -c 1 cassandra_seednode &>/dev/null   ;
     then
     echo CTOOL: ERROR - cassandra_seednode not pingable, exiting
     exit -1
     fi
     
     # kill the cassandra process
     CAS_PID=$(jps | grep CassandraDaemon | awk  '{print $1}')
     echo "CTOOL: Killing CassandraDaemon ($CAS_PID)"
     kill -9 $CAS_PID
     
     # clean previous files and logs
     echo "Removing cassandra files and logs"
     #cleaning cassandra files
     rm -rf /var/lib/cassandra/*
     rm /var/log/cassandra/system.log
     #cleaning ctool rrds
     echo "Removing ganglia rrds"
     rm -rf /var/lib/ganglia/rrds/*
     rm /var/log/cassandra/system.log
     
     # find my IP
     my_priv_addr=""
     #look for an IPv4 interface in range 10.0 and use that for the cassandra communication
     let if_count=($(ifconfig | grep eth | wc -l ))-1
     for i in $(seq 0 $if_count)
     do	#look for IPv4 address
     line=$(ifconfig eth$i | grep "inet addr:")
     line=$(echo $line | awk '{print $2}')
     address=$(echo $line | sed 's/addr://g')
     if [[ "$address" == 10.0.* ]] ;
     then
     my_priv_addr=$address
     break
     fi
     done
     
     # configure cassandra
     echo "configuring cassandra.yaml for my address:$my_priv_addr" >> ctool.log
     #change the listen address of this node
     sed "s/listen_address: .*/listen_address: $my_priv_addr/g"  /etc/cassandra/cassandra.yaml> tmp && mv tmp /etc/cassandra/cassandra.yaml
     #change the rpc_address of this node to 0.0.0.0
     sed "s/rpc_address: .*/rpc_address: 0.0.0.0/g"  /etc/cassandra/cassandra.yaml> tmp && mv tmp /etc/cassandra/cassandra.yaml
     #change the seeds to "cassandra_seednode"
     sed "s/seeds: .*/seeds: \"cassandra_seednode\"/g"  /etc/cassandra/cassandra.yaml> tmp && mv tmp /etc/cassandra/cassandra.yaml
     #add the jmx server whatever to cassandra-env.sh
     sed -i.bak "s/.*-Djava.rmi.server.hostname=.*/JVM_OPTS=\"\$JVM_OPTS -Djava.rmi.server.hostname=$my_priv_addr\"/g"  /etc/cassandra/cassandra-env.sh
     sed -i.bak "s/*JVM_OPTS=\"\$JVM_OPTS -Djava.rmi.server.hostname=*\"/JVM_OPTS=\"\$JVM_OPTS -Djava.rmi.server.hostname=$my_priv_addr\"/g"  /etc/cassandra/cassandra-env.sh
     #make sure no requests are dropped by using a big timeout
     sed -i.bak "s/read_request_timeout_in_ms:.*/read_request_timeout_in_ms: 50000/g" /etc/cassandra/cassandra.yaml
     sed -i.bak "s/write_request_timeout_in_ms:.*/write_request_timeout_in_ms: 50000/g" /etc/cassandra/cassandra.yaml
     echo "CTOOL: Done configuring"
     
     
     # start cassandra
     chmod -R o+rw /var/lib/cassandra
     echo Starting casandra service, ganglia-monitor
     service cassandra start
     service ganglia-monitor restart
     
     #wait until ready and try to create keyspace
     echo "Attempting to create ycsb keyspace"
     echo "create keyspace ycsb  WITH REPLICATION = {'class' : 'SimpleStrategy', 'replication_factor': 1 }; use ycsb;  create table usertable (y_id varchar primary key, field0 varchar, field1 varchar, field2 varchar, field3 varchar, field4 varchar, field5 varchar, field6 varchar, field7 varchar, field8 varchar, field9 varchar);" > ycsb_cql.temp
     while ! cqlsh < ycsb_cql.temp 2>/dev/null;do sleep 2; done
     rm ycsb_cql.temp
     
     echo "ended bootstrap" >> bootsrap.log
     
     #report alive in gmetric
     gmetric -n alive -v 1 -t int32 -u nodes -d 10000
     
     
     


May05 21:07:11 [DEBUG]  [cassandra_node_08]: Connecting to SSH
May05 21:07:11 [DEBUG]  [cassandra_node_08]: connected in 0 sec. Running SSH command
May06 12:39:52 [DEBUG]  [cassandra_node_08]: cluster = cassandra
May06 12:39:52 [ INFO]  [cassandra_node_08]: running kill script
May06 12:39:52 [DEBUG]  [cassandra_node_08]: running SSH command:

     #!/bin/sh
     CAS_PID=$(jps | grep CassandraDaemon | awk  '{print $1}')
     echo "CTOOL: Killing CassandraDaemon ($CAS_PID)"
     kill -9 $CAS_PID &>/dev/null
     ## maybe problematic
     killall java
     
     
     
     ################ debug #################3
     echo "Removing cassandra files and logs" &>>ctool.log
     #cleaning cassandra files
     rm -rf /var/lib/cassandra/* &>>ctool.log
     rm /var/log/cassandra/system.log &>>ctool.log
     #cleaning ctool rrds
     echo "Removing ganglia rrds" &>>ctool.log
     rm -rf /var/lib/ganglia/rrds/* &>>ctool.log
     
     
     
     
     
     echo '
     
     ############  KILLED  ##############' >> ycsb_run.log
     
     #report not alive
     gmetric -n alive -v 0 -t int32 -u nodes -d 10000
     


May06 12:39:52 [DEBUG]  [cassandra_node_08]: Connecting to SSH
May06 12:39:53 [DEBUG]  [cassandra_node_08]: connected in 0 sec. Running SSH command
May06 12:39:53 [DEBUG]  [cassandra_node_08]: SSH command took 0 sec
May06 12:39:53 [DEBUG]  [cassandra_node_08]: command returned:

 	$:  CTOOL: Killing CassandraDaemon ()
	$:  java: no process found
	$:  


May06 12:41:10 [DEBUG]  [cassandra_node_08]: cluster = cassandra
May06 12:41:26 [DEBUG]  [cassandra_node_08]: cluster = cassandra
May06 12:49:04 [DEBUG]  [cassandra_node_08]: cluster = cassandra
May06 12:49:17 [DEBUG]  [cassandra_node_08]: cluster = cassandra
May06 13:25:21 [DEBUG]  [cassandra_node_08]: cluster = cassandra
May06 13:25:36 [DEBUG]  [cassandra_node_08]: cluster = cassandra
May06 13:31:08 [ INFO]  [cassandra_node_08]: Waiting for SSH daemon (83.212.118.12)
May06 13:31:08 [DEBUG]  [cassandra_node_08]: end time:2014-05-06 13:41:08.262896
May06 13:31:08 [DEBUG]  [cassandra_node_08]: ssh attempt:1
May06 13:31:08 [DEBUG]  [cassandra_node_08]: Connecting to SSH
May06 13:31:08 [DEBUG]  [cassandra_node_08]: connected in 0 sec. Running SSH command
May06 13:31:08 [DEBUG]  [cassandra_node_08]: SSH command took 0 sec
May06 13:31:08 [ INFO]  [cassandra_node_08]: now ready (took 0 sec)
May06 13:31:08 [DEBUG]  [cassandra_node_08]: running SSH command:

     sed -i "/.*cassandra.*/g" /etc/hosts; sed -i "/^$/d" /etc/hosts


May06 13:31:08 [DEBUG]  [cassandra_node_08]: Connecting to SSH
May06 13:31:08 [DEBUG]  [cassandra_node_08]: connected in 0 sec. Running SSH command
May06 13:31:08 [DEBUG]  [cassandra_node_08]: SSH command took 0 sec
May06 13:31:08 [DEBUG]  [cassandra_node_08]: command returned:

 	$:  


May06 13:31:08 [DEBUG]  [cassandra_node_08]: running SSH command:

     echo '
     10.0.0.35 cassandra_seednode
     10.0.0.35 cassandra_seed_0
     10.0.0.13 cassandra_node_08
     10.0.0.31 cassandra_node_01
     10.0.0.11 cassandra_node_03
     10.0.0.38 cassandra_node_02
     10.0.0.16 cassandra_node_05
     10.0.0.45 cassandra_node_04
     10.0.0.37 cassandra_node_07
     10.0.0.44 cassandra_node_06' >> /etc/hosts; echo cassandra_node_08 >/etc/hostname


May06 13:31:08 [DEBUG]  [cassandra_node_08]: Connecting to SSH
May06 13:31:08 [DEBUG]  [cassandra_node_08]: connected in 0 sec. Running SSH command
May06 13:31:08 [DEBUG]  [cassandra_node_08]: SSH command took 0 sec
May06 13:31:08 [DEBUG]  [cassandra_node_08]: command returned:

 	$:  


May06 13:31:08 [ INFO]  [cassandra_node_08]: running bootstrap script
May06 13:31:08 [DEBUG]  [cassandra_node_08]: running SSH command:

     #!/bin/bash
     
     MAX_WAIT=300  #5 min
     
     echo "started bootstrap" > bootsrap.log
     
     # check the seednode
     if ! ping -q -c 1 cassandra_seednode &>/dev/null   ;
     then
     echo CTOOL: ERROR - cassandra_seednode not pingable, exiting
     exit -1
     fi
     
     # kill the cassandra process
     CAS_PID=$(jps | grep CassandraDaemon | awk  '{print $1}')
     echo "CTOOL: Killing CassandraDaemon ($CAS_PID)"
     kill -9 $CAS_PID
     
     # clean previous files and logs
     echo "Removing cassandra files and logs"
     #cleaning cassandra files
     rm -rf /var/lib/cassandra/*
     rm /var/log/cassandra/system.log
     #cleaning ctool rrds
     echo "Removing ganglia rrds"
     rm -rf /var/lib/ganglia/rrds/*
     rm /var/log/cassandra/system.log
     
     # find my IP
     my_priv_addr=""
     #look for an IPv4 interface in range 10.0 and use that for the cassandra communication
     let if_count=($(ifconfig | grep eth | wc -l ))-1
     for i in $(seq 0 $if_count)
     do	#look for IPv4 address
     line=$(ifconfig eth$i | grep "inet addr:")
     line=$(echo $line | awk '{print $2}')
     address=$(echo $line | sed 's/addr://g')
     if [[ "$address" == 10.0.* ]] ;
     then
     my_priv_addr=$address
     break
     fi
     done
     
     # configure cassandra
     echo "configuring cassandra.yaml for my address:$my_priv_addr" >> ctool.log
     #change the listen address of this node
     sed "s/listen_address: .*/listen_address: $my_priv_addr/g"  /etc/cassandra/cassandra.yaml> tmp && mv tmp /etc/cassandra/cassandra.yaml
     #change the rpc_address of this node to 0.0.0.0
     sed "s/rpc_address: .*/rpc_address: 0.0.0.0/g"  /etc/cassandra/cassandra.yaml> tmp && mv tmp /etc/cassandra/cassandra.yaml
     #change the seeds to "cassandra_seednode"
     sed "s/seeds: .*/seeds: \"cassandra_seednode\"/g"  /etc/cassandra/cassandra.yaml> tmp && mv tmp /etc/cassandra/cassandra.yaml
     #add the jmx server whatever to cassandra-env.sh
     sed -i.bak "s/.*-Djava.rmi.server.hostname=.*/JVM_OPTS=\"\$JVM_OPTS -Djava.rmi.server.hostname=$my_priv_addr\"/g"  /etc/cassandra/cassandra-env.sh
     sed -i.bak "s/*JVM_OPTS=\"\$JVM_OPTS -Djava.rmi.server.hostname=*\"/JVM_OPTS=\"\$JVM_OPTS -Djava.rmi.server.hostname=$my_priv_addr\"/g"  /etc/cassandra/cassandra-env.sh
     #make sure no requests are dropped by using a big timeout
     sed -i.bak "s/read_request_timeout_in_ms:.*/read_request_timeout_in_ms: 50000/g" /etc/cassandra/cassandra.yaml
     sed -i.bak "s/write_request_timeout_in_ms:.*/write_request_timeout_in_ms: 50000/g" /etc/cassandra/cassandra.yaml
     echo "CTOOL: Done configuring"
     
     
     # start cassandra
     chmod -R o+rw /var/lib/cassandra
     echo Starting casandra service, ganglia-monitor
     service cassandra start
     service ganglia-monitor restart
     
     #wait until ready and try to create keyspace
     echo "Attempting to create ycsb keyspace"
     echo "create keyspace ycsb  WITH REPLICATION = {'class' : 'SimpleStrategy', 'replication_factor': 1 }; use ycsb;  create table usertable (y_id varchar primary key, field0 varchar, field1 varchar, field2 varchar, field3 varchar, field4 varchar, field5 varchar, field6 varchar, field7 varchar, field8 varchar, field9 varchar);" > ycsb_cql.temp
     while ! cqlsh < ycsb_cql.temp 2>/dev/null;do sleep 2; done
     rm ycsb_cql.temp
     
     echo "ended bootstrap" >> bootsrap.log
     
     #report alive in gmetric
     gmetric -n alive -v 1 -t int32 -u nodes -d 10000
     
     
     


May06 13:31:08 [DEBUG]  [cassandra_node_08]: Connecting to SSH
May06 13:31:08 [DEBUG]  [cassandra_node_08]: connected in 0 sec. Running SSH command
May06 14:42:55 [DEBUG]  [cassandra_node_08]: cluster = cassandra
May06 14:47:27 [DEBUG]  [cassandra_node_08]: cluster = cassandra
May06 14:47:27 [ INFO]  [cassandra_node_08]: running decommission script
May06 14:47:27 [DEBUG]  [cassandra_node_08]: running SSH command:

     #!/bin/sh
     nodetool repair -h 127.0.0.1 ycsb
     nodetool decommission
     #kill cassandra
     CAS_PID=$(jps | grep CassandraDaemon | awk  '{print $1}')
     echo "CTOOL: Killing CassandraDaemon ($CAS_PID)" >> ctool.log
     kill $CAS_PID &>/dev/null
     
     
     #report not alive
     gmetric -n alive -v 0 -t int32 -u nodes -d 10000
     


May06 14:47:27 [DEBUG]  [cassandra_node_08]: Connecting to SSH
May06 14:47:27 [DEBUG]  [cassandra_node_08]: connected in 0 sec. Running SSH command
May06 14:51:24 [DEBUG]  [cassandra_node_08]: SSH command took 237 sec
May06 14:51:24 [DEBUG]  [cassandra_node_08]: command returned:

 	$:  [2014-05-06 14:47:38,900] Starting repair command #1, repairing 256 ranges for keyspace ycsb
	$:  [2014-05-06 14:47:49,535] Repair command #1 finished
	$:  


May06 14:51:24 [ INFO]  [cassandra_node_08]: now decommissioned (took 237 sec)
May06 14:52:01 [DEBUG]  [cassandra_node_08]: cluster = cassandra
May06 14:56:22 [DEBUG]  [cassandra_node_08]: cluster = cassandra
May06 14:56:22 [ INFO]  [cassandra_node_08]: running kill script
May06 14:56:22 [DEBUG]  [cassandra_node_08]: running SSH command:

     #!/bin/sh
     CAS_PID=$(jps | grep CassandraDaemon | awk  '{print $1}')
     echo "CTOOL: Killing CassandraDaemon ($CAS_PID)"
     kill -9 $CAS_PID &>/dev/null
     ## maybe problematic
     killall java
     
     
     
     ################ debug #################3
     echo "Removing cassandra files and logs" &>>ctool.log
     #cleaning cassandra files
     rm -rf /var/lib/cassandra/* &>>ctool.log
     rm /var/log/cassandra/system.log &>>ctool.log
     #cleaning ctool rrds
     echo "Removing ganglia rrds" &>>ctool.log
     rm -rf /var/lib/ganglia/rrds/* &>>ctool.log
     
     
     
     
     
     echo '
     
     ############  KILLED  ##############' >> ycsb_run.log
     
     #report not alive
     gmetric -n alive -v 0 -t int32 -u nodes -d 10000
     


May06 14:56:22 [DEBUG]  [cassandra_node_08]: Connecting to SSH
May06 14:56:22 [DEBUG]  [cassandra_node_08]: connected in 0 sec. Running SSH command
May06 14:56:23 [DEBUG]  [cassandra_node_08]: SSH command took 0 sec
May06 14:56:23 [DEBUG]  [cassandra_node_08]: command returned:

 	$:  CTOOL: Killing CassandraDaemon ()
	$:  java: no process found
	$:  


May06 14:57:09 [DEBUG]  [cassandra_node_08]: cluster = cassandra
May06 14:57:09 [ INFO]  [cassandra_node_08]: running kill script
May06 14:57:09 [DEBUG]  [cassandra_node_08]: running SSH command:

     #!/bin/sh
     CAS_PID=$(jps | grep CassandraDaemon | awk  '{print $1}')
     echo "CTOOL: Killing CassandraDaemon ($CAS_PID)"
     kill -9 $CAS_PID &>/dev/null
     ## maybe problematic
     killall java
     
     
     
     ################ debug #################3
     echo "Removing cassandra files and logs" &>>ctool.log
     #cleaning cassandra files
     rm -rf /var/lib/cassandra/* &>>ctool.log
     rm /var/log/cassandra/system.log &>>ctool.log
     #cleaning ctool rrds
     echo "Removing ganglia rrds" &>>ctool.log
     rm -rf /var/lib/ganglia/rrds/* &>>ctool.log
     
     
     
     
     
     echo '
     
     ############  KILLED  ##############' >> ycsb_run.log
     
     #report not alive
     gmetric -n alive -v 0 -t int32 -u nodes -d 10000
     


May06 14:57:09 [DEBUG]  [cassandra_node_08]: Connecting to SSH
May06 14:57:09 [DEBUG]  [cassandra_node_08]: connected in 0 sec. Running SSH command
May06 14:57:10 [DEBUG]  [cassandra_node_08]: SSH command took 0 sec
May06 14:57:10 [DEBUG]  [cassandra_node_08]: command returned:

 	$:  CTOOL: Killing CassandraDaemon ()
	$:  java: no process found
	$:  


May06 14:57:25 [DEBUG]  [cassandra_node_08]: cluster = cassandra
May06 14:57:49 [DEBUG]  [cassandra_node_08]: cluster = cassandra
May06 15:05:23 [DEBUG]  [cassandra_node_08]: cluster = cassandra
May06 15:05:38 [DEBUG]  [cassandra_node_08]: cluster = cassandra
May06 15:08:49 [DEBUG]  [cassandra_node_08]: cluster = cassandra
May06 15:09:03 [DEBUG]  [cassandra_node_08]: cluster = cassandra
May06 15:12:32 [DEBUG]  [cassandra_node_08]: cluster = cassandra
May06 15:12:48 [DEBUG]  [cassandra_node_08]: cluster = cassandra
May06 15:18:20 [ INFO]  [cassandra_node_08]: Waiting for SSH daemon (83.212.118.12)
May06 15:18:20 [DEBUG]  [cassandra_node_08]: end time:2014-05-06 15:28:20.075234
May06 15:18:20 [DEBUG]  [cassandra_node_08]: ssh attempt:1
May06 15:18:20 [DEBUG]  [cassandra_node_08]: Connecting to SSH
May06 15:18:20 [DEBUG]  [cassandra_node_08]: connected in 0 sec. Running SSH command
May06 15:18:20 [DEBUG]  [cassandra_node_08]: SSH command took 0 sec
May06 15:18:20 [ INFO]  [cassandra_node_08]: now ready (took 0 sec)
May06 15:18:20 [DEBUG]  [cassandra_node_08]: running SSH command:

     sed -i "/.*cassandra.*/g" /etc/hosts; sed -i "/^$/d" /etc/hosts


May06 15:18:20 [DEBUG]  [cassandra_node_08]: Connecting to SSH
May06 15:18:20 [DEBUG]  [cassandra_node_08]: connected in 0 sec. Running SSH command
May06 15:18:20 [DEBUG]  [cassandra_node_08]: SSH command took 0 sec
May06 15:18:20 [DEBUG]  [cassandra_node_08]: command returned:

 	$:  


May06 15:18:20 [DEBUG]  [cassandra_node_08]: running SSH command:

     echo '
     10.0.0.35 cassandra_seednode
     10.0.0.35 cassandra_seed_0
     10.0.0.13 cassandra_node_08
     10.0.0.31 cassandra_node_01
     10.0.0.11 cassandra_node_03
     10.0.0.38 cassandra_node_02
     10.0.0.16 cassandra_node_05
     10.0.0.45 cassandra_node_04
     10.0.0.37 cassandra_node_07
     10.0.0.44 cassandra_node_06' >> /etc/hosts; echo cassandra_node_08 >/etc/hostname


May06 15:18:20 [DEBUG]  [cassandra_node_08]: Connecting to SSH
May06 15:18:20 [DEBUG]  [cassandra_node_08]: connected in 0 sec. Running SSH command
May06 15:18:20 [DEBUG]  [cassandra_node_08]: SSH command took 0 sec
May06 15:18:20 [DEBUG]  [cassandra_node_08]: command returned:

 	$:  


May06 15:18:20 [ INFO]  [cassandra_node_08]: running bootstrap script
May06 15:18:20 [DEBUG]  [cassandra_node_08]: running SSH command:

     #!/bin/bash
     
     MAX_WAIT=300  #5 min
     
     echo "started bootstrap" > bootsrap.log
     
     # check the seednode
     if ! ping -q -c 1 cassandra_seednode &>/dev/null   ;
     then
     echo CTOOL: ERROR - cassandra_seednode not pingable, exiting
     exit -1
     fi
     
     # kill the cassandra process
     CAS_PID=$(jps | grep CassandraDaemon | awk  '{print $1}')
     echo "CTOOL: Killing CassandraDaemon ($CAS_PID)"
     kill -9 $CAS_PID
     
     # clean previous files and logs
     echo "Removing cassandra files and logs"
     #cleaning cassandra files
     rm -rf /var/lib/cassandra/*
     rm /var/log/cassandra/system.log
     #cleaning ctool rrds
     echo "Removing ganglia rrds"
     rm -rf /var/lib/ganglia/rrds/*
     rm /var/log/cassandra/system.log
     
     # find my IP
     my_priv_addr=""
     #look for an IPv4 interface in range 10.0 and use that for the cassandra communication
     let if_count=($(ifconfig | grep eth | wc -l ))-1
     for i in $(seq 0 $if_count)
     do	#look for IPv4 address
     line=$(ifconfig eth$i | grep "inet addr:")
     line=$(echo $line | awk '{print $2}')
     address=$(echo $line | sed 's/addr://g')
     if [[ "$address" == 10.0.* ]] ;
     then
     my_priv_addr=$address
     break
     fi
     done
     
     # configure cassandra
     echo "configuring cassandra.yaml for my address:$my_priv_addr" >> ctool.log
     #change the listen address of this node
     sed "s/listen_address: .*/listen_address: $my_priv_addr/g"  /etc/cassandra/cassandra.yaml> tmp && mv tmp /etc/cassandra/cassandra.yaml
     #change the rpc_address of this node to 0.0.0.0
     sed "s/rpc_address: .*/rpc_address: 0.0.0.0/g"  /etc/cassandra/cassandra.yaml> tmp && mv tmp /etc/cassandra/cassandra.yaml
     #change the seeds to "cassandra_seednode"
     sed "s/seeds: .*/seeds: \"cassandra_seednode\"/g"  /etc/cassandra/cassandra.yaml> tmp && mv tmp /etc/cassandra/cassandra.yaml
     #add the jmx server whatever to cassandra-env.sh
     sed -i.bak "s/.*-Djava.rmi.server.hostname=.*/JVM_OPTS=\"\$JVM_OPTS -Djava.rmi.server.hostname=$my_priv_addr\"/g"  /etc/cassandra/cassandra-env.sh
     sed -i.bak "s/*JVM_OPTS=\"\$JVM_OPTS -Djava.rmi.server.hostname=*\"/JVM_OPTS=\"\$JVM_OPTS -Djava.rmi.server.hostname=$my_priv_addr\"/g"  /etc/cassandra/cassandra-env.sh
     #make sure no requests are dropped by using a big timeout
     sed -i.bak "s/read_request_timeout_in_ms:.*/read_request_timeout_in_ms: 50000/g" /etc/cassandra/cassandra.yaml
     sed -i.bak "s/write_request_timeout_in_ms:.*/write_request_timeout_in_ms: 50000/g" /etc/cassandra/cassandra.yaml
     echo "CTOOL: Done configuring"
     
     
     # start cassandra
     chmod -R o+rw /var/lib/cassandra
     echo Starting casandra service, ganglia-monitor
     service cassandra start
     service ganglia-monitor restart
     
     #wait until ready and try to create keyspace
     echo "Attempting to create ycsb keyspace"
     echo "create keyspace ycsb  WITH REPLICATION = {'class' : 'SimpleStrategy', 'replication_factor': 1 }; use ycsb;  create table usertable (y_id varchar primary key, field0 varchar, field1 varchar, field2 varchar, field3 varchar, field4 varchar, field5 varchar, field6 varchar, field7 varchar, field8 varchar, field9 varchar);" > ycsb_cql.temp
     while ! cqlsh < ycsb_cql.temp 2>/dev/null;do sleep 2; done
     rm ycsb_cql.temp
     
     echo "ended bootstrap" >> bootsrap.log
     
     #report alive in gmetric
     gmetric -n alive -v 1 -t int32 -u nodes -d 10000
     
     
     


May06 15:18:20 [DEBUG]  [cassandra_node_08]: Connecting to SSH
May06 15:18:20 [DEBUG]  [cassandra_node_08]: connected in 0 sec. Running SSH command
May06 15:19:28 [DEBUG]  [cassandra_node_08]: SSH command took 67 sec
May06 15:19:28 [DEBUG]  [cassandra_node_08]: command returned:

 	$:  CTOOL: Killing CassandraDaemon ()
	$:  Removing cassandra files and logs
	$:  Removing ganglia rrds
	$:  CTOOL: Done configuring
	$:  Starting casandra service, ganglia-monitor
	$:  Stopping Ganglia Monitor Daemon: gmond.
	$:  Starting Ganglia Monitor Daemon: gmond.
	$:  Attempting to create ycsb keyspace
	$:  kill: usage: kill [-s sigspec | -n signum | -sigspec] pid | jobspec ... or kill -l [sigspec]
	$:  rm: cannot remove `/var/log/cassandra/system.log': No such file or directory
	$:  rm: cannot remove `/var/log/cassandra/system.log': No such file or directory
	$:  rm: cannot remove `ycsb_cql.temp': No such file or directory
	$:  


May06 15:19:28 [DEBUG]  [cassandra_node_08]: command returned:
	$:  CTOOL: Killing CassandraDaemon ()
	$:  Removing cassandra files and logs
	$:  Removing ganglia rrds
	$:  CTOOL: Done configuring
	$:  Starting casandra service, ganglia-monitor
	$:  Stopping Ganglia Monitor Daemon: gmond.
	$:  Starting Ganglia Monitor Daemon: gmond.
	$:  Attempting to create ycsb keyspace
	$:  kill: usage: kill [-s sigspec | -n signum | -sigspec] pid | jobspec ... or kill -l [sigspec]
	$:  rm: cannot remove `/var/log/cassandra/system.log': No such file or directory
	$:  rm: cannot remove `/var/log/cassandra/system.log': No such file or directory
	$:  rm: cannot remove `ycsb_cql.temp': No such file or directory
	$:  
May06 15:19:28 [ INFO]  [cassandra_node_08]: is now bootstrapped (took 67 sec)
May06 15:19:32 [DEBUG]  [cassandra_node_08]: running SSH command:

     sed -i "/.*cassandra.*/g" /etc/hosts; sed -i "/^$/d" /etc/hosts


May06 15:19:32 [DEBUG]  [cassandra_node_08]: Connecting to SSH
May06 15:19:33 [DEBUG]  [cassandra_node_08]: connected in 0 sec. Running SSH command
May06 15:19:33 [DEBUG]  [cassandra_node_08]: SSH command took 0 sec
May06 15:19:33 [DEBUG]  [cassandra_node_08]: command returned:

 	$:  


May06 15:19:33 [DEBUG]  [cassandra_node_08]: running SSH command:

     echo '
     10.0.0.35 cassandra_seednode
     10.0.0.35 cassandra_seed_0
     10.0.0.13 cassandra_node_08
     10.0.0.31 cassandra_node_01
     10.0.0.11 cassandra_node_03
     10.0.0.38 cassandra_node_02
     10.0.0.16 cassandra_node_05
     10.0.0.45 cassandra_node_04
     10.0.0.37 cassandra_node_07
     10.0.0.44 cassandra_node_06' >> /etc/hosts; echo cassandra_node_08 >/etc/hostname


May06 15:19:33 [DEBUG]  [cassandra_node_08]: Connecting to SSH
May06 15:19:33 [DEBUG]  [cassandra_node_08]: connected in 0 sec. Running SSH command
May06 15:19:33 [DEBUG]  [cassandra_node_08]: SSH command took 0 sec
May06 15:19:33 [DEBUG]  [cassandra_node_08]: command returned:

 	$:  


May06 15:26:03 [DEBUG]  [cassandra_node_08]: running SSH command:

     sed -i "/.*cassandra.*/g" /etc/hosts; sed -i "/^$/d" /etc/hosts


May06 15:26:03 [DEBUG]  [cassandra_node_08]: Connecting to SSH
May06 15:26:04 [DEBUG]  [cassandra_node_08]: connected in 0 sec. Running SSH command
May06 15:26:04 [DEBUG]  [cassandra_node_08]: SSH command took 0 sec
May06 15:26:04 [DEBUG]  [cassandra_node_08]: command returned:

 	$:  


May06 15:26:04 [DEBUG]  [cassandra_node_08]: running SSH command:

     echo '
     10.0.0.35 cassandra_seednode
     10.0.0.30 cassandra_node_10
     10.0.0.35 cassandra_seed_0
     10.0.0.17 cassandra_node_09
     10.0.0.13 cassandra_node_08
     10.0.0.31 cassandra_node_01
     10.0.0.11 cassandra_node_03
     10.0.0.38 cassandra_node_02
     10.0.0.16 cassandra_node_05
     10.0.0.45 cassandra_node_04
     10.0.0.37 cassandra_node_07
     10.0.0.44 cassandra_node_06' >> /etc/hosts; echo cassandra_node_08 >/etc/hostname


May06 15:26:04 [DEBUG]  [cassandra_node_08]: Connecting to SSH
May06 15:26:04 [DEBUG]  [cassandra_node_08]: connected in 0 sec. Running SSH command
May06 15:26:04 [DEBUG]  [cassandra_node_08]: SSH command took 0 sec
May06 15:26:04 [DEBUG]  [cassandra_node_08]: command returned:

 	$:  


May06 15:32:57 [DEBUG]  [cassandra_node_08]: running SSH command:

     sed -i "/.*cassandra.*/g" /etc/hosts; sed -i "/^$/d" /etc/hosts


May06 15:32:57 [DEBUG]  [cassandra_node_08]: Connecting to SSH
May06 15:32:57 [DEBUG]  [cassandra_node_08]: connected in 0 sec. Running SSH command
May06 15:32:57 [DEBUG]  [cassandra_node_08]: SSH command took 0 sec
May06 15:32:57 [DEBUG]  [cassandra_node_08]: command returned:

 	$:  


May06 15:32:57 [DEBUG]  [cassandra_node_08]: running SSH command:

     echo '
     10.0.0.35 cassandra_seednode
     10.0.0.35 cassandra_seed_0
     10.0.0.17 cassandra_node_09
     10.0.0.13 cassandra_node_08
     10.0.0.31 cassandra_node_01
     10.0.0.11 cassandra_node_03
     10.0.0.38 cassandra_node_02
     10.0.0.16 cassandra_node_05
     10.0.0.45 cassandra_node_04
     10.0.0.37 cassandra_node_07
     10.0.0.44 cassandra_node_06' >> /etc/hosts; echo cassandra_node_08 >/etc/hostname


May06 15:32:57 [DEBUG]  [cassandra_node_08]: Connecting to SSH
May06 15:32:57 [DEBUG]  [cassandra_node_08]: connected in 0 sec. Running SSH command
May06 15:32:57 [DEBUG]  [cassandra_node_08]: SSH command took 0 sec
May06 15:32:57 [DEBUG]  [cassandra_node_08]: command returned:

 	$:  


May06 15:39:39 [DEBUG]  [cassandra_node_08]: running SSH command:

     sed -i "/.*cassandra.*/g" /etc/hosts; sed -i "/^$/d" /etc/hosts


May06 15:39:39 [DEBUG]  [cassandra_node_08]: Connecting to SSH
May06 15:39:39 [DEBUG]  [cassandra_node_08]: connected in 0 sec. Running SSH command
May06 15:39:39 [DEBUG]  [cassandra_node_08]: SSH command took 0 sec
May06 15:39:39 [DEBUG]  [cassandra_node_08]: command returned:

 	$:  


May06 15:39:39 [DEBUG]  [cassandra_node_08]: running SSH command:

     echo '
     10.0.0.35 cassandra_seednode
     10.0.0.18 cassandra_node_11
     10.0.0.30 cassandra_node_10
     10.0.0.35 cassandra_seed_0
     10.0.0.17 cassandra_node_09
     10.0.0.13 cassandra_node_08
     10.0.0.31 cassandra_node_01
     10.0.0.11 cassandra_node_03
     10.0.0.38 cassandra_node_02
     10.0.0.16 cassandra_node_05
     10.0.0.45 cassandra_node_04
     10.0.0.37 cassandra_node_07
     10.0.0.44 cassandra_node_06' >> /etc/hosts; echo cassandra_node_08 >/etc/hostname


May06 15:39:39 [DEBUG]  [cassandra_node_08]: Connecting to SSH
May06 15:39:40 [DEBUG]  [cassandra_node_08]: connected in 0 sec. Running SSH command
May06 15:39:40 [DEBUG]  [cassandra_node_08]: SSH command took 0 sec
May06 15:39:40 [DEBUG]  [cassandra_node_08]: command returned:

 	$:  


May06 15:46:15 [DEBUG]  [cassandra_node_08]: running SSH command:

     sed -i "/.*cassandra.*/g" /etc/hosts; sed -i "/^$/d" /etc/hosts


May06 15:46:15 [DEBUG]  [cassandra_node_08]: Connecting to SSH
May06 15:46:15 [DEBUG]  [cassandra_node_08]: connected in 0 sec. Running SSH command
May06 15:46:15 [DEBUG]  [cassandra_node_08]: SSH command took 0 sec
May06 15:46:15 [DEBUG]  [cassandra_node_08]: command returned:

 	$:  


May06 15:46:15 [DEBUG]  [cassandra_node_08]: running SSH command:

     echo '
     10.0.0.35 cassandra_seednode
     10.0.0.18 cassandra_node_11
     10.0.0.30 cassandra_node_10
     10.0.0.32 cassandra_node_15
     10.0.0.35 cassandra_seed_0
     10.0.0.17 cassandra_node_09
     10.0.0.13 cassandra_node_08
     10.0.0.42 cassandra_node_12
     10.0.0.33 cassandra_node_14
     10.0.0.31 cassandra_node_01
     10.0.0.41 cassandra_node_13
     10.0.0.11 cassandra_node_03
     10.0.0.38 cassandra_node_02
     10.0.0.16 cassandra_node_05
     10.0.0.45 cassandra_node_04
     10.0.0.37 cassandra_node_07
     10.0.0.44 cassandra_node_06' >> /etc/hosts; echo cassandra_node_08 >/etc/hostname


May06 15:46:15 [DEBUG]  [cassandra_node_08]: Connecting to SSH
May06 15:46:15 [DEBUG]  [cassandra_node_08]: connected in 0 sec. Running SSH command
May06 15:46:15 [DEBUG]  [cassandra_node_08]: SSH command took 0 sec
May06 15:46:15 [DEBUG]  [cassandra_node_08]: command returned:

 	$:  


May06 15:53:16 [DEBUG]  [cassandra_node_08]: running SSH command:

     sed -i "/.*cassandra.*/g" /etc/hosts; sed -i "/^$/d" /etc/hosts


May06 15:53:16 [DEBUG]  [cassandra_node_08]: Connecting to SSH
May06 15:53:16 [DEBUG]  [cassandra_node_08]: connected in 0 sec. Running SSH command
May06 15:53:16 [DEBUG]  [cassandra_node_08]: SSH command took 0 sec
May06 15:53:16 [DEBUG]  [cassandra_node_08]: command returned:

 	$:  


May06 15:53:16 [DEBUG]  [cassandra_node_08]: running SSH command:

     echo '
     10.0.0.35 cassandra_seednode
     10.0.0.18 cassandra_node_11
     10.0.0.30 cassandra_node_10
     10.0.0.32 cassandra_node_15
     10.0.0.39 cassandra_node_16
     10.0.0.43 cassandra_node_17
     10.0.0.35 cassandra_seed_0
     10.0.0.17 cassandra_node_09
     10.0.0.13 cassandra_node_08
     10.0.0.40 cassandra_node_18
     10.0.0.20 cassandra_node_19
     10.0.0.42 cassandra_node_12
     10.0.0.33 cassandra_node_14
     10.0.0.31 cassandra_node_01
     10.0.0.41 cassandra_node_13
     10.0.0.11 cassandra_node_03
     10.0.0.38 cassandra_node_02
     10.0.0.16 cassandra_node_05
     10.0.0.45 cassandra_node_04
     10.0.0.37 cassandra_node_07
     10.0.0.44 cassandra_node_06' >> /etc/hosts; echo cassandra_node_08 >/etc/hostname


May06 15:53:16 [DEBUG]  [cassandra_node_08]: Connecting to SSH
May06 15:53:16 [DEBUG]  [cassandra_node_08]: connected in 0 sec. Running SSH command
May06 15:53:16 [DEBUG]  [cassandra_node_08]: SSH command took 0 sec
May06 15:53:16 [DEBUG]  [cassandra_node_08]: command returned:

 	$:  


May06 16:00:59 [DEBUG]  [cassandra_node_08]: running SSH command:

     sed -i "/.*cassandra.*/g" /etc/hosts; sed -i "/^$/d" /etc/hosts


May06 16:00:59 [DEBUG]  [cassandra_node_08]: Connecting to SSH
May06 16:01:00 [DEBUG]  [cassandra_node_08]: connected in 0 sec. Running SSH command
May06 16:01:00 [DEBUG]  [cassandra_node_08]: SSH command took 0 sec
May06 16:01:00 [DEBUG]  [cassandra_node_08]: command returned:

 	$:  


May06 16:01:00 [DEBUG]  [cassandra_node_08]: running SSH command:

     echo '
     10.0.0.35 cassandra_seednode
     10.0.0.18 cassandra_node_11
     10.0.0.30 cassandra_node_10
     10.0.0.32 cassandra_node_15
     10.0.0.39 cassandra_node_16
     10.0.0.43 cassandra_node_17
     10.0.0.35 cassandra_seed_0
     10.0.0.17 cassandra_node_09
     10.0.0.13 cassandra_node_08
     10.0.0.40 cassandra_node_18
     10.0.0.42 cassandra_node_12
     10.0.0.33 cassandra_node_14
     10.0.0.31 cassandra_node_01
     10.0.0.41 cassandra_node_13
     10.0.0.11 cassandra_node_03
     10.0.0.38 cassandra_node_02
     10.0.0.16 cassandra_node_05
     10.0.0.45 cassandra_node_04
     10.0.0.37 cassandra_node_07
     10.0.0.44 cassandra_node_06' >> /etc/hosts; echo cassandra_node_08 >/etc/hostname


May06 16:01:00 [DEBUG]  [cassandra_node_08]: Connecting to SSH
May06 16:01:00 [DEBUG]  [cassandra_node_08]: connected in 0 sec. Running SSH command
May06 16:01:00 [DEBUG]  [cassandra_node_08]: SSH command took 0 sec
May06 16:01:00 [DEBUG]  [cassandra_node_08]: command returned:

 	$:  


May06 16:07:44 [DEBUG]  [cassandra_node_08]: running SSH command:

     sed -i "/.*cassandra.*/g" /etc/hosts; sed -i "/^$/d" /etc/hosts


May06 16:07:44 [DEBUG]  [cassandra_node_08]: Connecting to SSH
May06 16:07:44 [DEBUG]  [cassandra_node_08]: connected in 0 sec. Running SSH command
May06 16:07:44 [DEBUG]  [cassandra_node_08]: SSH command took 0 sec
May06 16:07:44 [DEBUG]  [cassandra_node_08]: command returned:

 	$:  


May06 16:07:44 [DEBUG]  [cassandra_node_08]: running SSH command:

     echo '
     10.0.0.35 cassandra_seednode
     10.0.0.18 cassandra_node_11
     10.0.0.30 cassandra_node_10
     10.0.0.32 cassandra_node_15
     10.0.0.39 cassandra_node_16
     10.0.0.43 cassandra_node_17
     10.0.0.35 cassandra_seed_0
     10.0.0.17 cassandra_node_09
     10.0.0.13 cassandra_node_08
     10.0.0.40 cassandra_node_18
     10.0.0.20 cassandra_node_19
     10.0.0.42 cassandra_node_12
     10.0.0.33 cassandra_node_14
     10.0.0.31 cassandra_node_01
     10.0.0.41 cassandra_node_13
     10.0.0.11 cassandra_node_03
     10.0.0.38 cassandra_node_02
     10.0.0.16 cassandra_node_05
     10.0.0.45 cassandra_node_04
     10.0.0.37 cassandra_node_07
     10.0.0.44 cassandra_node_06' >> /etc/hosts; echo cassandra_node_08 >/etc/hostname


May06 16:07:44 [DEBUG]  [cassandra_node_08]: Connecting to SSH
May06 16:07:45 [DEBUG]  [cassandra_node_08]: connected in 0 sec. Running SSH command
May06 16:07:45 [DEBUG]  [cassandra_node_08]: SSH command took 0 sec
May06 16:07:45 [DEBUG]  [cassandra_node_08]: command returned:

 	$:  


May06 16:31:51 [DEBUG]  [cassandra_node_08]: running SSH command:

     sed -i "/.*cassandra.*/g" /etc/hosts; sed -i "/^$/d" /etc/hosts


May06 16:31:51 [DEBUG]  [cassandra_node_08]: Connecting to SSH
May06 16:31:51 [DEBUG]  [cassandra_node_08]: connected in 0 sec. Running SSH command
May06 16:31:51 [DEBUG]  [cassandra_node_08]: SSH command took 0 sec
May06 16:31:51 [DEBUG]  [cassandra_node_08]: command returned:

 	$:  


May06 16:31:51 [DEBUG]  [cassandra_node_08]: running SSH command:

     echo '
     10.0.0.35 cassandra_seednode
     10.0.0.18 cassandra_node_11
     10.0.0.30 cassandra_node_10
     10.0.0.32 cassandra_node_15
     10.0.0.39 cassandra_node_16
     10.0.0.43 cassandra_node_17
     10.0.0.35 cassandra_seed_0
     10.0.0.17 cassandra_node_09
     10.0.0.13 cassandra_node_08
     10.0.0.40 cassandra_node_18
     10.0.0.42 cassandra_node_12
     10.0.0.33 cassandra_node_14
     10.0.0.31 cassandra_node_01
     10.0.0.41 cassandra_node_13
     10.0.0.11 cassandra_node_03
     10.0.0.38 cassandra_node_02
     10.0.0.16 cassandra_node_05
     10.0.0.45 cassandra_node_04
     10.0.0.37 cassandra_node_07
     10.0.0.44 cassandra_node_06' >> /etc/hosts; echo cassandra_node_08 >/etc/hostname


May06 16:31:51 [DEBUG]  [cassandra_node_08]: Connecting to SSH
May06 16:31:51 [DEBUG]  [cassandra_node_08]: connected in 0 sec. Running SSH command
May06 16:31:51 [DEBUG]  [cassandra_node_08]: SSH command took 0 sec
May06 16:31:51 [DEBUG]  [cassandra_node_08]: command returned:

 	$:  


May06 16:46:16 [DEBUG]  [cassandra_node_08]: running SSH command:

     sed -i "/.*cassandra.*/g" /etc/hosts; sed -i "/^$/d" /etc/hosts


May06 16:46:16 [DEBUG]  [cassandra_node_08]: Connecting to SSH
May06 16:46:16 [DEBUG]  [cassandra_node_08]: connected in 0 sec. Running SSH command
May06 16:46:16 [DEBUG]  [cassandra_node_08]: SSH command took 0 sec
May06 16:46:16 [DEBUG]  [cassandra_node_08]: command returned:

 	$:  


May06 16:46:16 [DEBUG]  [cassandra_node_08]: running SSH command:

     echo '
     10.0.0.35 cassandra_seednode
     10.0.0.18 cassandra_node_11
     10.0.0.30 cassandra_node_10
     10.0.0.32 cassandra_node_15
     10.0.0.39 cassandra_node_16
     10.0.0.35 cassandra_seed_0
     10.0.0.17 cassandra_node_09
     10.0.0.13 cassandra_node_08
     10.0.0.42 cassandra_node_12
     10.0.0.33 cassandra_node_14
     10.0.0.31 cassandra_node_01
     10.0.0.41 cassandra_node_13
     10.0.0.11 cassandra_node_03
     10.0.0.38 cassandra_node_02
     10.0.0.16 cassandra_node_05
     10.0.0.45 cassandra_node_04
     10.0.0.37 cassandra_node_07
     10.0.0.44 cassandra_node_06' >> /etc/hosts; echo cassandra_node_08 >/etc/hostname


May06 16:46:16 [DEBUG]  [cassandra_node_08]: Connecting to SSH
May06 16:46:17 [DEBUG]  [cassandra_node_08]: connected in 0 sec. Running SSH command
May06 16:46:17 [DEBUG]  [cassandra_node_08]: SSH command took 0 sec
May06 16:46:17 [DEBUG]  [cassandra_node_08]: command returned:

 	$:  


May06 16:56:00 [DEBUG]  [cassandra_node_08]: running SSH command:

     sed -i "/.*cassandra.*/g" /etc/hosts; sed -i "/^$/d" /etc/hosts


May06 16:56:00 [DEBUG]  [cassandra_node_08]: Connecting to SSH
May06 16:56:00 [DEBUG]  [cassandra_node_08]: connected in 0 sec. Running SSH command
May06 16:56:00 [DEBUG]  [cassandra_node_08]: SSH command took 0 sec
May06 16:56:00 [DEBUG]  [cassandra_node_08]: command returned:

 	$:  


May06 16:56:00 [DEBUG]  [cassandra_node_08]: running SSH command:

     echo '
     10.0.0.35 cassandra_seednode
     10.0.0.18 cassandra_node_11
     10.0.0.30 cassandra_node_10
     10.0.0.35 cassandra_seed_0
     10.0.0.17 cassandra_node_09
     10.0.0.13 cassandra_node_08
     10.0.0.42 cassandra_node_12
     10.0.0.31 cassandra_node_01
     10.0.0.41 cassandra_node_13
     10.0.0.11 cassandra_node_03
     10.0.0.38 cassandra_node_02
     10.0.0.16 cassandra_node_05
     10.0.0.45 cassandra_node_04
     10.0.0.37 cassandra_node_07
     10.0.0.44 cassandra_node_06' >> /etc/hosts; echo cassandra_node_08 >/etc/hostname


May06 16:56:00 [DEBUG]  [cassandra_node_08]: Connecting to SSH
May06 16:56:00 [DEBUG]  [cassandra_node_08]: connected in 0 sec. Running SSH command
May06 16:56:00 [DEBUG]  [cassandra_node_08]: SSH command took 0 sec
May06 16:56:00 [DEBUG]  [cassandra_node_08]: command returned:

 	$:  


May06 17:07:00 [DEBUG]  [cassandra_node_08]: running SSH command:

     sed -i "/.*cassandra.*/g" /etc/hosts; sed -i "/^$/d" /etc/hosts


May06 17:07:00 [DEBUG]  [cassandra_node_08]: Connecting to SSH
May06 17:07:00 [DEBUG]  [cassandra_node_08]: connected in 0 sec. Running SSH command
May06 17:07:00 [DEBUG]  [cassandra_node_08]: SSH command took 0 sec
May06 17:07:00 [DEBUG]  [cassandra_node_08]: command returned:

 	$:  


May06 17:07:00 [DEBUG]  [cassandra_node_08]: running SSH command:

     echo '
     10.0.0.35 cassandra_seednode
     10.0.0.35 cassandra_seed_0
     10.0.0.17 cassandra_node_09
     10.0.0.13 cassandra_node_08
     10.0.0.31 cassandra_node_01
     10.0.0.11 cassandra_node_03
     10.0.0.38 cassandra_node_02
     10.0.0.16 cassandra_node_05
     10.0.0.45 cassandra_node_04
     10.0.0.37 cassandra_node_07
     10.0.0.44 cassandra_node_06' >> /etc/hosts; echo cassandra_node_08 >/etc/hostname


May06 17:07:00 [DEBUG]  [cassandra_node_08]: Connecting to SSH
May06 17:07:00 [DEBUG]  [cassandra_node_08]: connected in 0 sec. Running SSH command
May06 17:07:00 [DEBUG]  [cassandra_node_08]: SSH command took 0 sec
May06 17:07:00 [DEBUG]  [cassandra_node_08]: command returned:

 	$:  


May06 17:13:39 [DEBUG]  [cassandra_node_08]: running SSH command:

     sed -i "/.*cassandra.*/g" /etc/hosts; sed -i "/^$/d" /etc/hosts


May06 17:13:39 [DEBUG]  [cassandra_node_08]: Connecting to SSH
May06 17:13:39 [DEBUG]  [cassandra_node_08]: connected in 0 sec. Running SSH command
May06 17:13:39 [DEBUG]  [cassandra_node_08]: SSH command took 0 sec
May06 17:13:39 [DEBUG]  [cassandra_node_08]: command returned:

 	$:  


May06 17:13:39 [DEBUG]  [cassandra_node_08]: running SSH command:

     echo '
     10.0.0.35 cassandra_seednode
     10.0.0.18 cassandra_node_11
     10.0.0.30 cassandra_node_10
     10.0.0.35 cassandra_seed_0
     10.0.0.17 cassandra_node_09
     10.0.0.13 cassandra_node_08
     10.0.0.31 cassandra_node_01
     10.0.0.11 cassandra_node_03
     10.0.0.38 cassandra_node_02
     10.0.0.16 cassandra_node_05
     10.0.0.45 cassandra_node_04
     10.0.0.37 cassandra_node_07
     10.0.0.44 cassandra_node_06' >> /etc/hosts; echo cassandra_node_08 >/etc/hostname


May06 17:13:39 [DEBUG]  [cassandra_node_08]: Connecting to SSH
May06 17:13:39 [DEBUG]  [cassandra_node_08]: connected in 0 sec. Running SSH command
May06 17:13:39 [DEBUG]  [cassandra_node_08]: SSH command took 0 sec
May06 17:13:39 [DEBUG]  [cassandra_node_08]: command returned:

 	$:  


May06 17:16:16 [DEBUG]  [cassandra_node_08]: cluster = cassandra
May06 17:16:31 [DEBUG]  [cassandra_node_08]: cluster = cassandra
May06 17:26:21 [DEBUG]  [cassandra_node_08]: cluster = cassandra
May06 17:26:37 [DEBUG]  [cassandra_node_08]: cluster = cassandra
May06 17:33:40 [DEBUG]  [cassandra_node_08]: running SSH command:

     sed -i "/.*cassandra.*/g" /etc/hosts; sed -i "/^$/d" /etc/hosts


May06 17:33:40 [DEBUG]  [cassandra_node_08]: Connecting to SSH
May06 17:33:40 [DEBUG]  [cassandra_node_08]: connected in 0 sec. Running SSH command
May06 17:33:40 [DEBUG]  [cassandra_node_08]: SSH command took 0 sec
May06 17:33:40 [DEBUG]  [cassandra_node_08]: command returned:

 	$:  


May06 17:33:40 [DEBUG]  [cassandra_node_08]: running SSH command:

     echo '
     10.0.0.35 cassandra_seednode
     10.0.0.30 cassandra_node_10
     10.0.0.35 cassandra_seed_0
     10.0.0.17 cassandra_node_09
     10.0.0.13 cassandra_node_08
     10.0.0.31 cassandra_node_01
     10.0.0.11 cassandra_node_03
     10.0.0.38 cassandra_node_02
     10.0.0.16 cassandra_node_05
     10.0.0.45 cassandra_node_04
     10.0.0.37 cassandra_node_07
     10.0.0.44 cassandra_node_06' >> /etc/hosts; echo cassandra_node_08 >/etc/hostname


May06 17:33:40 [DEBUG]  [cassandra_node_08]: Connecting to SSH
May06 17:33:41 [DEBUG]  [cassandra_node_08]: connected in 0 sec. Running SSH command
May06 17:33:41 [DEBUG]  [cassandra_node_08]: SSH command took 0 sec
May06 17:33:41 [DEBUG]  [cassandra_node_08]: command returned:

 	$:  


May06 17:40:29 [DEBUG]  [cassandra_node_08]: running SSH command:

     sed -i "/.*cassandra.*/g" /etc/hosts; sed -i "/^$/d" /etc/hosts


May06 17:40:29 [DEBUG]  [cassandra_node_08]: Connecting to SSH
May06 17:40:29 [DEBUG]  [cassandra_node_08]: connected in 0 sec. Running SSH command
May06 17:40:29 [DEBUG]  [cassandra_node_08]: SSH command took 0 sec
May06 17:40:29 [DEBUG]  [cassandra_node_08]: command returned:

 	$:  


May06 17:40:29 [DEBUG]  [cassandra_node_08]: running SSH command:

     echo '
     10.0.0.35 cassandra_seednode
     10.0.0.18 cassandra_node_11
     10.0.0.30 cassandra_node_10
     10.0.0.35 cassandra_seed_0
     10.0.0.17 cassandra_node_09
     10.0.0.13 cassandra_node_08
     10.0.0.42 cassandra_node_12
     10.0.0.31 cassandra_node_01
     10.0.0.41 cassandra_node_13
     10.0.0.11 cassandra_node_03
     10.0.0.38 cassandra_node_02
     10.0.0.16 cassandra_node_05
     10.0.0.45 cassandra_node_04
     10.0.0.37 cassandra_node_07
     10.0.0.44 cassandra_node_06' >> /etc/hosts; echo cassandra_node_08 >/etc/hostname


May06 17:40:29 [DEBUG]  [cassandra_node_08]: Connecting to SSH
May06 17:40:29 [DEBUG]  [cassandra_node_08]: connected in 0 sec. Running SSH command
May06 17:40:29 [DEBUG]  [cassandra_node_08]: SSH command took 0 sec
May06 17:40:29 [DEBUG]  [cassandra_node_08]: command returned:

 	$:  


